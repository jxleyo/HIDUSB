/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>
   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

TLG_STATUS __stdcall TlgWrite(TraceLoggingHProvider hProvider, const void *pEventMetadata, LPCGUID pActivityId, LPCGUID pRelatedActivityId, UINT32 cData, EVENT_DATA_DESCRIPTOR *pData);
void __fastcall TraceLoggingWDFDevice(int a1, struct _DRIVER_OBJECT *a2, __int64 a3, const GUID *a4);
void __fastcall TraceLoggingDeviceDriver(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
void __stdcall McGenControlCallbackV2(LPCGUID SourceId, ULONG ControlCode, UCHAR Level, ULONGLONG MatchAnyKeyword, ULONGLONG MatchAllKeyword, PEVENT_FILTER_DESCRIPTOR FilterData, PVOID CallbackContext);
ULONG __stdcall McGenEventRegister(LPCGUID ProviderId, PETWENABLECALLBACK EnableCallback, PVOID CallbackContext, PREGHANDLE RegHandle);
ULONG __stdcall McGenEventUnregister(PREGHANDLE RegHandle);
__int64 __fastcall WPP_RECORDER_SF_(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5);
__int64 WPP_RECORDER_SF_d(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 WPP_RECORDER_SF_q(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 WPP_RECORDER_SF_qd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall WppClassicProviderCallback(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4);
void TlgDefineProvider_annotation__Tlgg_TraceLoggingProviderProv();
__int64 RtlStringCbPrintfW(wchar_t *Dest, unsigned __int64, const unsigned __int16 *, ...); // idb
void __fastcall TraceLoggingPNPFailure(const struct _TlgProvider_t *a1, __int64 a2, __int64 a3, const GUID *a4);
ULONG __stdcall McGenEventWrite(PMCGEN_TRACE_CONTEXT Context, PCEVENT_DESCRIPTOR Descriptor, LPCGUID ActivityId, ULONG EventDataCount, EVENT_DATA_DESCRIPTOR *EventData);
ULONG McTemplateK0pq(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, __int64 a3, ...);
__int64 __fastcall OnPrepareHardware(struct WDFDEVICE__ *a1, struct WDFCMRESLIST__ *a2, struct WDFCMRESLIST__ *a3);
__int64 __fastcall OnD0Entry(struct WDFDEVICE__ *a1, enum _WDF_POWER_DEVICE_STATE a2);
__int64 __fastcall OnPostInterruptsEnabled(struct WDFDEVICE__ *, enum _WDF_POWER_DEVICE_STATE); // idb
__int64 __fastcall OnReleaseHardware(struct WDFDEVICE__ *, struct WDFCMRESLIST__ *); // idb
__int64 __fastcall OnSelfManagedIoSuspend(struct WDFDEVICE__ *); // idb
__int64 WPP_RECORDER_SF_qq(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...);
__int64 WPP_RECORDER_SF_qqd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall WPP_RECORDER_SF_sqq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, const char *a6);
void __fastcall OnInternalDeviceIoControl(struct WDFQUEUE__ *a1, struct WDFREQUEST__ *a2, __int64 a3, __int64 a4, unsigned int a5);
void __fastcall OnIoStop(struct WDFQUEUE__ *a1, struct WDFREQUEST__ *a2, char a3);
char *__fastcall _DbgInternalIoctlString(unsigned int); // idb
__int64 RtlUnicodeStringPrintf(struct _UNICODE_STRING *a1, const unsigned __int16 *a2, ...);
void __fastcall TraceLoggingBusDevice(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
ULONG McTemplateK0pp(__int64 a1, const EVENT_DESCRIPTOR *a2, const GUID *a3, ...);
__int64 WPP_RECORDER_SF_LLd(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 WPP_RECORDER_SF_Ld(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall WPP_RECORDER_SF_Zd(__int64 a1, unsigned __int8 a2, __int64 a3, unsigned __int16 a4, __int64 a5, const wchar_t *a6);
__int64 WPP_RECORDER_SF_i(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
__int64 WPP_RECORDER_SF_qLd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...);
__int64 WPP_RECORDER_SF_qLqLd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...);
__int64 __fastcall SpbInitialize(struct _DEVICE_CONTEXT *, struct WDFCMRESLIST__ *, struct WDFCMRESLIST__ *); // idb
__int64 __fastcall SpbWrite(struct WDFIOTARGET__ *a1, __int64 a2, unsigned __int8 *a3, unsigned int a4, unsigned int a5);
__int64 __fastcall SpbWritelessRead(struct WDFIOTARGET__ *, struct WDFREQUEST__ *, unsigned __int8 *, unsigned int, struct _GUID *); // idb
__int64 __fastcall SpbRead(struct WDFIOTARGET__ *a1, __int64 a2, unsigned __int8 *a3, unsigned int a4, unsigned int a5, unsigned int a6);
__int64 __fastcall SpbWriteWrite(struct WDFIOTARGET__ *a1, __int16 a2, unsigned __int8 *a3, unsigned __int16 a4, unsigned __int16 a5, unsigned __int8 *a6, unsigned __int16 a7);
__int64 __fastcall SpbWriteRead(struct WDFIOTARGET__ *a1, __int16 a2, unsigned __int8 *a3, unsigned __int16 a4, unsigned __int16 a5, unsigned __int8 *a6, unsigned __int16 a7);
__int64 __fastcall _SpbSequence(struct WDFIOTARGET__ *a1, void *a2, __int64 a3, unsigned int *a4, unsigned int a5);
void __fastcall TraceLoggingACPI(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
__int64 WPP_RECORDER_SF_D(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 WPP_RECORDER_SF_cd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...);
void __fastcall TraceLoggingHID(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
ULONG McTemplateK0phq(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, __int64 a3, ...);
__int64 WPP_RECORDER_SF_DD(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
__int64 WPP_RECORDER_SF_DDd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...);
__int64 WPP_RECORDER_SF_Dd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall HidInitialize(struct _DEVICE_CONTEXT *, enum _WDF_POWER_DEVICE_STATE); // idb
__int64 __fastcall HidDestroy(struct _DEVICE_CONTEXT *, enum _WDF_POWER_DEVICE_STATE); // idb
__int64 __fastcall HidGetDeviceDescriptor(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *); // idb
__int64 __fastcall HidGetReportDescriptor(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *); // idb
__int64 __fastcall HidGetDeviceAttributes(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *); // idb
__int64 __fastcall HidGetString(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *); // idb
__int64 __fastcall HidReadReport(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *, unsigned __int8 *); // idb
__int64 __fastcall HidWriteReport(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *); // idb
__int64 __fastcall HidGetReport(__int64 a1, __int64 a2, int a3);
__int64 __fastcall HidSetReport(__int64 a1, __int64 a2, int a3);
__int64 __fastcall HidSendIdleNotification(struct _DEVICE_CONTEXT *, struct WDFREQUEST__ *, unsigned __int8 *); // idb
__int64 __fastcall _HidGetHidDescriptor(struct _DEVICE_CONTEXT *); // idb
void __fastcall HidEvtResetTimerFired(struct WDFTIMER__ *); // idb
__int64 __fastcall HidReset(struct _DEVICE_CONTEXT *); // idb
__int64 __fastcall _HidPower(__int64 a1, __int16 a2);
void __fastcall TraceLoggingInterrupt(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
ULONG __fastcall McTemplateK0(struct _MCGEN_TRACE_CONTEXT *a1, __int64 a2, const GUID *a3);
ULONG McTemplateK0p(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, const GUID *a3, ...);
unsigned __int8 __fastcall OnInterruptIsr(struct WDFINTERRUPT__ *a1);
void __fastcall OnInterruptDpc(struct WDFINTERRUPT__ *, void *); // idb
LPGUID __fastcall _LogGetActivityId(LPGUID ActivityId, struct WDFREQUEST__ *a2);
void __fastcall TraceLoggingPowerDevice(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4);
void __fastcall PowerIdleIrpWorkitem(struct WDFWORKITEM__ *); // idb
void __fastcall PowerIdleIrpCompletion(struct _DEVICE_CONTEXT *); // idb
__int64 __fastcall WPP_RECORDER_SF_ZL(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, const wchar_t *a6);
void FxStubDriverUnloadCommon(void); // idb
void FxStubDriverUnload();
NTSTATUS __stdcall FxDriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath);
NTSTATUS __fastcall FxDriverEntryWorker(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
__int64 __fastcall FxStubBindClasses(struct _WDF_BIND_INFO *); // idb
__int64 __fastcall _GSHandlerCheckCommon(__int64 a1, __int64 a2);
void *__cdecl memmove(void *, const void *Src, size_t Size);
void *__cdecl memset(void *, int Val, size_t Size);
// __int64 __fastcall WdfVersionBind(_QWORD, _QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WdfVersionUnbind(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WdfVersionBindClass(_QWORD, _QWORD); weak
// __int64 __fastcall WdfVersionUnbindClass(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD); weak
// __int64 __fastcall imp_WppRecorderReplay(_QWORD, _QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WppAutoLogStart(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WppAutoLogStop(_QWORD, _QWORD); weak
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// __int64 __fastcall IoSetActivityIdIrp(_QWORD, _QWORD); weak
// NTSTATUS __stdcall RtlFindMessage(PVOID BaseAddress, ULONG Type, ULONG Language, ULONG MessageId, PMESSAGE_RESOURCE_ENTRY *MessageResourceEntry);
// __int64 __fastcall IoGetActivityIdIrp(_QWORD, _QWORD); weak
// NTSTATUS __stdcall EtwActivityIdControl(ULONG ControlCode, LPGUID ActivityId);
// NTSTATUS __stdcall EtwUnregister(REGHANDLE RegHandle);
// NTSTATUS __stdcall IoSetDevicePropertyData(PDEVICE_OBJECT Pdo, const DEVPROPKEY *PropertyKey, LCID Lcid, ULONG Flags, DEVPROPTYPE Type, ULONG Size, PVOID Data);
// int __cdecl _vsnwprintf(wchar_t *Dest, size_t Count, const wchar_t *Format, va_list Args);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// NTSTATUS __stdcall EtwRegister(LPCGUID ProviderId, PETWENABLECALLBACK EnableCallback, PVOID CallbackContext, PREGHANDLE RegHandle);
// void __stdcall RtlCopyUnicodeString(PUNICODE_STRING DestinationString, PCUNICODE_STRING SourceString);
// NTSTATUS __stdcall EtwWriteTransfer(REGHANDLE RegHandle, PCEVENT_DESCRIPTOR EventDescriptor, LPCGUID ActivityId, LPCGUID RelatedActivityId, ULONG UserDataCount, PEVENT_DATA_DESCRIPTOR UserData);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// errno_t __cdecl memcpy_s(void *, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// NTSTATUS __stdcall EtwSetInformation(REGHANDLE RegHandle, EVENT_INFO_CLASS InformationClass, PVOID EventInformation, ULONG InformationLength);
void __stdcall TlgEnableCallback(LPCGUID pSourceId, ULONG callbackType, UCHAR level, ULONGLONG keywordAny, ULONGLONG keywordAll, PEVENT_FILTER_DESCRIPTOR pFilterData, PVOID pCallbackContext);
PVOID WppLoadTracingSupport();
__int64 __fastcall WppTraceCallback(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
void __fastcall WppInitKm(__int64 a1, __int64 a2);
void __fastcall WppCleanupKm(__int64 a1);
__int64 __fastcall OnDeviceAdd(__int64 a1, __int64 a2);
void __fastcall OnDriverUnload(ULONGLONG *a1);
__int64 __fastcall OnD0Exit(__int64 a1, enum _WDF_POWER_DEVICE_STATE a2);
void __fastcall DeviceReportPnpProblem(__int64 a1, __int64 a2, __int64 a3, const GUID *a4);
__int64 __fastcall AcpiInitialize(__int64 *a1, __int64 a2);
__int64 __fastcall AcpiGetDeviceMethod(__int64 a1, __int64 a2);
__int64 __fastcall AcpiDsmSupported(struct WDFDEVICE__ **a1, __int64 a2, char *a3);
__int64 __fastcall AcpiPrepareInputParametersForDsm(_DWORD *a1, __int64 a2, int a3);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
// void __cdecl _security_init_cookie();

//-------------------------------------------------------------------------
// Data declarations

const EVENT_DESCRIPTOR EVENT_HIDI2C_IO_INTERRUPT_RECEIVED = { 1010u, 1u, 16u, 4u, 1u, 2u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_ENUMERATION_SPB_FAILURE = { 1001u, 1u, 16u, 2u, 0u, 1u, 9223372036854775808ui64 }; // idb
const DEVPROPKEY DEVPKEY_Device_DriverProblemDesc =
{
  {
    1410045054u,
    35648u,
    17852u,
    { 168u, 162u, 106u, 11u, 137u, 76u, 189u, 162u }
  },
  11u
};
EVENT_DESCRIPTOR EVENT_HIDI2C_COMMAND_POWER = { 1021u, 1u, 16u, 4u, 0u, 3u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_IO_COMPLETE = { 1014u, 1u, 16u, 4u, 2u, 2u, 9223372036854775808ui64 }; // idb
_UNKNOWN WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids; // weak
_UNKNOWN ACPI_DSM_GUID_HIDI2C; // weak
EVENT_DESCRIPTOR EVENT_HIDI2C_COMMAND_RESET = { 1020u, 1u, 16u, 4u, 0u, 3u, 9223372036854775808ui64 }; // idb
const GUID HIDI2C_EVENT_PROVIDER = { 2568982502u, 9373u, 17622u, { 185u, 61u, 90u, 48u, 96u, 193u, 222u, 219u } }; // idb
_UNKNOWN WPP_ThisDir_CTLGUID_HidI2CTraceGuid; // weak
EVENT_DESCRIPTOR EVENT_HIDI2C_IO_SPBREAD_DISPATCH = { 1011u, 1u, 16u, 4u, 10u, 2u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_ENUMERATION_HID_FAILURE = { 1003u, 1u, 16u, 2u, 0u, 1u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_ENUMERATION_OK = { 1000u, 1u, 16u, 4u, 0u, 1u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_IO_SPBREAD_COMPLETE = { 1012u, 1u, 16u, 4u, 11u, 2u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_ENUMERATION_ACPI_FAILURE = { 1002u, 1u, 16u, 2u, 0u, 1u, 9223372036854775808ui64 }; // idb
EVENT_DESCRIPTOR EVENT_HIDI2C_IO_FORWARD_TO_COMPLETIONQUEUE = { 1013u, 1u, 16u, 4u, 12u, 2u, 9223372036854775808ui64 }; // idb
_UNKNOWN WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids; // weak
_UNKNOWN WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids; // weak
_UNKNOWN WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids; // weak
_UNKNOWN WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids; // weak
_UNKNOWN WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids; // weak
_UNKNOWN WPP_3de35891b74b33b741300fa81a68062f_Traceguids; // weak
_UNKNOWN WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids; // weak
_UNKNOWN WPP_726ae28c65f835e1f9147df5104045df_Traceguids; // weak
_UNKNOWN unk_1C00096F9; // weak
_UNKNOWN unk_1C0009726; // weak
_UNKNOWN unk_1C0009756; // weak
_UNKNOWN unk_1C0009781; // weak
_UNKNOWN unk_1C00097A8; // weak
_UNKNOWN unk_1C00097D0; // weak
_UNKNOWN unk_1C00097F7; // weak
_UNKNOWN unk_1C0009824; // weak
void *off_1C000B018 = &WDF_DEVICE_CONTEXT_TYPE_INFO; // weak
int dword_1C000B028 = 0; // weak
PVOID EventInformation = &unk_1C000985D; // idb
__int64 qword_1C000B038 = 0i64; // weak
__int64 qword_1C000B040 = 0i64; // weak
REGHANDLE RegHandle = 0ui64; // idb
__int128 xmmword_1C000B050 = 0i64; // weak
ULONGLONG HIDI2C_EVENT_PROVIDER_Context = 0ui64; // idb
__int64 qword_1C000B068 = 0i64; // weak
void *off_1C000B0C0 = &WDF_WORKITEM_CONTEXT_TYPE_INFO; // weak
PDEVICE_OBJECT WPP_GLOBAL_Control = &WPP_GLOBAL_Control; // idb
void *off_1C000B0F0 = &WDF_REQUEST_CONTEXT_TYPE_INFO; // weak
void *WPP_RECORDER_INITIALIZED = &WPP_RECORDER_INITIALIZED; // weak
_UNKNOWN WdfBindInfo; // weak
_UNKNOWN __KMDF_CLASS_BIND_START; // weak
_QWORD __KMDF_CLASS_BIND_END = 0i64; // idb
void *off_1C000B168 = &__KMDF_CLASS_BIND_START; // weak
_UNKNOWN __KMDF_TYPE_INIT_START; // weak
char __KMDF_TYPE_INIT_END[64] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
__int64 pfnEtwRegisterClassicProvider = 0i64; // weak
__int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *pfnWppGetVersion)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int WPPTraceSuite = 0; // weak
char Microsoft_Windows_SPB_HIDI2CEnableBits; // weak
__int64 (__fastcall *pfnWppQueryTraceInformation)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
struct _DEVICE_OBJECT WPP_MAIN_CB; // idb
__int64 (*qword_1C000B498)(void); // weak


//----- (00000001C0001008) ----------------------------------------------------
TLG_STATUS __stdcall TlgWrite(TraceLoggingHProvider hProvider, const void *pEventMetadata, LPCGUID pActivityId, LPCGUID pRelatedActivityId, UINT32 cData, EVENT_DATA_DESCRIPTOR *pData)
{
  EVENT_DESCRIPTOR EventDescriptor; // [rsp+30h] [rbp-18h] BYREF

  *(_DWORD *)&EventDescriptor.Id = *(unsigned __int8 *)pEventMetadata << 24;
  *(_DWORD *)&EventDescriptor.Level = *(unsigned __int16 *)((char *)pEventMetadata + 1);
  EventDescriptor.Keyword = *(_QWORD *)((char *)pEventMetadata + 3);
  pData->Ptr = (ULONGLONG)EventInformation;
  pData->Size = *(unsigned __int16 *)EventInformation;
  pData[1].Ptr = (ULONGLONG)pEventMetadata + 11;
  pData->Reserved = 2;
  pData[1].Size = *(unsigned __int16 *)((char *)pEventMetadata + 11);
  pData[1].Reserved = 1;
  return EtwWriteTransfer(RegHandle, &EventDescriptor, 0i64, 0i64, cData, pData);
}

//----- (00000001C00010B0) ----------------------------------------------------
void __fastcall TraceLoggingWDFDevice(int a1, struct _DRIVER_OBJECT *a2, __int64 a3, const GUID *a4)
{
  struct _DRIVER_OBJECT *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct _DRIVER_OBJECT **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C00096F9, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0001164) ----------------------------------------------------
void __fastcall TraceLoggingDeviceDriver(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C0009726, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0001220) ----------------------------------------------------
void __stdcall McGenControlCallbackV2(LPCGUID SourceId, ULONG ControlCode, UCHAR Level, ULONGLONG MatchAnyKeyword, ULONGLONG MatchAllKeyword, PEVENT_FILTER_DESCRIPTOR FilterData, PVOID CallbackContext)
{
  unsigned int v7; // er8
  unsigned __int8 v8; // cl
  __int64 v9; // rdx
  bool v10; // r11
  int v11; // edx
  int *v12; // rcx
  int v13; // eax
  int v14; // edx
  unsigned __int16 v15; // ax

  if ( CallbackContext )
  {
    if ( ControlCode )
    {
      if ( ControlCode == 1 )
      {
        *((_BYTE *)CallbackContext + 40) = Level;
        v7 = 0;
        *((_QWORD *)CallbackContext + 3) = MatchAllKeyword;
        *((_QWORD *)CallbackContext + 2) = MatchAnyKeyword;
        for ( *((_DWORD *)CallbackContext + 9) = 1; v7 < *((unsigned __int16 *)CallbackContext + 21); ++v7 )// 
        {
          v8 = *((_BYTE *)CallbackContext + 40);
          v10 = 0;
          if ( *(_BYTE *)(v7 + *((_QWORD *)CallbackContext + 8)) <= v8 || !v8 )
          {
            v9 = *(_QWORD *)(*((_QWORD *)CallbackContext + 7) + 8i64 * v7);
            if ( !v9
              || (v9 & *((_QWORD *)CallbackContext + 2)) != 0
              && (v9 & *((_QWORD *)CallbackContext + 3)) == *((_QWORD *)CallbackContext + 3) )
            {
              v10 = 1;
            }
          }
          v11 = 1 << (v7 & 0x1F);
          v12 = (int *)(*((_QWORD *)CallbackContext + 6) + 4 * ((unsigned __int64)v7 >> 5));
          v13 = *v12;
          if ( v10 )
            v14 = v13 | v11;
          else
            v14 = v13 & ~v11;
          *v12 = v14;
        }
      }
    }
    else
    {
      v15 = *((_WORD *)CallbackContext + 21);
      *((_DWORD *)CallbackContext + 9) = 0;
      *((_BYTE *)CallbackContext + 40) = 0;
      *((_QWORD *)CallbackContext + 2) = 0i64;
      *((_QWORD *)CallbackContext + 3) = 0i64;
      if ( v15 )
        memset(*((void **)CallbackContext + 6), 0, 4i64 * ((v15 - 1) / 32 + 1));
    }
  }
}

//----- (00000001C000132C) ----------------------------------------------------
ULONG __stdcall McGenEventRegister(LPCGUID ProviderId, PETWENABLECALLBACK EnableCallback, PVOID CallbackContext, PREGHANDLE RegHandle)
{
  ULONG result; // eax

  result = 0;
  if ( !HIDI2C_EVENT_PROVIDER_Context )
    result = EtwRegister(
               &HIDI2C_EVENT_PROVIDER,
               McGenControlCallbackV2,
               &HIDI2C_EVENT_PROVIDER_Context,
               &HIDI2C_EVENT_PROVIDER_Context);
  return result;
}

//----- (00000001C000136C) ----------------------------------------------------
ULONG __stdcall McGenEventUnregister(PREGHANDLE RegHandle)
{
  ULONG result; // eax

  if ( !HIDI2C_EVENT_PROVIDER_Context )
    return 0;
  result = EtwUnregister(HIDI2C_EVENT_PROVIDER_Context);
  HIDI2C_EVENT_PROVIDER_Context = 0i64;
  return result;
}

//----- (00000001C00013A0) ----------------------------------------------------
__int64 __fastcall WPP_RECORDER_SF_(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5)
{
  unsigned __int64 v8; // rdi
  int v10; // eax
  int v12; // [rsp+20h] [rbp-28h]

  v8 = (unsigned __int64)a3 >> 16;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, ((_BYTE)a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= a2 )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, 0i64);
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v12, 0i64);
}
// 1C0001448: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0001474) ----------------------------------------------------
__int64 WPP_RECORDER_SF_d(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rdi
  int v10; // eax
  int v12; // [rsp+20h] [rbp-38h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, ((_BYTE)a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= a2 )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v12, va);
}
// 1C000154B: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0001578) ----------------------------------------------------
__int64 WPP_RECORDER_SF_q(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rbx
  int v9; // eax
  int v11; // [rsp+20h] [rbp-28h]
  va_list va; // [rsp+78h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v9 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v9, (a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= 4u )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v11) = a4;
  return WppAutoLogTrace(a1, 4i64, a3, a5, v11, va);
}
// 1C0001644: variable 'v11' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C000166C) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rdi
  int v10; // eax
  int v12; // [rsp+20h] [rbp-48h]
  va_list va; // [rsp+98h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, ((_BYTE)a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= a2 )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v12, va);
}
// 1C000176F: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C00017A0) ----------------------------------------------------
__int64 __fastcall WppClassicProviderCallback(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4)
{
  __int64 result; // rax
  __int64 v5; // rdx

  if ( a2 <= 1u )
  {
    result = 0i64;
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      v5 = *a3;
      *(_QWORD *)(a4 + 24) = *a3;
      LOBYTE(a4) = *((_BYTE *)a3 + 2);
      result = imp_WppRecorderReplay(WPP_GLOBAL_Control, v5, *((unsigned int *)a3 + 1), a4);
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
      *(_QWORD *)(a4 + 24) = 0i64;
    }
  }
  return result;
}
// 1C000D030: using guessed type __int64 __fastcall imp_WppRecorderReplay(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C00017FC) ----------------------------------------------------
void TlgDefineProvider_annotation__Tlgg_TraceLoggingProviderProv()
{
  ;
}

//----- (00000001C0001808) ----------------------------------------------------
__int64 RtlStringCbPrintfW(wchar_t *Dest, unsigned __int64 a2, const unsigned __int16 *a3, ...)
{
  unsigned __int64 v3; // rdx
  int v5; // esi
  unsigned __int64 v6; // rbx
  int v7; // eax
  va_list Args; // [rsp+68h] [rbp+20h] BYREF

  va_start(Args, a3);
  v3 = a2 >> 1;
  v5 = 0;
  if ( v3 - 1 > 0x7FFFFFFE )
    v5 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
  if ( v5 < 0 )
  {
    if ( v3 )
      *Dest = 0;
  }
  else
  {
    v6 = v3 - 1;
    v5 = 0;
    v7 = _vsnwprintf(Dest, v3 - 1, a3, Args);
    if ( v7 < 0 || v7 > v6 )
    {
      Dest[v6] = 0;
      v5 = -2147483643;
    }
    else if ( v7 == v6 )
    {
      Dest[v6] = 0;
    }
  }
  return (unsigned int)v5;
}

//----- (00000001C0001890) ----------------------------------------------------
void __fastcall TraceLoggingPNPFailure(const struct _TlgProvider_t *a1, __int64 a2, __int64 a3, const GUID *a4)
{
  int v4; // [rsp+30h] [rbp-48h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+38h] [rbp-40h] BYREF
  int *v6; // [rsp+58h] [rbp-20h]
  int v7; // [rsp+60h] [rbp-18h]
  int v8; // [rsp+64h] [rbp-14h]

  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = (int)a1;
    v6 = &v4;
    v8 = 0;
    v7 = 4;
    TlgWrite(a1, &unk_1C0009756, (LPCGUID)0x200000000000i64, a4, 3u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0001924) ----------------------------------------------------
ULONG __stdcall McGenEventWrite(PMCGEN_TRACE_CONTEXT Context, PCEVENT_DESCRIPTOR Descriptor, LPCGUID ActivityId, ULONG EventDataCount, EVENT_DATA_DESCRIPTOR *EventData)
{
  unsigned __int16 *v5; // r10
  ULONG v6; // eax
  ULONG v8; // er9

  v5 = (unsigned __int16 *)qword_1C000B068;
  v6 = 0;
  if ( qword_1C000B068 )
  {
    EventData->Ptr = qword_1C000B068;
    v6 = 2;
    v8 = *v5;
  }
  else
  {
    EventData->Ptr = 0i64;
    v8 = 0;
  }
  EventData->Size = v8;
  EventData->Reserved = v6;
  return EtwWriteTransfer(HIDI2C_EVENT_PROVIDER_Context, Descriptor, ActivityId, 0i64, EventDataCount, EventData);
}
// 1C000B068: using guessed type __int64 qword_1C000B068;

//----- (00000001C0001984) ----------------------------------------------------
ULONG McTemplateK0pq(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, __int64 a3, ...)
{
  EVENT_DATA_DESCRIPTOR v4; // [rsp+30h] [rbp-48h] BYREF
  va_list v5; // [rsp+40h] [rbp-38h]
  int v6; // [rsp+48h] [rbp-30h]
  int v7; // [rsp+4Ch] [rbp-2Ch]
  va_list v8; // [rsp+50h] [rbp-28h]
  int v9; // [rsp+58h] [rbp-20h]
  int v10; // [rsp+5Ch] [rbp-1Ch]
  __int64 v11; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  va_list va1; // [rsp+A0h] [rbp+28h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v11 = va_arg(va1, _QWORD);
  va_copy(v5, va);
  v7 = 0;
  v6 = 8;
  va_copy(v8, va1);
  v10 = 0;
  v9 = 4;
  return McGenEventWrite(a1, a2, 0i64, 3u, &v4);
}

//----- (00000001C0001A00) ----------------------------------------------------
__int64 __fastcall OnPrepareHardware(struct WDFDEVICE__ *a1, struct WDFCMRESLIST__ *a2, struct WDFCMRESLIST__ *a3) //FxDevice_a1,FxResourcesRaw_a2,FxResourcesTranslated_a3
{
  struct _DEVICE_CONTEXT *v6; // rdi
  __int64 v7; // rdx
  int v8; // ebx

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xAu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  v6 = (struct _DEVICE_CONTEXT *)(*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                  + 202))(
                                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                   a1,
                                   off_1C000B018);//DEVICE_CONTEXT_v6=GetDeviceContext(FxDevice_a1);
  v8 = SpbInitialize(v6, a2, a3);  //ntstatus_v8=SpbInitialize(DEVICE_CONTEXT_v6, FxResourcesRaw_a2, FxResourcesTranslated_a3); 
  if ( v8 >= 0 )
    v8 = AcpiInitialize((__int64 *)v6, v7);  //ntstatus_v8=AcpiInitialize((__int64 *)DEVICE_CONTEXT_v6, writedata_v7); //writedata_v7经检查后续的多次路径调用到达终点没有使用，所以本函数级后续调用函数都不需要该参数
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xBu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  return (unsigned int)v8;//return ntstatus_v8
}
// 1C0001A9D: variable 'v7' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0001B00) ----------------------------------------------------
__int64 __fastcall OnD0Entry(struct WDFDEVICE__ *a1, enum _WDF_POWER_DEVICE_STATE a2)// WDFDEVICE Device_a1, WDF_POWER_DEVICE_STATE PreviousState_a2 )
{
  struct _DEVICE_CONTEXT *v4; // rsi
  int v5; // ebx
  struct _MCGEN_TRACE_CONTEXT *v6; // rcx
  __int64 v7; // r8
  __int64 v9; // [rsp+20h] [rbp-38h]
  __int32 v10; // [rsp+30h] [rbp-28h]

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xCu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  v4 = (struct _DEVICE_CONTEXT *)(*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                  + 202))(
                                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                   a1,
                                   off_1C000B018);//pDeviceContext_v4 = GetDeviceContext(Device_a1);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v10 = a2 - 1;//state_v10 = PreviousState_a2-1;
    WPP_RECORDER_SF_qd(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      1u,
      0xDu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids,
      a1,
      v10);
  }
  v5 = HidInitialize(v4, a2);//status_v5 = HidInitialize(pDeviceContext_v4 ,PreviousState_a2
  if ( v5 >= 0 )
  {
    PowerIdleIrpCompletion(v4);//pDeviceContext_v4
    if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )//
    {
      LODWORD(v9) = v5;
      McTemplateK0pq(v6, &EVENT_HIDI2C_ENUMERATION_OK, v7, a1, v9);
    }
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xEu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  return (unsigned int)v5;
}
// 1C0001BEA: variable 'v6' is possibly undefined
// 1C0001BEA: variable 'v7' is possibly undefined
// 1C0001BEA: variable 'v9' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0001C50) ----------------------------------------------------
__int64 __fastcall OnPostInterruptsEnabled(struct WDFDEVICE__ *a1, enum _WDF_POWER_DEVICE_STATE a2)//Device_a1, PreviousState_a2
{
  unsigned int v4; // ebx
  struct _DEVICE_CONTEXT *v5; // rax
  int v6; // eax
  __int64 v7; // r8
  const GUID *v8; // r9

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xFu,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  v4 = 0;
  v5 = (struct _DEVICE_CONTEXT *)(*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                  + 202))(
                                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                   a1,
                                   off_1C000B018);//pDeviceContext_v5 = GetDeviceContext(Device_a1);
  if ( a2 == WdfPowerDeviceD3Final )
  {
    v6 = HidReset(v5);//pDeviceContext_v5
    v4 = v6;
    if ( v6 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          6u,
          0x10u,
          (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids,
          v6);
      DeviceReportPnpProblem((__int64)a1, 3221291012i64, v7, v8);//Device_a1 , 0xC0010004
    }
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x11u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  return v4;
}
// 1C0001D18: variable 'v7' is possibly undefined
// 1C0001D18: variable 'v8' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0001D70) ----------------------------------------------------
__int64 __fastcall OnReleaseHardware(struct WDFDEVICE__ *a1, struct WDFCMRESLIST__ *a2)
{
  __int64 v3; // rbx

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x15u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  v3 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a1,
         off_1C000B018);//pDeviceContext_v3 = GetDeviceContext(Device_a1);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      3u,
      0x16u,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids);
  
  if ( *(_QWORD *)(v3 + 88) )//pDeviceContext->SpbRequest
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfObjectDelete(pDeviceContext->SpbRequest); 
  
  if ( *(_QWORD *)(v3 + 72) )//pDeviceContext->SpbIoTarget
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfObjectDelete(pDeviceContext->SpbIoTarget); 
  
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      3u,
      0x17u,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
        WPP_RECORDER_SF_(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          5u,
          3u,
          0x18u,
          (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids);
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
        WPP_RECORDER_SF_(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          5u,
          1u,
          0x16u,
          (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
    }
  }
  return 0i64;
}
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0001F30) ----------------------------------------------------
__int64 __fastcall OnSelfManagedIoSuspend(struct WDFDEVICE__ *a1)
{
  __int64 v1; // rdx
  __int64 v2; // r8

  v1 = *(_QWORD *)((*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                    + 202))(
                     WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                     a1,
                     off_1C000B018)//pDeviceContext =GetDeviceContext(device_a1);
                 + 168);////pDeviceContext->timerHandle;??
  if ( v1 )
  {
    LOBYTE(v2) = 1;//=TRUE
    (*((void (__fastcall **)(PVOID, __int64, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 320))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfTimerStop(pDeviceContext->timerHandle, TRUE);
      v1,
      v2);
  }
  return 0i64;
}
// 1C0001F7D: variable 'v2' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;

//----- (00000001C0001F90) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qq(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...)
{
  int v8; // [rsp+20h] [rbp-38h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 0x10) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids,
      a4,
      va);
  LOWORD(v8) = a4;
  return WppAutoLogTrace(a1, 4i64, 5i64, &WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids, v8, va);
}
// 1C000203E: variable 'v8' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002060) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qqd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rdi
  int v10; // eax
  int v12; // [rsp+20h] [rbp-58h]
  va_list va; // [rsp+A8h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, ((_BYTE)a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= a2 )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v12, va);
}
// 1C0002187: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C00021B4) ----------------------------------------------------
__int64 __fastcall WPP_RECORDER_SF_sqq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, const char *a6)
{
  const char *v6; // rsi
  __int64 v7; // rbx
  __int64 v9; // rdx
  const char *v10; // rcx
  int v12; // [rsp+20h] [rbp-58h]

  v6 = "NULL";
  v7 = -1i64;
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 0x10) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
  {
    if ( a6 )
    {
      v9 = -1i64;
      do
        ++v9;
      while ( a6[v9] );
    }
    v10 = "NULL";
    if ( a6 )
      v10 = a6;
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids,
      10i64,
      v10);
  }
  if ( a6 )
  {
    do
      ++v7;
    while ( a6[v7] );
  }
  if ( a6 )
    v6 = a6;
  LOWORD(v12) = 10;
  return WppAutoLogTrace(a1, 4i64, 5i64, &WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids, v12, v6);
}
// 1C00022F3: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002320) ----------------------------------------------------
void __fastcall OnInternalDeviceIoControl(struct WDFQUEUE__ *a1, struct WDFREQUEST__ *a2, __int64 a3, __int64 a4, unsigned int a5)
	//Queue_a1, Request_a2, OutputBufferLength_a3 ,InputBufferLength_a4 ,IoControlCode_a5
{
  __int64 v6; // rax
  __int64 v7; // rsi
  unsigned int v8; // ebx
  const char *v9; // rax
  __int64 v10; // rdx
  __int64 v11; // r8
  __int64 v12; // r9
  unsigned int v13; // ebx
  unsigned int v14; // ebx
  unsigned int v15; // ebx
  unsigned int v16; // ebx
  unsigned int v17; // ebx
  unsigned int v18; // eax
  unsigned int v19; // ebx
  unsigned int v20; // eax
  unsigned int v21; // ebx
  unsigned int v22; // ebx
  unsigned int v23; // ebx
  unsigned int v24; // ebx
  int v25; // eax
  __int64 v26; // rdx
  __int64 v27; // r8
  int v28; // er8
  int v29; // [rsp+20h] [rbp-38h]
  __int64 v30; // [rsp+38h] [rbp-20h]
  unsigned __int8 v31[24]; // [rsp+40h] [rbp-18h] BYREF

  v31[0] = 0;//BOOLEAN requestPendingFlag=FALSE;//经检查实际没有数组后续其他位数调用//buffer_v31[0] =requestPendingFlag,
  v6 = (*((__int64 (__fastcall **)(PVOID, struct WDFQUEUE__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 157))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a1);//device_v6=WdfIoQueueGetDevice(Queue_a1);
  v7 = (*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         v6,
         off_1C000B018);//pDeviceContext_v7=GetDeviceContext(device_v6);
  v8 = a5; //IoControlCode_v8=IoControlCode_a5
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v9 = _DbgInternalIoctlString(a5);//string_v9=_DbgInternalIoctlString(IoControlCode_a5)
    HIDWORD(v30) = HIDWORD(a2);//v30=request_a2
    WPP_RECORDER_SF_sqq((__int64)WPP_GLOBAL_Control->DeviceExtension, v10, v11, v12, v29, v9);
  }
  if ( v8 <= 0xB002B )//
  {
    if ( v8 == 720939 ) //IoControlCode ==IOCTL_HID_SEND_IDLE_NOTIFICATION_REQUEST//0xB002B
    {
      v20 = HidSendIdleNotification((struct _DEVICE_CONTEXT *)v7, a2, v31);//ntstatus_v20=   HidSendIdleNotification(pDeviceContext_v7,request_a2,&requestPendingFlag
    }
    else
    {
      v13 = v8 - 720899;//v13 =IoControlCode -0xB0003
      if ( !v13 )//IoControlCode ==IOCTL_HID_GET_DEVICE_DESCRIPTOR//0xB0003
      {
        v18 = HidGetDeviceDescriptor((struct _DEVICE_CONTEXT *)v7, a2);//ntstatus_v18 = HidGetDeviceDescriptor(pDeviceContext_v7,request_a2
        goto LABEL_12;
      }
      v14 = v13 - 4;//v14 =IoControlCode -0xB0007
      if ( !v14 )//IoControlCode ==IOCTL_HID_GET_REPORT_DESCRIPTOR//0xb0007
      {
        v18 = HidGetReportDescriptor((struct _DEVICE_CONTEXT *)v7, a2);////ntstatus_v18 = HidGetReportDescriptor(  pDeviceContext_v7,request_a2
        goto LABEL_12;
      }
      v15 = v14 - 4;//v15 =IoControlCode -0xb000b
      if ( v15 )//if (IoControlCode != IOCTL_HID_READ_REPORT)//0xb000b
      {
        v16 = v15 - 4;//v16 =IoControlCode -0xB000f
        if ( !v16 )//IoControlCode ==IOCTL_HID_WRITE_REPORT//0xB000f
        {
          v18 = HidWriteReport((struct _DEVICE_CONTEXT *)v7, a2);////ntstatus_v18=   HidWriteReport( pDeviceContext_v7,request_a2
          goto LABEL_12;
        }
        v17 = v16 - 4;//v17 =IoControlCode -0xb0013
        if ( !v17 )//IoControlCode ==IOCTL_HID_GET_STRING//0xb0013
        {
          v18 = HidGetString((struct _DEVICE_CONTEXT *)v7, a2);//,ntstatus_v18 = HidGetString((struct _DEVICE_CONTEXT *)pDeviceContext_v7, request_a2);
          goto LABEL_12;
        }
        if ( v17 == 20 )//IoControlCode == IOCTL_HID_GET_DEVICE_ATTRIBUTES//IoControlCode -0xB0013==0x14//IoControlCode==0xB0027
        {
          v18 = HidGetDeviceAttributes((struct _DEVICE_CONTEXT *)v7, a2);//ntstatus_v18=  HidGetDeviceAttributes(     pDeviceContext_v7,request_a2)
LABEL_12:
          v19 = v18; //ntstatus_v19=ntstatus_v18
LABEL_36:
          (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 263))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,
            a2,
            v19);//WdfRequestComplete(request_a2, ntstatus_v19);
          return;
        }
LABEL_24://default:
        v19 = -1073741637;//ntstatus_v19=STATUS_NOT_SUPPORTED             ((NTSTATUS)0xC00000BBL)
        goto LABEL_36;
      }
      v20 = HidReadReport((struct _DEVICE_CONTEXT *)v7, a2, v31);  //ntstatus_v20=HidReadReport(pDeviceContext_v7,request_a2,&requestPendingFlag);
    }
LABEL_35:
    v19 = v20;//ntstatus_v19
    if ( v31[0] )//requestPendingFlag
      return;
    goto LABEL_36;
  }
  v21 = v8 - 721297;// v21 =IoControlCode - 0xB0191
  if ( !v21 )//IoControlCode  ==IOCTL_HID_SET_FEATURE
  {
    v20 = HidSetReport(v7, (__int64)a2, 3);//ntstatus_v20=HidSetReport(pDeviceContext_v7, request_a2, 3);  //HID_REPORT_TYPE =ReportTypeFeature
    goto LABEL_35;
  }
  v22 = v21 - 1;//v22 =IoControlCode - 0xB0192
  if ( !v22 )//IoControlCode ==IOCTL_HID_GET_FEATURE
  {
    v28 = 3;  //HID_REPORT_TYPE =ReportTypeFeature
    goto LABEL_31;
  }
  v23 = v22 - 3;//v23 =IoControlCode - 0xB0195
  if ( !v23 )//IoControlCode  ==IOCTL_HID_SET_OUTPUT_REPORT
  {
    v18 = HidSetReport(v7, (__int64)a2, 2);//HID_REPORT_TYPE = ReportTypeOutput
    goto LABEL_12;
  }
  v24 = v23 - 13;//v24 =IoControlCode - 0xB01a2
  if ( !v24 )////IoControlCode ==IOCTL_HID_GET_INPUT_REPORT//0xB01a2
  {
    v28 = 1;//HID_REPORT_TYPE = ReportTypeInput
LABEL_31:
    v18 = HidGetReport(v7, (__int64)a2, v28);//ntstatus_v18=HidGetReport(pDeviceContext_v7,request_a2, ReportTypeInput
    goto LABEL_12;
  }
  if ( v24 != 145 )//IoControlCode_!=IOCTL_HID_DEVICERESET_NOTIFICATION// IoControlCode - 0xB01a2 != 0x91//IoControlCode != 0xB0233
    goto LABEL_24;
  (*((void (__fastcall **)(PVOID, _QWORD, unsigned int *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 153))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,
    *(_QWORD *)(v7 + 64),/////pDeviceContext->ResetNotificationQueue// //注意偏移8*8 =40所以是Queue_8
    &a5,
    0i64);//WdfIoQueueGetState(pDeviceContext->ResetNotificationQueue, &IoControlCode_a5, NULL);
  v25 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 281))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,
          a2,
          *(_QWORD *)(v7 + 64));//status = WdfRequestForwardToIoQueue(Request, pDeviceContext->ResetNotificationQueue);
        
   
  v19 = v25;//ntstatus_v19=ntstatus_v25
  if ( v25 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v30) = v25;
      WPP_RECORDER_SF_qqd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        5u,
        0xCu,
        (__int64)&WPP_e41706a9c2f4318f0fc3c113099c0cfa_Traceguids,
        a2,//request_a2
        *(_QWORD *)(v7 + 64),///Queue_8// //注意偏移8*8 =40所以是Queue_8
        v30);
    }
    goto LABEL_36;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_qq((__int64)WPP_GLOBAL_Control->DeviceExtension, v26, v27, 0xBu, v29);
}
// 1C00023C1: variable 'v10' is possibly undefined
// 1C00023C1: variable 'v11' is possibly undefined
// 1C00023C1: variable 'v12' is possibly undefined
// 1C00023C1: variable 'v29' is possibly undefined
// 1C0002525: variable 'v26' is possibly undefined
// 1C0002525: variable 'v27' is possibly undefined
// 1C0002571: variable 'v30' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0002610) ----------------------------------------------------
void __fastcall OnIoStop(struct WDFQUEUE__ *a1, struct WDFREQUEST__ *a2, char a3)//EvtWdfIoQueueIoStop(  WDFQUEUE Queue,  WDFREQUEST Request,  ULONG ActionFlags)
{
  __int64 v5; // rdx
  __int64 v6; // r8
  int v7; // [rsp+20h] [rbp-68h]
  int v8[10]; // [rsp+40h] [rbp-48h] BYREF

//WDF_REQUEST_PARAMETERS RequestParameters;
//	WDF_REQUEST_PARAMETERS_INIT(&RequestParameters);

  memset(v8, 0, sizeof(v8));
  LOWORD(v8[0]) = 40;
  (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, int *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 266))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,
    a2,
    v8);//	WdfRequestGetParameters(Request, &RequestParameters);
  if ( v8[1] == 15 && v8[6] == 720939 && (a3 & 1) != 0 )//
  //if (RequestParameters.Type == WdfRequestTypeDeviceControlInternal && RequestParameters.Parameters.DeviceIoControl.IoControlCode == IOCTL_HID_SEND_IDLE_NOTIFICATION_REQUEST && (ActionFlags & 1) != 0)//RequestParameters.Parameters.Others.IoControlCode
  {
    (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 284))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestStopAcknowledge(Request, 0)
      a2,//Request
      0i64);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_qq((__int64)WPP_GLOBAL_Control->DeviceExtension, v5, v6, 0xDu, v7);
  }
}
// 1C00026D1: variable 'v5' is possibly undefined
// 1C00026D1: variable 'v6' is possibly undefined
// 1C00026D1: variable 'v7' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00026FC) ----------------------------------------------------
char *__fastcall _DbgInternalIoctlString(unsigned int a1)
{
  unsigned int v1; // ecx
  unsigned int v2; // ecx
  unsigned int v3; // ecx
  unsigned int v4; // ecx
  unsigned int v5; // ecx
  unsigned int v7; // ecx
  unsigned int v8; // ecx
  unsigned int v9; // ecx
  unsigned int v10; // ecx

  if ( a1 <= 0xB002B )
  {
    if ( a1 == 720939 )
      return "IOCTL_HID_SEND_IDLE_NOTIFICATION_REQUEST";
    v1 = a1 - 720899;
    if ( !v1 )
      return "IOCTL_HID_GET_DEVICE_DESCRIPTOR";
    v2 = v1 - 4;
    if ( !v2 )
      return "IOCTL_HID_GET_REPORT_DESCRIPTOR";
    v3 = v2 - 4;
    if ( !v3 )
      return "IOCTL_HID_READ_REPORT";
    v4 = v3 - 4;
    if ( !v4 )
      return "IOCTL_HID_WRITE_REPORT";
    v5 = v4 - 4;
    if ( !v5 )
      return "IOCTL_HID_GET_STRING";
    if ( v5 == 20 )
      return "IOCTL_HID_GET_DEVICE_ATTRIBUTES";
    return "Unknown IOCTL";
  }
  v7 = a1 - 721297;
  if ( !v7 )
    return "IOCTL_HID_SET_FEATURE";
  v8 = v7 - 1;
  if ( !v8 )
    return "IOCTL_HID_GET_FEATURE";
  v9 = v8 - 3;
  if ( !v9 )
    return "IOCTL_HID_SET_OUTPUT_REPORT";
  v10 = v9 - 13;
  if ( !v10 )
    return "IOCTL_HID_GET_INPUT_REPORT";
  if ( v10 != 145 )
    return "Unknown IOCTL";
  return "IOCTL_HID_DEVICERESET_NOTIFICATION";
}

//----- (00000001C00027B8) ----------------------------------------------------
__int64 RtlUnicodeStringPrintf(struct _UNICODE_STRING *a1, const unsigned __int16 *a2, ...)
{
  USHORT v3; // cx
  wchar_t *v4; // r10
  unsigned __int64 v5; // rdi
  int v6; // ebx
  USHORT v7; // ax
  int v8; // eax
  va_list Args; // [rsp+60h] [rbp+18h] BYREF

  va_start(Args, a2);
  v3 = a1->Length;
  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  if ( (v3 & 1) != 0 || (v7 = a1->MaximumLength, (v7 & 1) != 0) || v3 > v7 || v7 == 0xFFFF )
  {
    v6 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
  }
  else
  {
    if ( !a1->Buffer && (v3 || v7) )
    {
      v6 = -1073741811;///STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    }
    else
    {
      v4 = a1->Buffer;
      v5 = (unsigned __int64)v7 >> 1;
    }
    if ( v6 >= 0 )
    {
      v6 = 0;
      v8 = _vsnwprintf(v4, v5, a2, Args);
      if ( v8 < 0 || v8 > v5 )
      {
        LOWORD(v8) = v5;
        v6 = -2147483643;
      }
      a1->Length = 2 * v8;
    }
  }
  return (unsigned int)v6;
}

//----- (00000001C0002870) ----------------------------------------------------
void __fastcall TraceLoggingBusDevice(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C0009781, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0002924) ----------------------------------------------------
ULONG McTemplateK0pp(__int64 a1, const EVENT_DESCRIPTOR *a2, const GUID *a3, ...)
{
  EVENT_DATA_DESCRIPTOR v4; // [rsp+30h] [rbp-48h] BYREF
  va_list v5; // [rsp+40h] [rbp-38h]
  int v6; // [rsp+48h] [rbp-30h]
  int v7; // [rsp+4Ch] [rbp-2Ch]
  va_list v8; // [rsp+50h] [rbp-28h]
  int v9; // [rsp+58h] [rbp-20h]
  int v10; // [rsp+5Ch] [rbp-1Ch]
  __int64 v11; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  va_list va1; // [rsp+A0h] [rbp+28h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v11 = va_arg(va1, _QWORD);
  va_copy(v5, va);
  v7 = 0;
  v6 = 8;
  va_copy(v8, va1);
  v10 = 0;
  v9 = 8;
  return McGenEventWrite((PMCGEN_TRACE_CONTEXT)8, a2, a3, 3u, &v4);
}

//----- (00000001C0002990) ----------------------------------------------------
__int64 WPP_RECORDER_SF_LLd(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rbx
  int v9; // eax
  int v11; // [rsp+20h] [rbp-48h]
  va_list va; // [rsp+98h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v9 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v9, (a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= 2u )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v11) = a4;
  return WppAutoLogTrace(a1, 2i64, a3, a5, v11, va);
}
// 1C0002AB2: variable 'v11' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002AE0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_Ld(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rbx
  int v9; // eax
  int v11; // [rsp+20h] [rbp-38h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v9 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v9, (a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= 2u )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v11) = a4;
  return WppAutoLogTrace(a1, 2i64, a3, a5, v11, va);
}
// 1C0002BDE: variable 'v11' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002C0C) ----------------------------------------------------
__int64 __fastcall WPP_RECORDER_SF_Zd(__int64 a1, unsigned __int8 a2, __int64 a3, unsigned __int16 a4, __int64 a5, const wchar_t *a6)
{
  unsigned __int64 v6; // rdi
  const wchar_t *v7; // r14
  int v10; // eax
  const wchar_t *v11; // rcx
  bool v12; // zf
  int v14; // [rsp+20h] [rbp-78h]
  __int64 v15; // [rsp+A0h] [rbp+8h]
  unsigned int v16; // [rsp+B0h] [rbp+18h]

  v16 = a3;
  v15 = a1;
  v6 = (unsigned __int64)(unsigned int)a3 >> 16;
  v7 = L"\b";
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v6 + (((unsigned int)(a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, (a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v6 + 1) >= a2 )
  {
    v11 = L"\b";
    if ( a6 )
      v11 = a6;
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v6), 43i64, a5, a4, v11);
    a3 = v16;
    a1 = v15;
  }
  v12 = a6 == 0i64;
  if ( a6 )
    v12 = a6 == 0i64;
  if ( !v12 )
    v7 = a6;
  LOWORD(v14) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v14, v7);
}
// 1C0002D8E: variable 'v14' is possibly undefined
// 1C0009594: using guessed type wchar_t asc_1C0009594[2];
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002DB8) ----------------------------------------------------
__int64 WPP_RECORDER_SF_i(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-28h]
  va_list va; // [rsp+78h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 4) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
      11i64,
      va);
  LOWORD(v7) = 11;
  return WppAutoLogTrace(a1, 4i64, 3i64, &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids, v7, va);
}
// 1C0002E45: variable 'v7' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002E64) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qLd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...)
{
  int v8; // [rsp+20h] [rbp-58h]
  va_list va; // [rsp+A8h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 4) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 2u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
      a4,
      va);
  LOWORD(v8) = a4;
  return WppAutoLogTrace(a1, 2i64, 3i64, &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids, v8, va);
}
// 1C0002F3E: variable 'v8' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0002F64) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qLqLd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...)
{
  int v8; // [rsp+20h] [rbp-78h]
  va_list va; // [rsp+C8h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 4) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 2u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
      a4,
      va);
  LOWORD(v8) = a4;
  return WppAutoLogTrace(a1, 2i64, 3i64, &WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids, v8, va);
}
// 1C000307F: variable 'v8' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C00030AC) ----------------------------------------------------
__int64 __fastcall SpbInitialize(struct _DEVICE_CONTEXT *a1, struct WDFCMRESLIST__ *a2, struct WDFCMRESLIST__ *a3)
	//NTSTATUS SpbInitialize(DEVICE_CONTEXT_v6, FxResourcesRaw_a2, FxResourcesTranslated_a3); 
{
  unsigned int v5; // ebx
  unsigned int v6; // er13
  char v7; // r14
  char v8; // si
  __int64 v9; // r8
  const GUID *v10; // r9
  unsigned int v11; // er12
  __int64 v12; // rdx
  __int64 v13; // rcx
  __int64 v14; // rdx
  __int64 *v15; // rsi
  struct _MCGEN_TRACE_CONTEXT *v16; // rcx
  int v17; // ebx
  __int64 v18; // r8
  const GUID *v19; // r9
  __int64 v20; // rdx
  __int64 v21; // r8
  unsigned __int16 v22; // r9
  unsigned int v23; // er8
  _QWORD *v24; // rax
  __int64 v25; // rax
  __int64 v26; // rdx
  __int64 v28; // [rsp+20h] [rbp-E0h]
  __int64 v29; // [rsp+28h] [rbp-D8h]
  __int64 v30; // [rsp+40h] [rbp-C0h] BYREF
  struct _UNICODE_STRING v31; // [rsp+48h] [rbp-B8h] BYREF
  struct WDFCMRESLIST__ *v32; // [rsp+58h] [rbp-A8h]
  _QWORD v33[8]; // [rsp+60h] [rbp-A0h] BYREF
  __int64 v34[14]; // [rsp+A0h] [rbp-60h] BYREF
  __int128 v35[9]; // [rsp+110h] [rbp+10h] BYREF
  wchar_t Dest[2]; // [rsp+1A0h] [rbp+A0h] BYREF
  __int128 v37; // [rsp+1A4h] [rbp+A4h]
  int v38; // [rsp+1B4h] [rbp+B4h]
  int v39; // [rsp+1B8h] [rbp+B8h]
  int v40; // [rsp+1BCh] [rbp+BCh]
  __int64 v41; // [rsp+1C0h] [rbp+C0h]
  __int64 v42; // [rsp+1C8h] [rbp+C8h]
  void *v43; // [rsp+1D0h] [rbp+D0h]
  char v44; // [rsp+1E0h] [rbp+E0h] BYREF

  v32 = a2;//= WDFCMRESLIST FxResourcesRaw_v32 =FxResourcesRaw_a2;
  v5 = 0;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      3u,
      0xAu,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids);
  v6 = 0;//USHORT interruptIndex=0;
  v7 = 0;//connFound =false;
  v8 = 0;//interruptFound =false;
  v11 = (*((__int64 (__fastcall **)(PVOID, struct WDFCMRESLIST__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 304))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,
          a3);//ULONG resourceCount_v11 = WdfCmResourceListGetCount(FxResourcesTranslated_a3);
  while ( (!v7 || !v8) && v5 < v11 )//while( ( !connFound || interruptFound ) && ULONG_i_v5 < resourceCount_v11)
  {
    v13 = (*((__int64 (__fastcall **)(PVOID, struct WDFCMRESLIST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 305))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,
            a3,
            v5);//PCM_PARTIAL_RESOURCE_DESCRIPTOR pDescriptor_v13 = WdfCmResourceListGetDescriptor(FxResourcesTranslated_a3, ULONG_i_v5);
    if ( *(_BYTE *)v13 == 2 )//pDescriptor_v13->Type ==CmResourceTypeInterrupt
    {
      v8 = 1;//fInterruptResourceFound =true;//interruptFound = TRUE;
      v6 = v5;//interruptIndex = ULONG_i_v5;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v29) = v5;
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          3u,
          0xCu,
          (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
          v29);
      }
    }
    else if ( *(_BYTE *)v13 == 0x84 && *(_BYTE *)(v13 + 4) == 2 && *(_BYTE *)(v13 + 5) == 1 )// 
    //else if(pDescriptor_v13->Type == 0x84 && pDescriptor->u.Connection.Class ==2 && pDescriptor->u.Connection.Type ==1) 
    {
      v7 = 1;//fConnectionIdFound = TRUE;//connFound = TRUE;
      *((_DWORD *)a1 + 20) = *(_DWORD *)(v13 + 8);///pDeviceContext->SpbConnectionId.LowPart = pDescriptor->u.Connection.IdLowPart;
      *((_DWORD *)a1 + 21) = *(_DWORD *)(v13 + 12);//pDeviceContext->SpbConnectionId..HighPart = pDescriptor->u.Connection.IdHighPart;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v29 = *((_QWORD *)a1 + 10);
        WPP_RECORDER_SF_i((__int64)WPP_GLOBAL_Control->DeviceExtension, v12, v9, (__int64)v10, v28);
      }
    }
    ++v5;
  }
  if ( !v7 || !v8 )
  {
    v17 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v29) = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0xDu,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v29);
    }
    DeviceReportPnpProblem(*(_QWORD *)a1, 3221291013i64, v9, v10);
    goto LABEL_49;
  }


//WDF_OBJECT_ATTRIBUTES targetAttributes;
 //WDF_OBJECT_ATTRIBUTES_INIT(&targetAttributes);
  memset(v34, 0, 0x38ui64);
  v14 = *(_QWORD *)a1;//
  v15 = (__int64 *)((char *)a1 + 72);//pDeviceContext->SpbIoTarget
  LODWORD(v34[0]) = 56;
  v34[3] = 0x100000001i64;
  
  v17 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64 *, char *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 167))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,// status = WdfIoTargetCreate(pDeviceContext->Device,&targetAttributes, pDeviceContext->SpbIoTarget);
          v14,
          v34,
          (char *)a1 + 72);//pDeviceContext->SpbIoTarget
  if ( v17 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v29) = v17;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0xEu,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v29);
    }
    if ( *v15 )
      (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfDeleteObjectSafe(FxDeviceContext->SpbIoTarget);//WdfObjectDelete(
    goto LABEL_49;
  }
  
  //
  *(_QWORD *)&v31.Length = 9961472i64;//DECLARE_UNICODE_STRING_SIZE(spbDevicePathName_v31, RESOURCE_HUB_PATH_SIZE);
  v31.Buffer = (PWSTR)&v44;
  v30 = *((_QWORD *)a1 + 10);
  HIDWORD(v28) = HIDWORD(v30);
  v17 = RtlStringCbPrintfW(Dest, 0x22ui64, L"%0*I64x");//status = RESOURCE_HUB_CREATE_PATH_FROM_ID( &spbDevicePathName_v31, pDeviceContext->SpbConnectionId.LowPart, pDeviceContext->SpbConnectionId.HighPart);
  if ( v17 >= 0 )
    v17 = RtlUnicodeStringPrintf(&v31, L"%s%s", L"\\Device\\RESOURCE_HUB\\", Dest);//和上面合并效果
  if ( v17 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_Zd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3i64,
        0xFu,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        &v31.Length);
    goto LABEL_49;
  }
  
  //WDF_IO_TARGET_OPEN_PARAMS_INIT_OPEN_BY_NAME(&openParams, &spbDevicePathName_v31, (GENERIC_READ | GENERIC_WRITE));
//	openParams.ShareAccess = 0;
//	openParams.CreateDisposition = FILE_OPEN;
//	openParams.FileAttributes = FILE_ATTRIBUTE_NORMAL;
  memset(v35, 0, 0x88ui64);
  v20 = *v15;
  v35[3] = (__int128)v31;//spbDevicePathName_v31
  *(_QWORD *)&v35[0] = 0x200000088i64;
  *(_QWORD *)&v35[4] = 3221225472i64;
  LODWORD(v35[5]) = 64;
  *((_QWORD *)&v35[4] + 1) = 0x100000080i64;
  v17 = (*((__int64 (__fastcall **)(PVOID, __int64, __int128 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 168))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfIoTargetOpen( FxDeviceContext->SpbIoTarget, &openParams);
          v20,
          v35);
  if ( v17 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_qd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0x10u,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        *v15,
        v17);
    goto LABEL_49;
  }
  v21 = *v15;
  v43 = off_1C000B0F0;
  v37 = 0i64;
  v38 = 0;
  v42 = 0i64;
  *(_DWORD *)Dest = 56;
  v39 = 1;
  v40 = 1;
  v41 = v21;
  v17 = (*((__int64 (__fastcall **)(PVOID, wchar_t *, __int64, char *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 247))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v17 = WdfRequestCreate(
          Dest,//&RequestAttributes_Dest
          v21,//IoTarget_v21
          (char *)a1 + 88);//pDeviceContext->SpbRequest
  if ( v17 >= 0 )
  {
    v24 = (_QWORD *)(*((__int64 (__fastcall **)(PVOID, _QWORD, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
                      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PREQUEST_CONTEXT pRequestContext = GetRequestContext(FxRequest);
                      *((_QWORD *)a1 + 11),//pDeviceContext->SpbRequest//注意偏移11*8=88所以是SpbRequest
                      off_1C000B0F0);
    *v24 = *(_QWORD *)a1;
    v24[1] = 0i64;
    memset(v33, 0, 0x38ui64);
    v33[4] = *(_QWORD *)a1;//Attributes.ParentObject = FxDeviceContext->FxDevice;
    LODWORD(v33[0]) = 56;
    v33[3] = 0x100000001i64;
    v17 = (*((__int64 (__fastcall **)(PVOID, _QWORD *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 312))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfWaitLockCreate(  &lockAttributes, &interruptLock);
            v33,
            &v30);
    if ( v17 >= 0 )
    {
    	// WDF_INTERRUPT_CONFIG interruptConfig;
      memset(v34, 0, 0x68ui64);
      v34[3] = (__int64)OnInterruptIsr; // WDF_INTERRUPT_CONFIG_INIT( &interruptConfig,  OnInterruptIsr,  NULL);
      v34[10] = v30;//// interruptConfig.WaitLock = interruptLock;
      LODWORD(v34[0]) = 104; 
      LODWORD(v34[2]) = 2;
      v34[4] = 0i64;
      HIDWORD(v34[11]) = 2;
      LOBYTE(v34[11]) = 1;// //interruptConfig.PassiveHandling = TRUE;
      v34[9] = (*((__int64 (__fastcall **)(PVOID, struct WDFCMRESLIST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                + 305))(
                 WPP_MAIN_CB.Queue.Wcb.DeviceContext,//interruptConfig.InterruptTranslated =  WdfCmResourceListGetDescriptor(  FxResourcesTranslated,   interruptIndex);
                 a3,
                 v6);
      v25 = (*((__int64 (__fastcall **)(PVOID, struct WDFCMRESLIST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 305))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//interruptConfig.InterruptRaw = WdfCmResourceListGetDescriptor(FxResourcesRaw, interruptIndex);
              v32,
              v6);
      v26 = *(_QWORD *)a1;
      v34[8] = v25;
      v34[4] = (__int64)OnInterruptDpc;
      v17 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64 *, _QWORD, char *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
             + 141))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfInterruptCreate(    
              v26,// FxDeviceContext->FxDevice,
              v34,//&interruptConfig,
              0i64,//WDF_NO_OBJECT_ATTRIBUTES,
              (char *)a1 + 16);//&pDeviceContext->ReadInterrupt);
      if ( v17 >= 0 )
      {	  
      	  //WDF_OBJECT_ATTRIBUTES_INIT(&lockAttributes); 
        memset(v33, 0, 0x38ui64);
        v33[4] = *(_QWORD *)a1;////lockAttributes.ParentObject = FxDeviceContext->FxDevice;
        LODWORD(v33[0]) = 56;
        v33[3] = 0x100000001i64;
        v17 = (*((__int64 (__fastcall **)(PVOID, _QWORD *, char *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 315))(
                WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfSpinLockCreate( &lockAttributes, &FxDeviceContext->InProgressLock);
                v33,
                (char *)a1 + 8);//pDeviceContext->InProgressLock_8
        if ( v17 >= 0 )
          goto LABEL_52;
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_49;
        v22 = 20;
      }
      else
      {
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_49;
        v22 = 19;
      }
    }
    else
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_49;
      v22 = 18;
    }
    v23 = 1;
    goto LABEL_35;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v22 = 17;
    v23 = 3;
LABEL_35:
    LODWORD(v29) = v17;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      v23,
      v22,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
      v29);
  }
LABEL_49:
  if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 2) != 0 )
  {
    LODWORD(v28) = v17;
    McTemplateK0pq(v16, &EVENT_HIDI2C_ENUMERATION_SPB_FAILURE, v18, *(_QWORD *)a1, v28);
  }
  TraceLoggingBusDevice(v17, *(struct WDFDEVICE__ **)a1, v18, v19);
LABEL_52:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      3u,
      0x15u,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids);
  return (unsigned int)v17;
}
// 1C000377C: conditional instruction was optimized away because of 'ebx.4<0'
// 1C00031DB: variable 'v12' is possibly undefined
// 1C00031DB: variable 'v9' is possibly undefined
// 1C00031DB: variable 'v10' is possibly undefined
// 1C00031DB: variable 'v28' is possibly undefined
// 1C000321F: variable 'v29' is possibly undefined
// 1C0003795: variable 'v16' is possibly undefined
// 1C0003795: variable 'v18' is possibly undefined
// 1C000379F: variable 'v19' is possibly undefined
// 1C0009548: using guessed type wchar_t aDeviceResource[22];
// 1C000B0F0: using guessed type void *off_1C000B0F0;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0003818) ----------------------------------------------------
__int64 __fastcall SpbWrite(struct WDFIOTARGET__ *a1, __int64 a2, unsigned __int8 *a3, unsigned int a4, unsigned int a5)
{
  size_t v6; // rsi
  __int64 v8; // r15
  int v9; // ebx
  __int64 v10; // rdx
  struct WDFDEVICE__ *v11; // rax
  __int64 v12; // r8
  const GUID *v13; // r9
  int v15; // [rsp+20h] [rbp-51h]
  __int64 v16; // [rsp+28h] [rbp-49h]
  __int64 v17; // [rsp+28h] [rbp-49h]
  __int64 v18; // [rsp+30h] [rbp-41h]
  __int16 v19; // [rsp+40h] [rbp-31h]
  __int64 v20; // [rsp+48h] [rbp-29h] BYREF
  _WORD *v21; // [rsp+50h] [rbp-21h] BYREF
  __int64 v22; // [rsp+58h] [rbp-19h] BYREF
  __int64 v23[3]; // [rsp+60h] [rbp-11h] BYREF
  int v24[2]; // [rsp+78h] [rbp+7h] BYREF
  __int64 v25; // [rsp+80h] [rbp+Fh]

  v20 = 0i64;//WDFMEMORY memoryWrite = NULL;
  v6 = a4;
  v19 = a2;
  if ( a3 && a4 )
  {
    v8 = a4 + 2;//ULONG bufferLength = REG_SIZE + DataLength;
    v9 = (*((__int64 (__fastcall **)(PVOID, _QWORD, __int64, __int64, __int64, __int64 *, _WORD **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
          + 192))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryCreate(   
           0i64,//WDF_NO_OBJECT_ATTRIBUTES,
           512i64,//NonPagedPoolNx,
           1231317320i64,//0x49646948u//HIDI2C_POOL_TAG,
           v8,// bufferLength,
           &v20,//&memoryWrite,
           &v21);// (PVOID*)&pBuffer);
    if ( v9 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v16) = v9;
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          3u,
          0x1Au,
          (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
          v16);
      }
      goto LABEL_14;
    }
    
    //WDF_MEMORY_DESCRIPTOR  memoryDescriptor;
   // WDF_MEMORY_DESCRIPTOR_INIT_HANDLE( &memoryDescriptor, memoryWrite, NULL);
    v23[1] = v20;
    v23[0] = 3i64;
    v23[2] = 0i64;
    *v21 = v19;
    memmove(v21 + 1, a3, v6);// RtlCopyMemory(pBuffer, &RegisterAddress, REG_SIZE);    RtlCopyMemory((pBuffer + REG_SIZE), Data, DataLength);
    
    //WDF_REQUEST_SEND_OPTIONS sendOptions;
        //WDF_REQUEST_SEND_OPTIONS_INIT(&sendOptions, WDF_REQUEST_SEND_OPTION_TIMEOUT);
    v25 = -10000000i64 * a5;//sendOptions.Timeout = WDF_REL_TIMEOUT_IN_SEC(Timeout);
    v24[0] = 16;
    v24[1] = 1;
    v9 = (*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *, _QWORD, __int64 *, _QWORD, int *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
          + 184))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfIoTargetSendWriteSynchronously(                
           a1,//FxIoTarget,
           0i64,//NULL,
           v23,//&memoryDescriptor,
           0i64,// NULL,
           v24,//&sendOptions,
           &v22);//&bytesWritten);
    if ( v9 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v18) = v9;
        LODWORD(v17) = v22;
        WPP_RECORDER_SF_Ld(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          v10,
          3u,
          0x1Cu,
          (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
          v17,
          v18);
      }
LABEL_14:
      if ( v9 >= 0 )
        goto LABEL_16;
      goto LABEL_15;
    }
    if ( v22 == v8 )
      goto LABEL_14;
    v9 = -1073741434;////STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v18) = v6 + 2;
      LODWORD(v17) = v22;
      WPP_RECORDER_SF_LLd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v10,
        3u,
        0x1Du,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v17,
        v18,
        -1073741434);////STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
    }
  }
  else
  {
    v9 = -1073741811;//STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      WPP_RECORDER_SF_qLd((__int64)WPP_GLOBAL_Control->DeviceExtension, a2, (__int64)a3, 0x19u, v15);
      goto LABEL_14;
    }
  }
LABEL_15:
  v11 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                               + 174))(
                                WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoTargetGetState(FxIoTarget
                                a1);
  TraceLoggingBusDevice(v9, v11, v12, v13);
LABEL_16:
  if ( v20 )
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfObjectDelete(
  return (unsigned int)v9;
}
// 1C00038EA: variable 'v16' is possibly undefined
// 1C00039C6: variable 'v10' is possibly undefined
// 1C00039C6: variable 'v17' is possibly undefined
// 1C00039C6: variable 'v18' is possibly undefined
// 1C0003A52: variable 'v15' is possibly undefined
// 1C0003A7E: variable 'v12' is possibly undefined
// 1C0003A7E: variable 'v13' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0003AD0) ----------------------------------------------------
__int64 __fastcall SpbWritelessRead(struct WDFIOTARGET__ *a1, struct WDFREQUEST__ *a2, unsigned __int8 *a3, unsigned int a4, struct _GUID *a5)
{
  __int64 v9; // r13
  int v10; // ebx
  __int64 v11; // rax
  __int64 v12; // rcx
  __int64 v13; // rdx
  __int64 v14; // rcx
  struct WDFDEVICE__ *v15; // rax
  __int64 v16; // r8
  const GUID *v17; // r9
  int v19; // [rsp+20h] [rbp-61h]
  __int64 v20; // [rsp+28h] [rbp-59h]
  __int64 v21; // [rsp+30h] [rbp-51h]
  __int64 v22; // [rsp+40h] [rbp-41h] BYREF
  __int64 v23; // [rsp+48h] [rbp-39h] BYREF
  int v24; // [rsp+50h] [rbp-31h]
  __int64 v25; // [rsp+54h] [rbp-2Dh]
  int v26; // [rsp+5Ch] [rbp-25h]
  __int64 v27[3]; // [rsp+60h] [rbp-21h] BYREF
  int v28[2]; // [rsp+78h] [rbp-9h] BYREF
  __int64 v29; // [rsp+80h] [rbp-1h]

  if ( a3 && a4 )
  {
    v9 = *(_QWORD *)((*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                      + 202))(
                       WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PREQUEST_CONTEXT pRequestContext = GetRequestContext(FxRequest)
                       a2,
                       off_1C000B0F0)
                   + 8);//WDFMEMORY* pInputReportMemory_v9 = &pRequestContext->FxMemory;//注意pInputReportMemory_v9必需为指针，后续调用才对pRequestContext->FxMemory有效
    v10 = (*((__int64 (__fastcall **)(PVOID, __int64, unsigned __int8 *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
           + 195))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryAssignBuffer( pInputReportMemory, Data,  DataLength);
            v9,
            a3,
            a4);
    if ( v10 >= 0 )
    {
    	// WDF_MEMORY_DESCRIPTOR memoryDescriptor;
    //WDF_MEMORY_DESCRIPTOR_INIT_HANDLE( &memoryDescriptor,  inputReportMemory,   NULL);
      v27[0] = 3i64;
      v27[1] = v9;
      v27[2] = 0i64;
      
      //    WDF_REQUEST_REUSE_PARAMS    reuseParams;
    //WDF_REQUEST_REUSE_PARAMS_INIT(&reuseParams, WDF_REQUEST_REUSE_NO_FLAGS, STATUS_NOT_SUPPORTED);
      v25 = 0i64;
      v26 = 0;
      v23 = 24i64;
      v24 = -1073741637;
      
      (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 249))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestReuse(FxRequest, &reuseParams);
        a2,
        &v23);
      v28[0] = 16;
      v28[1] = 1;
      v29 = -10000000i64;
      v11 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PIRP_v11 = WdfRequestWdmGetIrp(Request)
              a2);
      IoSetActivityIdIrp(v11, a5);
      if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
        McTemplateK0pp(v12, &EVENT_HIDI2C_IO_SPBREAD_DISPATCH, a5, a1, a2);
      v22 = 0i64;//ULONG_PTR bytesRead = 0;
      v10 = (*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *, struct WDFREQUEST__ *, __int64 *, _QWORD, int *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
             + 182))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfIoTargetSendReadSynchronously(          
              a1,//  FxIoTarget,
              a2,//FxRequest,
              v27,// &memoryDescriptor,
              0i64,// NULL,
              v28,// &sendOptions,
              &v22);//  &bytesRead);
      if ( v10 >= 0 )
      {
        if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
          McTemplateK0pp(v14, &EVENT_HIDI2C_IO_SPBREAD_COMPLETE, a5, a1, a2);
      }
      else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v21) = v10;
        LODWORD(v20) = v22;
        WPP_RECORDER_SF_Ld(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          v13,
          3u,
          0x20u,
          (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
          v20,
          v21);
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0x1Fu,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v10);
    }
  }
  else
  {
    v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_16:
      v15 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                   + 174))(
                                    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfIoTargetGetState(FxIoTarget
                                    a1);
      TraceLoggingBusDevice(v10, v15, v16, v17);
      return (unsigned int)v10;
    }
    WPP_RECORDER_SF_qLd((__int64)WPP_GLOBAL_Control->DeviceExtension, (__int64)a2, (__int64)a3, 0x1Eu, v19);
  }
  if ( v10 < 0 )
    goto LABEL_16;
  return (unsigned int)v10;
}
// 1C0003C59: variable 'v12' is possibly undefined
// 1C0003CE4: variable 'v13' is possibly undefined
// 1C0003CE4: variable 'v20' is possibly undefined
// 1C0003CE4: variable 'v21' is possibly undefined
// 1C0003D06: variable 'v14' is possibly undefined
// 1C0003D3D: variable 'v19' is possibly undefined
// 1C0003D69: variable 'v16' is possibly undefined
// 1C0003D69: variable 'v17' is possibly undefined
// 1C000B0F0: using guessed type void *off_1C000B0F0;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;
// 1C000D060: using guessed type __int64 __fastcall IoSetActivityIdIrp(_QWORD, _QWORD);

//----- (00000001C0003D98) ----------------------------------------------------
__int64 __fastcall SpbRead(struct WDFIOTARGET__ *a1, __int64 a2, unsigned __int8 *a3, unsigned int a4, unsigned int a5, unsigned int a6)
{
  __int128 v7; // xmm0
  __int128 v8; // xmm1
  __int64 v9; // rdx
  int v10; // ebx
  struct WDFDEVICE__ *v11; // rax
  __int64 v12; // r8
  const GUID *v13; // r9
  int v15; // [rsp+20h] [rbp-79h]
  int v16; // [rsp+28h] [rbp-71h]
  unsigned int v17; // [rsp+28h] [rbp-71h]
  int v18; // [rsp+30h] [rbp-69h]
  int v19; // [rsp+38h] [rbp-61h]
  unsigned int v20; // [rsp+40h] [rbp-59h] BYREF
  __int128 v21; // [rsp+48h] [rbp-51h]
  __int128 v22; // [rsp+58h] [rbp-41h]
  int v23[4]; // [rsp+70h] [rbp-29h] BYREF
  __int128 v24; // [rsp+80h] [rbp-19h]
  __int128 v25; // [rsp+90h] [rbp-9h]
  __int128 v26; // [rsp+A0h] [rbp+7h]
  __int128 v27; // [rsp+B0h] [rbp+17h]
  __int16 v28; // [rsp+F8h] [rbp+5Fh] BYREF

  v28 = a2;
  if ( a3 && a4 )
  {

      v23[2] = 2;// //const ULONG transfers = 2; 
      v23[1] = 0;////SPB_TRANSFER_LIST_AND_ENTRIES(transfers)    sequence;  SPB_TRANSFER_LIST_INIT(&(sequence.List), transfers);
    v23[3] = 0;
      v23[0] = 48;
    
    v20 = 0;//ULONG bytesReturned = 0;
    ////sequence.List.Transfers[index] = SPB_TRANSFER_LIST_ENTRY_INIT_SIMPLE(SpbTransferDirectionToDevice, 0, &RegisterAddress, REG_SIZE);
    *((_QWORD *)&v21 + 1) = 1i64;
    *(_QWORD *)&v22 = &v28;
    *(_QWORD *)&v21 = 2i64;
    v7 = v21;
    *((_QWORD *)&v22 + 1) = 2i64;
    
    // sequence.List.Transfers[index + 1] = SPB_TRANSFER_LIST_ENTRY_INIT_SIMPLE(SpbTransferDirectionFromDevice, DelayUs, Data, DataLength);
    v8 = v22;
    *(_QWORD *)&v21 = 1i64;
    *(_QWORD *)&v22 = a3;
    *((_QWORD *)&v22 + 1) = a4;
    
    v24 = v7;
    v25 = v8;
    v26 = v21;
    v27 = v22;
    
    v10 = _SpbSequence(a1, v23, 80i64, &v20, a6);//status = ::_SpbSequence(FxIoTarget, &sequence, sizeof(sequence), &bytesReturned, Timeout);
    if ( v10 >= 0 )
    {
      if ( v20 < 2 )
      {
        v10 = -1073741434;////STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          v19 = -1073741434;
          v18 = 2;
          v17 = v20;
          WPP_RECORDER_SF_LLd(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            v9,
            3u,
            0x23u,
            (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
            v17,
            v18,
            v19);
        }
        goto LABEL_12;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v16 = v10;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0x22u,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v16);
    }
  }
  else
  {
    v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_12:
      v11 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                   + 174))(
                                    WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoTargetGetState(FxIoTarget
                                    a1);
      TraceLoggingBusDevice(v10, v11, v12, v13);
      return (unsigned int)v10;
    }
    WPP_RECORDER_SF_qLd((__int64)WPP_GLOBAL_Control->DeviceExtension, a2, (__int64)a3, 0x21u, v15);
  }
  if ( v10 < 0 )
    goto LABEL_12;
  return (unsigned int)v10;
}
// 1C0003F08: variable 'v9' is possibly undefined
// 1C0003F3F: variable 'v15' is possibly undefined
// 1C0003F6B: variable 'v12' is possibly undefined
// 1C0003F6B: variable 'v13' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0003F90) ----------------------------------------------------
__int64 __fastcall SpbWriteWrite(struct WDFIOTARGET__ *a1, __int16 a2, unsigned __int8 *a3, unsigned __int16 a4, unsigned __int16 a5, unsigned __int8 *a6, unsigned __int16 a7)
{
  int v8; // esi
  int v9; // edi
  int v10; // ebx
  struct WDFDEVICE__ *v11; // rax
  __int64 v12; // r8
  const GUID *v13; // r9
  int v15; // [rsp+20h] [rbp-C9h]
  int v16; // [rsp+28h] [rbp-C1h]
  unsigned int v17; // [rsp+28h] [rbp-C1h]
  int v18; // [rsp+30h] [rbp-B9h]
  int v19; // [rsp+38h] [rbp-B1h]
  unsigned int v20; // [rsp+50h] [rbp-99h] BYREF
  __int128 v21; // [rsp+58h] [rbp-91h]
  __int128 v22; // [rsp+68h] [rbp-81h]
  __int64 v23[2]; // [rsp+78h] [rbp-71h] BYREF
  __int128 v24; // [rsp+88h] [rbp-61h]
  __int128 v25; // [rsp+98h] [rbp-51h]
  __int16 *v26; // [rsp+B0h] [rbp-39h] BYREF
  int v27; // [rsp+B8h] [rbp-31h]
  unsigned __int8 *v28; // [rsp+C0h] [rbp-29h]
  int v29; // [rsp+C8h] [rbp-21h]
  unsigned __int16 *v30; // [rsp+D0h] [rbp-19h]
  int v31; // [rsp+D8h] [rbp-11h]
  unsigned __int8 *v32; // [rsp+E0h] [rbp-9h]
  int v33; // [rsp+E8h] [rbp-1h]
  __int16 v34; // [rsp+138h] [rbp+4Fh] BYREF

  v34 = a2;
  if ( a3 && a4 && a6 && a7 )
  {
    v8 = a7;
    v26 = &v34;
    v9 = a4;
    v30 = &a5;
    v28 = a3;
    *(_QWORD *)&v22 = &v26;
    v32 = a6;
    *((_QWORD *)&v21 + 1) = 2i64;
    *((_QWORD *)&v22 + 1) = 4i64;
    *(_QWORD *)&v21 = 2i64;
    v27 = 2;
    v25 = v22;
    v29 = a4;
    v31 = 2;
    v33 = a7;
    v23[0] = 48i64;
    v23[1] = 1i64;
    v24 = v21;
    v20 = 0;
    v10 = _SpbSequence(a1, v23, 48i64, &v20, 1u);// status = ::_SpbSequence(FxIoTarget, &sequence, sizeof(sequence), &bytesReturned);//(FxIoTarget, &sequence, sizeof(sequence), &bytesReturned, 1);
    if ( v10 >= 0 )
    {
      if ( v20 != v8 + v9 + 4 )//ULONG expectedLength = REG_SIZE + DataLengthFirst + REG_SIZE + DataLengthSecond;
      {
        v10 = -1073741434;////STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          v19 = -1073741434;
          v18 = v8 + v9 + 4;
          v17 = v20;
          WPP_RECORDER_SF_LLd(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            v20,
            3u,
            0x26u,
            (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
            v17,
            v18,
            v19);
        }
        goto LABEL_14;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v16 = v10;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0x25u,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v16);
    }
  }
  else
  {
    v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_14:
      v11 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                   + 174))(
                                    WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoTargetGetState(FxIoTarget
                                    a1);
      TraceLoggingBusDevice(v10, v11, v12, v13);
      return (unsigned int)v10;
    }
    WPP_RECORDER_SF_qLqLd((__int64)WPP_GLOBAL_Control->DeviceExtension, (__int64)a6, (__int64)a3, 0x24u, v15);
  }
  if ( v10 < 0 )
    goto LABEL_14;
  return (unsigned int)v10;
}
// 1C000416A: variable 'v15' is possibly undefined
// 1C0004196: variable 'v12' is possibly undefined
// 1C0004196: variable 'v13' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00041C8) ----------------------------------------------------
__int64 __fastcall SpbWriteRead(struct WDFIOTARGET__ *a1, __int16 a2, unsigned __int8 *a3, unsigned __int16 a4, unsigned __int16 a5, unsigned __int8 *a6, unsigned __int16 a7)
{
  __int128 v8; // xmm1
  __int128 v9; // xmm0
  int v10; // edi
  int v11; // ebx
  struct WDFDEVICE__ *v12; // rax
  __int64 v13; // r8
  const GUID *v14; // r9
  int v16; // [rsp+20h] [rbp-E0h]
  int v17; // [rsp+28h] [rbp-D8h]
  unsigned int v18; // [rsp+28h] [rbp-D8h]
  int v19; // [rsp+30h] [rbp-D0h]
  int v20; // [rsp+38h] [rbp-C8h]
  unsigned int v21; // [rsp+50h] [rbp-B0h] BYREF
  __int128 v22; // [rsp+58h] [rbp-A8h]
  __int128 v23; // [rsp+68h] [rbp-98h]
  __int64 v24[2]; // [rsp+80h] [rbp-80h] BYREF
  __int128 v25; // [rsp+90h] [rbp-70h]
  __int128 v26; // [rsp+A0h] [rbp-60h]
  __int128 v27; // [rsp+B0h] [rbp-50h]
  __int128 v28; // [rsp+C0h] [rbp-40h]
  __int16 *v29; // [rsp+D0h] [rbp-30h] BYREF
  int v30; // [rsp+D8h] [rbp-28h]
  unsigned __int8 *v31; // [rsp+E0h] [rbp-20h]
  int v32; // [rsp+E8h] [rbp-18h]
  unsigned __int16 *v33; // [rsp+F0h] [rbp-10h]
  int v34; // [rsp+F8h] [rbp-8h]
  __int16 v35; // [rsp+148h] [rbp+48h] BYREF

  v35 = a2;
  if ( a3 && a4 && a6 && a7 )
  {
    *((_QWORD *)&v23 + 1) = 3i64;
    *((_QWORD *)&v22 + 1) = 2i64;
    v29 = &v35;
    v33 = &a5;
    *(_QWORD *)&v23 = &v29;
    v8 = v23;
    *(_QWORD *)&v22 = 2i64;
    v9 = v22;
    v31 = a3;
    *(_QWORD *)&v22 = 1i64;
    *(_QWORD *)&v23 = a6;
    v10 = a4;
    v26 = v8;
    v25 = v9;
    *((_QWORD *)&v23 + 1) = a7;
    *((_QWORD *)&v22 + 1) = 1i64;
    v30 = 2;
    v32 = a4;
    v28 = v23;
    v34 = 2;
    v24[0] = 48i64;
    v24[1] = 2i64;
    v27 = v22;
    v21 = 0;
    v11 = _SpbSequence(a1, v24, 80i64, &v21, 1u);// status = ::_SpbSequence(FxIoTarget, &sequence, sizeof(sequence), &bytesReturned);//(FxIoTarget, &sequence, sizeof(sequence), &bytesReturned, 1);
    if ( v11 >= 0 )
    {
      if ( v21 < v10 + 4 )
      {
        v11 = -1073741434;////STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          v20 = -1073741434;
          v19 = v10 + 4;
          v18 = v21;
          WPP_RECORDER_SF_LLd(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            v21,
            3u,
            0x29u,
            (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
            v18,
            v19,
            v20);
        }
        goto LABEL_14;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v17 = v11;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0x28u,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v17);
    }
  }
  else
  {
    v11 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_14:
      v12 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                   + 174))(
                                    WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoTargetGetState(FxIoTarget
                                    a1);
      TraceLoggingBusDevice(v11, v12, v13, v14);
      return (unsigned int)v11;
    }
    WPP_RECORDER_SF_qLqLd((__int64)WPP_GLOBAL_Control->DeviceExtension, (__int64)a6, (__int64)a3, 0x27u, v16);
  }
  if ( v11 < 0 )
    goto LABEL_14;
  return (unsigned int)v11;
}
// 1C00043BC: variable 'v16' is possibly undefined
// 1C00043E8: variable 'v13' is possibly undefined
// 1C00043E8: variable 'v14' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0004418) ----------------------------------------------------
__int64 __fastcall _SpbSequence(struct WDFIOTARGET__ *a1, void *a2, __int64 a3, unsigned int *a4, unsigned int a5)
{
  int v9; // ebx
  int v10; // eax
  __int64 v11; // rdx
  struct WDFDEVICE__ *v12; // rax
  __int64 v13; // r8
  const GUID *v14; // r9
  __int64 v16; // [rsp+28h] [rbp-79h]
  __int64 v17; // [rsp+30h] [rbp-71h]
  __int64 v18; // [rsp+50h] [rbp-51h] BYREF
  __int64 v19; // [rsp+58h] [rbp-49h] BYREF
  int v20[2]; // [rsp+60h] [rbp-41h] BYREF
  __int64 v21; // [rsp+68h] [rbp-39h]
  __int64 v22; // [rsp+70h] [rbp-31h]
  int v23[14]; // [rsp+78h] [rbp-29h] BYREF
  int v24[2]; // [rsp+B0h] [rbp+Fh] BYREF
  __int64 v25; // [rsp+B8h] [rbp+17h]

  v19 = 0i64;// WDFMEMORY memorySequence = NULL;

    //WDF_OBJECT_ATTRIBUTES attributes;
    //WDF_OBJECT_ATTRIBUTES_INIT(&attributes);
  memset(v23, 0, sizeof(v23));
  v23[0] = 56;
  v23[6] = 1;
  v23[7] = 1;
  
  v9 = (*((__int64 (__fastcall **)(PVOID, int *, void *, __int64, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 193))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryCreatePreallocated(                    
         v23,//&attributes,
         a2,//Sequence,
         a3,//SequenceLength,
         &v19);//&memorySequence);
         
  if ( v9 >= 0 )
  {
  	  //  WDF_MEMORY_DESCRIPTOR memoryDescriptor;
    v20[1] = 0;// //WDF_MEMORY_DESCRIPTOR_INIT_HANDLE(  &memoryDescriptor,   memorySequence, NULL);
    v22 = 0i64;
    v18 = 0i64;
    v21 = v19;
    v20[0] = 3;
    if ( a5 )//(Timeout != 0) 
    {
    	//WDF_REQUEST_SEND_OPTIONS sendOptions;
       // WDF_REQUEST_SEND_OPTIONS_INIT(&sendOptions, WDF_REQUEST_SEND_OPTION_TIMEOUT);  
      v24[0] = 16;
      v25 = -10000000i64 * a5; //sendOptions.Timeout = WDF_REL_TIMEOUT_IN_SEC(Timeout);
      v24[1] = 1;
      v10 = (*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *, _QWORD, __int64, int *, _QWORD, int *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
             + 186))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfIoTargetSendIoctlSynchronously(IoTarget, NULL, IOCTL_SPB_EXECUTE_SEQUENCE, &memoryDescriptor, NULL,  NULL, &bytes);
              a1,
              0i64,
              268296i64,
              v20,
              0i64,
              v24,
              &v18);
    }
    else
    {
      v10 = (*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *, _QWORD, __int64, int *, _QWORD, _QWORD, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
             + 186))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,////status = WdfIoTargetSendIoctlSynchronously(IoTarget, NULL, IOCTL_SPB_EXECUTE_SEQUENCE, &memoryDescriptor, NULL,  NULL, &bytes);
              a1,
              0i64,
              268296i64,
              v20,
              0i64,
              0i64,
              &v18);
    }
    v9 = v10;
    if ( v10 >= 0 )
    {
      *a4 = v18;
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v17) = v10;
      LODWORD(v16) = v18;
      WPP_RECORDER_SF_Ld(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v11,
        3u,
        0x2Bu,
        (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
        v16,
        v17);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      3u,
      0x2Au,
      (__int64)&WPP_9075389c7a5f3b6a15013edc3674f153_Traceguids,
      v9);
  }
  if ( v9 < 0 )
  {
    v12 = (struct WDFDEVICE__ *)(*((__int64 (__fastcall **)(PVOID, struct WDFIOTARGET__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                 + 174))(
                                  WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoTargetGetState(FxIoTarget
                                  a1);
    TraceLoggingBusDevice(v9, v12, v13, v14);
  }
  if ( v19 )
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfObjectDelete(
  return (unsigned int)v9;
}
// 1C00045BE: variable 'v11' is possibly undefined
// 1C00045BE: variable 'v16' is possibly undefined
// 1C00045BE: variable 'v17' is possibly undefined
// 1C00045F2: variable 'v13' is possibly undefined
// 1C00045F2: variable 'v14' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0004640) ----------------------------------------------------
void __fastcall TraceLoggingACPI(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C00097A8, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C00046F4) ----------------------------------------------------
__int64 WPP_RECORDER_SF_D(__int64 a1, __int64 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rbx
  int v9; // eax
  int v11; // [rsp+20h] [rbp-28h]
  va_list va; // [rsp+78h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v9 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v9, (a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= 4u )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v11) = a4;
  return WppAutoLogTrace(a1, 4i64, a3, a5, v11, va);
}
// 1C00047C0: variable 'v11' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C00047E8) ----------------------------------------------------
__int64 WPP_RECORDER_SF_cd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...)
{
  int v8; // [rsp+20h] [rbp-38h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 2) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 2u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
      a4,
      va);
  LOWORD(v8) = a4;
  return WppAutoLogTrace(a1, 2i64, 2i64, &WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids, v8, va);
}
// 1C000489E: variable 'v8' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C00048BC) ----------------------------------------------------
void __fastcall TraceLoggingHID(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C00097D0, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0004970) ----------------------------------------------------
ULONG McTemplateK0phq(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, __int64 a3, ...)
{
  EVENT_DATA_DESCRIPTOR EventData; // [rsp+30h] [rbp-50h] BYREF
  va_list v5; // [rsp+40h] [rbp-40h]
  __int64 v6; // [rsp+48h] [rbp-38h]
  va_list v7; // [rsp+50h] [rbp-30h]
  __int64 v8; // [rsp+58h] [rbp-28h]
  va_list v9; // [rsp+60h] [rbp-20h]
  __int64 v10; // [rsp+68h] [rbp-18h]
  __int64 v11; // [rsp+A8h] [rbp+28h] BYREF
  va_list va; // [rsp+A8h] [rbp+28h]
  __int64 v13; // [rsp+B0h] [rbp+30h] BYREF
  va_list va1; // [rsp+B0h] [rbp+30h]
  va_list va2; // [rsp+B8h] [rbp+38h] BYREF

  va_start(va2, a3);
  va_start(va1, a3);
  va_start(va, a3);
  v11 = va_arg(va1, _QWORD);
  va_copy(va2, va1);
  v13 = va_arg(va2, _QWORD);
  v6 = 8i64;
  va_copy(v5, va);
  v8 = 2i64;
  va_copy(v7, va1);
  v10 = 4i64;
  va_copy(v9, va2);
  return McGenEventWrite(a1, a2, 0i64, 4u, &EventData);
}

//----- (00000001C00049EC) ----------------------------------------------------
__int64 WPP_RECORDER_SF_DD(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-38h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 8) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      64i64,
      va);
  LOWORD(v7) = 64;
  return WppAutoLogTrace(a1, 4i64, 4i64, &WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids, v7, va);
}
// 1C0004A95: variable 'v7' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0004AB8) ----------------------------------------------------
__int64 WPP_RECORDER_SF_DDd(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, ...)
{
  int v8; // [rsp+20h] [rbp-48h]
  va_list va; // [rsp+98h] [rbp+30h] BYREF

  va_start(va, a5);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 8) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 2u )
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      a4,
      va);
  LOWORD(v8) = a4;
  return WppAutoLogTrace(a1, 2i64, 4i64, &WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids, v8, va);
}
// 1C0004B83: variable 'v8' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0004BA8) ----------------------------------------------------
__int64 WPP_RECORDER_SF_Dd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v8; // rdi
  int v10; // eax
  int v12; // [rsp+20h] [rbp-48h]
  va_list va; // [rsp+98h] [rbp+30h] BYREF

  va_start(va, a5);
  v8 = (unsigned __int64)a3 >> 16;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v8 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, ((_BYTE)a3 - 1) & 0x1F) && *((_BYTE *)&WPP_GLOBAL_Control->Timer + 80 * v8 + 1) >= a2 )
    pfnWppTraceMessage(*((_QWORD *)&WPP_GLOBAL_Control->AttachedDevice + 10 * v8), 43i64, a5, a4, va);
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, a2, a3, a5, v12, va);
}
// 1C0004CA3: variable 'v12' is possibly undefined
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0004CD0) ----------------------------------------------------
__int64 __fastcall HidInitialize(struct _DEVICE_CONTEXT *a1, enum _WDF_POWER_DEVICE_STATE a2)
{
  int v4; // ebx
  __int64 v5; // r8
  SIZE_T v6; // rbx
  PVOID v7; // rax
  unsigned __int16 v8; // r9
  _QWORD *v9; // rsi
  __int64 v10; // r8
  int v11; // eax
  unsigned int v12; // er8
  int v13; // eax
  int v14; // eax
  __int64 v15; // r8
  const GUID *v16; // r9
  struct _MCGEN_TRACE_CONTEXT *v17; // rcx
  __int64 v19; // [rsp+20h] [rbp-50h]
  int v20; // [rsp+28h] [rbp-48h]
  _QWORD v21[8]; // [rsp+30h] [rbp-40h] BYREF

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0xAu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  if ( a2 != WdfPowerDeviceD3Final )
  {
LABEL_18:
    v14 = _HidPower((__int64)a1, 0);//NTSTATUS Status_v14 = _HidPower(pDeviceContext, 0);
    v4 = v14;
    if ( v14 >= 0 )
      goto LABEL_26;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0xEu,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v14);
    DeviceReportPnpProblem(*(_QWORD *)a1, 3221291011i64, v15, v16);
    goto LABEL_22;
  }
  v4 = _HidGetHidDescriptor(a1);
  if ( v4 < 0 )
    goto LABEL_22;
  v6 = *((unsigned __int16 *)a1 + 54);//size_v6 =pDeviceContext->HidSettings.InputReportMaxLength;
  v7 = ExAllocatePoolWithTag((POOL_TYPE)512, v6, 0x49646948u);//PVOID pBuffer_v7 = ExAllocatePoolWithTag(NonPagedPoolNx, size_v6, htag);
  *((_QWORD *)a1 + 16) = v7;//pDeviceContext->pHidInputReport =v7 //注意偏移16*8 =128所以是pDeviceContext->pHidInputReport
  if ( !v7 )
  {
    v4 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v8 = 11;
      v20 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
LABEL_13:
      v12 = 4;
LABEL_14:
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        v12,
        v8,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v20);
      goto LABEL_22;
    }
    goto LABEL_22;
  }
  memset(v7, 0, v6);
  v9 = (_QWORD *)((*((__int64 (__fastcall **)(PVOID, _QWORD, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
                    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PREQUEST_CONTEXT pRequestContext = GetRequestContext(FxRequest);
                    *((_QWORD *)a1 + 11),////pDeviceContext->SpbRequest//注意偏移11*8=88所以是SpbRequest
                    off_1C000B0F0)
                + 8);///WDFMEMORY* pInputReportMemory_v9 = &pRequestContext->FxMemory;//注意pInputReportMemory_v9必需为指针，后续WdfMemoryCreatePreallocated调用赋值才对pRequestContext->FxMemory有效

  if ( *v9
    || (memset(v21, 0, 0x38ui64),
        v10 = *((_QWORD *)a1 + 16),//Sequence =pDeviceContext->pHidInputReport //注意偏移16*8 =128所以是pDeviceContext->pHidInputReport
        v21[3] = 0x100000001i64,//WDF_OBJECT_ATTRIBUTES attributes;    WDF_OBJECT_ATTRIBUTES_INIT(&attributes);
        v21[4] = *((_QWORD *)a1 + 11),////pDeviceContext->SpbRequest//注意偏移11*8=88所以是SpbRequest
        LODWORD(v21[0]) = 56,
        v11 = (*((__int64 (__fastcall **)(PVOID, _QWORD *, __int64, SIZE_T, _QWORD *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
               + 193))(
                WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryCreatePreallocated( &attributes, Sequence, SequenceLength, pInputReportMemory_v9);
                v21,
                v10,
                v6,
                v9),
        v4 = v11,
        v11 >= 0) )
  {
  	 
	
//pDevContext->InputReportListHead.Blink = &pDevContext->InputReportListHead;
    //pDevContext->InputReportListHead.Flink = &pDevContext->InputReportListHead;
    *((_QWORD *)a1 + 18) = (char *)a1 + 136;//		*((_QWORD*)a1 + 18) = (char*)a1 + 136;//注意偏移位宽倍数18*4=72,136/2=68
    *((_QWORD *)a1 + 17) = (char *)a1 + 136;//     *((_QWORD*)a1 + 17) = (char*)a1 + 136;//注意偏移位宽倍数17*4=68,136/2=68
    
    memset(v21, 0, 0x38ui64);////WDF_OBJECT_ATTRIBUTES attributes;    WDF_OBJECT_ATTRIBUTES_INIT(&attributes);
    v21[4] = *(_QWORD *)a1;//lockAttributes.ParentObject = FxDeviceContext->FxDevice;
    LODWORD(v21[0]) = 56;
    v21[3] = 0x100000001i64;
    v13 = (*((__int64 (__fastcall **)(PVOID, _QWORD *, char *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 315))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfSpinLockCreate( &lockAttributes, &FxDeviceContext->InputReportListLock);
            v21,
            (char *)a1 + 152);//FxDeviceContext->InputReportListLock
    v4 = v13;
    if ( v13 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_22;
      v8 = 13;
      v20 = v13;
      v12 = 1;
      goto LABEL_14;
    }
    goto LABEL_18;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v8 = 12;
    v20 = v11;
    goto LABEL_13;
  }
LABEL_22:
  v17 = (struct _MCGEN_TRACE_CONTEXT *)*((_QWORD *)a1 + 16);//pDeviceContext->pHidInputReport //注意偏移16*8 =128所以是pDeviceContext->pHidInputReport
  if ( v17 )
  {
    ExFreePoolWithTag(v17, 0x49646948u);//htag
    *((_QWORD *)a1 + 16) = 0i64;//pDeviceContext->pHidInputReport //注意偏移16*8 =128所以是pDeviceContext->pHidInputReport
  }
  if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 2) != 0 )
  {
    LODWORD(v19) = v4;
    McTemplateK0pq(v17, &EVENT_HIDI2C_ENUMERATION_HID_FAILURE, v5, *(_QWORD *)a1, v19);
  }
LABEL_26:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0xFu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  return (unsigned int)v4;
}
// 1C0004F2C: variable 'v15' is possibly undefined
// 1C0004F2C: variable 'v16' is possibly undefined
// 1C0004F6C: variable 'v17' is possibly undefined
// 1C0004F6C: variable 'v5' is possibly undefined
// 1C0004F6C: variable 'v19' is possibly undefined
// 1C000B0F0: using guessed type void *off_1C000B0F0;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0004FC8) ----------------------------------------------------
__int64 __fastcall HidDestroy(struct _DEVICE_CONTEXT *a1, enum _WDF_POWER_DEVICE_STATE a2)
	//NTStatus  HidDestroy(pDeviceContext, _WDF_POWER_DEVICE_STATE TargetState);
{
  int v4; // eax
  __int64 v5; // r8
  const GUID *v6; // r9
  unsigned int v7; // ebx
  void *v8; // rcx
  int v10; // [rsp+28h] [rbp-20h]

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x10u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  v4 = _HidPower((__int64)a1, 1);//NTSTATUS status = _HidPower(pDeviceContext, 1);
  v7 = v4;
  if ( v4 >= 0 )
  {
    if ( a2 != WdfPowerDeviceD3Final )
      goto LABEL_10;
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v10 = v4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x11u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v10);
  }
  TraceLoggingHID(v7, *(struct WDFDEVICE__ **)a1, v5, v6);
  v8 = (void *)*((_QWORD *)a1 + 16);// = pDeviceContext->pHidInputReport //注意偏移16*8 =128所以是pDeviceContext->pHidInputReport
  if ( v8 )
  {
    ExFreePoolWithTag(v8, 0x49646948u);//htag
    *((_QWORD *)a1 + 16) = 0i64;//pDeviceContext->pHidInputReport= NULL ;
  }
LABEL_10:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x12u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  return v7;
}
// 1C000506F: variable 'v5' is possibly undefined
// 1C000506F: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00050EC) ----------------------------------------------------
__int64 __fastcall HidGetDeviceDescriptor(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2)
{
  int v4; // ebx
  __int64 v5; // r8
  const GUID *v6; // r9
  __int16 v7; // cx
  int v9; // [rsp+28h] [rbp-10h]
  __int64 v10; // [rsp+50h] [rbp+18h] BYREF

  v10 = 0i64;//pHID_DESCRIPTOR =NULL;
  v4 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64, __int64 *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 270))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//Status = WdfRequestRetrieveOutputBuffer(
         a2,  //Request
         9i64,//sizeof(HID_DESCRIPTOR),//
         &v10,//pHID_DESCRIPTOR,
         0i64);NULL
  if ( v4 >= 0 )
  {
    v7 = *((_WORD *)a1 + 51);//ReportLength_v7 =pDeviceContext_a1->ReportDescriptorLength;
    *(_BYTE *)v10 = 9;//pHID_DESCRIPTOR->size=sizeof(HID_DESCRIPTOR);//0x9  //pDeviceContext->HidSettings.HidDescriptorLength;
    *(_BYTE *)(v10 + 1) = 33;//pHID_DESCRIPTOR->bDescriptorType =0x21;//HID type
    *(_WORD *)(v10 + 2) = 1;//pHidDescriptor->bcdHID = HID_DESCRIPTOR_BCD_VERSION;// 0x0100;
    *(_BYTE *)(v10 + 4) = 0;//pHidDescriptor->bCountry = 0x00;//country code == Not Specified
    *(_BYTE *)(v10 + 5) = 1;//pHidDescriptor->bNumDescriptors = 0x01;
    *(_BYTE *)(v10 + 6) = 34;//pHidDescriptor->DescriptorList->bReportType = 0x22;
    *(_WORD *)(v10 + 7) = v7;//pHidDescriptor->DescriptorList->wReportLength = ReportLength_v7;
    (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, sizeof(HID_DESCRIPTOR));
      a2,
      9i64);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        4u,
        0x14u,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v9 = v4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x13u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v9);
  }
  if ( v4 < 0 )
    TraceLoggingHID(v4, *(struct WDFDEVICE__ **)a1, v5, v6);
  return (unsigned int)v4;
}
// 1C0005226: variable 'v5' is possibly undefined
// 1C0005226: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005244) ----------------------------------------------------
__int64 __fastcall HidGetReportDescriptor(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2)
{
  int v4; // ebx
  __int64 v5; // r8
  const GUID *v6; // r9
  unsigned __int16 v7; // r9
  unsigned __int16 v8; // bp
  __int64 v9; // r14
  unsigned __int8 *v10; // rax
  unsigned __int8 *v11; // rsi
  __int64 v12; // rdx
  unsigned int v14; // [rsp+20h] [rbp-28h]
  __int64 v15; // [rsp+28h] [rbp-20h]
  __int64 v16; // [rsp+60h] [rbp+18h] BYREF

  v4 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 268))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfRequestRetrieveOutputMemory(request, &memory);
         a2,
         &v16);//status_v4=WdfRequestRetrieveOutputMemory(request_a2,memory_v16
  if ( v4 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_14;
    v7 = 21;
    goto LABEL_4;
  }
  v8 = *((_WORD *)a1 + 52);//USHORT RegisterAddress = pDeviceContext->HidSettings.ReportDescriptorAddress;
  v9 = *((unsigned __int16 *)a1 + 51);//ReportLength__v9= pDeviceContext_a1->ReportDescriptorLength;
  v10 = (unsigned __int8 *)(*((__int64 (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 194))(
                             WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                             v16,
                             0i64);//PBYTE pReportDesciptorData = (PBYTE)WdfMemoryGetBuffer(memory_v16, NULL);
  v11 = v10;
  if ( !v10 )
  {
    v4 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0x16u,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        -1073741670);//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    goto LABEL_15;
  }
  v4 = SpbRead(*((struct WDFIOTARGET__ **)a1 + 9), v8, v10, v9, v14, 1u);//status = SpbRead(pDeviceContext->SpbIoTarget, RegisterAddress, (PBYTE)pReportDesciptorData, ReportLength, DelayUs, 1);//注意偏移9*8=72所以是SpbIoTarget
  if ( v4 < 0 )
  {
LABEL_15:
    TraceLoggingHID(v4, *(struct WDFDEVICE__ **)a1, v5, v6);
    return (unsigned int)v4;
  }
  v4 = (*((__int64 (__fastcall **)(PVOID, __int64, _QWORD, unsigned __int8 *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 197))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryCopyFromBuffer(
         v16,//memory_v16
         0i64,
         v11,//pReportDesciptorData
         v9);//ReportLength__v9
  if ( v4 >= 0 )
  {
    (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, ReportLength__v9);
      a2,
      v9);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v15) = v8;
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v12,
        4u,
        0x18u,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v15);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v7 = 23;
LABEL_4:
    LODWORD(v15) = v4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      v7,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v15);
    goto LABEL_14;
  }
LABEL_14:
  if ( v4 < 0 )
    goto LABEL_15;
  return (unsigned int)v4;
}
// 1C00052C4: variable 'v15' is possibly undefined
// 1C000535F: variable 'v14' is possibly undefined
// 1C0005413: variable 'v12' is possibly undefined
// 1C0005421: variable 'v5' is possibly undefined
// 1C0005421: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005448) ----------------------------------------------------
__int64 __fastcall HidGetDeviceAttributes(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2)
{
  int v4; // ebx
  __int64 v5; // r8
  const GUID *v6; // r9
  int v8; // [rsp+28h] [rbp-10h]
  __int64 v9; // [rsp+50h] [rbp+18h] BYREF

  v9 = 0i64;//PHID_DEVICE_ATTRIBUTES pDeviceAttributes = NULL;
  v4 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64, __int64 *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 270))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//Status = WdfRequestRetrieveOutputBuffer(
         a2,//Request
         32i64,//sizeof(HID_DEVICE_ATTRIBUTES),
         &v9,//&pDeviceAttributes,
         0i64);//NULL
  if ( v4 >= 0 )
  {
    *(_DWORD *)v9 = 32;//pDeviceAttributes->Size = sizeof(HID_DEVICE_ATTRIBUTES);
    *(_WORD *)(v9 + 4) = *((_WORD *)a1 + 59);//pDeviceAttributes->VendorID = pDeviceContext->HidVendorID;
    *(_WORD *)(v9 + 6) = *((_WORD *)a1 + 60);//pDeviceAttributes->ProductID = pDeviceContext->HidProductID;
    *(_WORD *)(v9 + 8) = *((_WORD *)a1 + 61);//pDeviceAttributes->VersionNumber = pDeviceContext->HidVersionNumber;
    (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, sizeof(HID_DEVICE_ATTRIBUTES));
      a2,
      32i64);//sizeof(HID_DEVICE_ATTRIBUTES)
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v8 = v4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x19u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v8);
  }
  if ( v4 < 0 )
    TraceLoggingHID(v4, *(struct WDFDEVICE__ **)a1, v5, v6);
  return (unsigned int)v4;
}
// 1C0005534: variable 'v5' is possibly undefined
// 1C0005534: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005554) ----------------------------------------------------
__int64 __fastcall HidGetString(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2)
{
  unsigned int v3; // ebx
  __int64 v4; // rsi
  const GUID *v5; // r9
  __int64 v6; // r8
  int v7; // eax
  const wchar_t *v8; // rdx
  __int64 v9; // rdi
  size_t v10; // rdi
  int v12; // [rsp+28h] [rbp-20h]
  int v13; // [rsp+28h] [rbp-20h]
  int v14; // [rsp+30h] [rbp-18h]

  v3 = 0;//NTSTATUS_v3
  v4 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PIRP_v4 = WdfRequestWdmGetIrp(Request)
         a2);
  v6 = *(_QWORD *)(v4 + 184);//PIO_STACK_LOCATION IoStack= IoGetCurrentIrpStackLocation(pIrp);//即是PIO_STACK_LOCATION IoStack = Irp->Tail.Overlay.CurrentStackLocation;
  v7 = *(_DWORD *)(v6 + 32);//LONG StrIDs =* (PULONG)IoStack->Parameters.DeviceIoControl.Type3InputBuffer;
  switch ( (unsigned __int16)v7 )// *(PUSHORT)StrIDs[0];//即USHORT wStrID= *(PUSHORT)IoStack->Parameters.DeviceIoControl.Type3InputBuffer;
  {
    case 0xEu:
      v8 = L"Microsoft";
      break;
    case 0xFu:
      v8 = L"HIDI2C Device";
      break;
    case 0x10u:
      v8 = L"9999";
      break;
    default:
      v3 = -1073741811;//STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v12 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          4u,
          0x1Au,
          (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
          v12);
      }
      goto LABEL_14;
  }
  v9 = -1i64;/int i=-1;
  do
    ++v9;//++i
  while ( v8[v9] );
  v10 = 2 * v9 + 2;//size_t_v10
  if ( *(unsigned int *)(v6 + 8) >= v10 )//IoStack->Parameters.DeviceIoControl.OutputBufferLength>=size_t_v10
  {
    memmove(*(void **)(v4 + 112), v8, v10);//PIRP_v4->UserBuffer
    *(_QWORD *)(v4 + 56) = v10;//pIrp->IoStatus.Information = size_t_v10;//??
    return v3;
  }
  v3 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v14 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
    v13 = v10;
    WPP_RECORDER_SF_Ld(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      (__int64)v8,
      4u,
      0x1Bu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v13,
      v14);
  }
LABEL_14:
  TraceLoggingHID(v3, *(struct WDFDEVICE__ **)a1, v6, v5);
  return v3;
}
// 1C000566F: variable 'v6' is possibly undefined
// 1C000566F: variable 'v5' is possibly undefined
// 1C00095B8: using guessed type wchar_t aMicrosoft[10];
// 1C00095D0: using guessed type wchar_t aHidi2cDevice[14];
// 1C00095F0: using guessed type wchar_t a9999[5];
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00056A4) ----------------------------------------------------
__int64 __fastcall HidReadReport(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2, unsigned __int8 *a3)
{
  PDRIVER_CONTROL v3; // rax
  int v6; // ebx
  __int64 v7; // r8
  const GUID *v8; // r9
  char v9; // al
  int v11; // [rsp+28h] [rbp-10h]

  v3 = WPP_MAIN_CB.Queue.Wcb.DeviceRoutine;
  *a3 = 0;//BOOLEAN requestPendingFlag =FALSE
  v6 = (*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *, _QWORD))v3 + 281))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a2,
         *((_QWORD *)a1 + 5));//status = WdfRequestForwardToIoQueue(Request, pDeviceContext->ReportQueue);
  if ( v6 >= 0 )
  {
    v9 = *((_BYTE *)a1 + 24);//char state = pDeviceContext->ProcessInterrupts;
    *a3 = 1;//requestPendingFlag =TRUE;
    if ( !v9 )
    {
      *((_BYTE *)a1 + 24) = 1;//pDeviceContext->ProcessInterrupts = TRUE;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          4u,
          0x1Du,
          (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v11 = v6;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x1Cu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v11);
  }
  if ( v6 < 0 )
    TraceLoggingHID(v6, *(struct WDFDEVICE__ **)a1, v7, v8);
  return (unsigned int)v6;
}
// 1C0005770: variable 'v7' is possibly undefined
// 1C0005770: variable 'v8' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005790) ----------------------------------------------------
__int64 __fastcall HidWriteReport(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2)//pDeviceContext_a1,request_a2
{
  unsigned __int8 *v4; // r14
  __int64 v5; // r8
  const GUID *v6; // r9
  int v7; // ebx
  unsigned __int16 v8; // r9
  __int64 v9; // rdx
  __int64 v10; // rbx
  size_t v11; // rsi
  unsigned __int16 v12; // ax
  unsigned __int16 v13; // di
  unsigned __int16 v14; // r12
  unsigned __int8 *v15; // rax
  int v16; // eax
  int v18; // [rsp+28h] [rbp-80h]
  __int64 v19[5]; // [rsp+40h] [rbp-68h] BYREF

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x1Eu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  v4 = 0i64;
  memset(v19, 0, sizeof(v19));
  LOWORD(v19[0]) = 40;
  (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 266))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestGetParameters(Request, &RequestParameters);
    a2,
    v19);
  if ( v19[2] >= 0x10ui64 )//if (RequestParameters.Parameters.DeviceIoControl.InputBufferLength >= sizeof(HID_XFER_PACKET))
  {
    v10 = *(_QWORD *)((*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
                        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//pHidPacket = (PHID_XFER_PACKET) WdfRequestWdmGetIrp(Request)->UserBuffer;
                        a2)//Request
                    + 112);//->UserBuffer;
    if ( v10 )
    {
      v11 = *(unsigned int *)(v10 + 8);//reportBufferLen = pHidPacket->reportBufferLen;
      if ( (_DWORD)v11 )
      {
        v12 = *((_WORD *)a1 + 56);//OutputReportMaxLength = pDeviceContext->HidSettings.OutputReportMaxLength;
        v13 = v11 + 2;//OutputReportLength = reportBufferLen + 2;
        v14 = *((_WORD *)a1 + 55);//RegisterAddress = pDeviceContext->HidSettings.OutputRegisterAddress;
        if ( (unsigned __int16)(v11 + 2) > v12 )//if (OutputReportLength > OutputReportMaxLength)
        {
          v7 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            WPP_RECORDER_SF_LLd(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              3221225485i64,
              4u,
              0x22u,
              (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
              v13,
              v12,
              -1073741811);////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
          goto LABEL_26;
        }
        v15 = (unsigned __int8 *)ExAllocatePoolWithTag((POOL_TYPE)512, (unsigned __int16)(v11 + 2), 0x49646948u);//htag
        //PBYTE pReportDesciptorData = (PBYTE)ExAllocatePoolWithTag(NonPagedPoolNx, OutputReportLength, HIDI2C_POOL_TAG);
        v4 = v15;//PBYTE pReportData=pReportDesciptorData
        if ( !v15 )
        {
          v7 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            WPP_RECORDER_SF_d(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              2u,
              4u,
              0x23u,
              (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
              -1073741670);//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
          goto LABEL_26;
        }
        memset(v15, 0, v13);//RtlZeroMemory(pReportDesciptorData, OutputReportLength);
        *(_WORD *)v4 = v11 + 2;//*(PUSHORT)pReportData=reportBufferLen +2;
        memmove(v4 + 2, *(const void **)v10, v11);//RtlMoveMemory(pReportData + 2, *(const void**)pHidPacket, reportBufferLen);
        v16 = SpbWrite(*((struct WDFIOTARGET__ **)a1 + 9), v14, v4, (unsigned __int16)(v11 + 2), 1u);//status = SpbWrite(pDeviceContext->SpbIoTarget, RegisterAddress, pReportData, OutputReportLength, 1);////注意偏移9*8=72所以是SpbIoTarget
        v7 = v16;
        if ( v16 >= 0 )
        {
          (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, size_t))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, reportBufferLen);
            a2,
            v11);
        }
        else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          WPP_RECORDER_SF_Dd(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            2u,
            4u,
            0x24u,
            (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
            v14,
            v16);
        }
      }
      else
      {
        v7 = -1073741789;//STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023L)
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_26;
        WPP_RECORDER_SF_Ld(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          v9,
          4u,
          0x21u,
          (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
          0,
          -1073741789);
      }
      if ( v7 >= 0 )
        goto LABEL_27;
      goto LABEL_26;
    }
    v7 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v8 = 32;
      v18 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
      goto LABEL_7;
    }
  }
  else
  {
    v7 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v8 = 31;
      v18 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
LABEL_7:
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        v8,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v18);
      goto LABEL_26;
    }
  }
LABEL_26:
  TraceLoggingHID(v7, *(struct WDFDEVICE__ **)a1, v5, v6);
LABEL_27:
  if ( v4 )
    ExFreePoolWithTag(v4, 0x49646948u);//pReportData,HIDI2C_POOL_TAG
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x25u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  return (unsigned int)v7;
}
// 1C0005A7F: variable 'v9' is possibly undefined
// 1C0005AA1: variable 'v5' is possibly undefined
// 1C0005AA1: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005B1C) ----------------------------------------------------
__int64 __fastcall HidGetReport(__int64 a1, __int64 a2, int a3)
	//PDEVICE_CONTEXT pDeviceContext,	WDFREQUEST Request,	HID_REPORT_TYPE ReportType
{
  unsigned __int8 *v6; // r14
  unsigned __int8 *v7; // rsi
  __int64 v8; // r8
  __int64 v9; // r9
  int v10; // edi
  unsigned __int16 v11; // r9
  __int64 v12; // r15
  unsigned int v13; // ebp
  int v14; // edi
  int v15; // ecx
  __int16 v16; // cx
  unsigned __int8 v17; // di
  __int16 v18; // r13
  unsigned __int8 *v19; // rax
  unsigned __int16 v20; // r12
  unsigned __int8 *v21; // rax
  unsigned __int16 v22; // r9
  unsigned __int16 v23; // r13
  unsigned __int16 v24; // cx
  unsigned int v25; // ebx
  int v27; // [rsp+20h] [rbp-A8h]
  unsigned __int8 *v28; // [rsp+28h] [rbp-A0h]
  char v29; // [rsp+40h] [rbp-88h]
  __int16 P; // [rsp+44h] [rbp-84h] BYREF
  __int16 v31; // [rsp+48h] [rbp-80h]
  __int64 v32; // [rsp+50h] [rbp-78h]
  __int64 v33; // [rsp+58h] [rbp-70h]
  __int64 v34[5]; // [rsp+60h] [rbp-68h] BYREF

  v33 = a2;
  v32 = a1;
  v6 = 0i64;
  v7 = 0i64;
  v29 = 0;//BOOLEAN bAllocatePoolFlag = FALSE;
  memset(v34, 0, sizeof(v34));
  LOWORD(v34[0]) = 40;
  (*((void (__fastcall **)(PVOID, __int64, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 266))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestGetParameters(Request, &RequestParameters);
    a2,
    v34);
  if ( v34[1] >= 0x10ui64 )//if (RequestParameters.Parameters.DeviceIoControl.OutputBufferLength >=sizeof(HID_XFER_PACKET))
  {
    v12 = *(_QWORD *)((*((__int64 (__fastcall **)(PVOID, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
                        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//pHidPacket = (PHID_XFER_PACKET) WdfRequestWdmGetIrp(Request)->UserBuffer;
                        a2)//Request
                    + 112);
    if ( !v12 )
    {
      v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_38;
      v11 = 39;
      LODWORD(v28) = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
      goto LABEL_4;
    }
    v13 = *(_DWORD *)(v12 + 8);//size_t reportBufferLen = pHidPacket->reportBufferLen;
    if ( v13 )//if (reportBufferLen)
    {
      v9 = 512i64;
      v31 = *(_WORD *)(a1 + 114);//RegisterAddressFirst = pDeviceContext->HidSettings.CommandRegisterAddress;////注意偏移量114/2=所以是CommandRegisterAddress
      P = 512;//PFLAG = 0x200
      v14 = a3 - 1;//ReportType-1
      if ( v14 )
      {
        if ( v14 != 2 )
        {
          v15 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
          v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
          if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
            goto LABEL_38;
          v11 = 41;
          goto LABEL_13;
        }
        v16 = 560;
      }
      else
      {
        v16 = 528;
      }
      v17 = *(_BYTE *)(v12 + 12);//UCHAR reportId = pHidPacket->reportId;
      if ( v17 >= 0xFu )
      {
        v18 = 3;//HeaderLength =3;
        P = v16 | 0xF;
        v19 = (unsigned __int8 *)ExAllocatePoolWithTag((POOL_TYPE)512, 3ui64, 0x49646948u);//PBYTE pReportDesciptorHeader = (PBYTE)ExAllocatePoolWithTag(NonPagedPoolNx, 3, HIDI2C_POOL_TAG);
        v7 = v19;//pReportData = pReportDesciptorHeader;
        if ( !v19 )
        {
          v15 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
          v10 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
          if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
            goto LABEL_38;
          v11 = 42;
          goto LABEL_13;
        }
        v29 = 1;//bAllocatePoolFlag = TRUE;
        *(_WORD *)v19 = 0;
        v19[2] = 0;
        *(_WORD *)v19 = P;
        v19[2] = v17;
      }
      else
      {
        v7 = (unsigned __int8 *)&P;
        v18 = 2;//HeaderLength =2;
        P = v16 | v17;
      }
      v20 = *(_WORD *)(a1 + 116);//RegisterAddressSecond = pDeviceContext->HidSettings.DataRegisterAddress;//注意偏移116/2=58所以是DataRegisterAddress
      v21 = (unsigned __int8 *)ExAllocatePoolWithTag((POOL_TYPE)512, (unsigned __int16)(v13 + 2), 0x49646948u);//pReportDesciptorData = (PBYTE)ExAllocatePoolWithTag(NonPagedPoolNx, reportBufferLen + 2, HIDI2C_POOL_TAG);
      v6 = v21;
      if ( !v21 )
      {
        v15 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
        v10 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_38;
        v11 = 43;
        goto LABEL_13;
      }
      memset(v21, 0, (unsigned __int16)(v13 + 2));
      v22 = v18;
      v23 = v31;
      v10 = SpbWriteRead(*(struct WDFIOTARGET__ **)(v32 + 72), v31, v7, v22, v20, v6, (unsigned __int16)v13 + 2);//pDeviceContext->SpbIoTarget
      //status = SpbWriteRead(pDeviceContext->SpbIoTarget, RegisterAddressFirst, pReportData, HeaderLength, RegisterAddressSecond, pReportDesciptorData, reportBufferLen + 2);
      if ( v10 >= 0 )
      {
        v24 = *(_WORD *)v6 - 2;//size_t ReportSize = *(PUSHORT)pReportDesciptorData - 2;
        if ( *(_WORD *)v6 == 2 )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            WPP_RECORDER_SF_(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              4u,
              4u,
              0x2Du,
              (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
        }
        else
        {
          if ( v13 < v24 )//if (reportBufferLen < ReportSize) {
          {
            v15 = -1073741789;//STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023L)
            v10 = -1073741789;
            if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
              goto LABEL_38;
            v11 = 46;
LABEL_13:
            LODWORD(v28) = v15;
            goto LABEL_4;
          }
          v25 = v24;
          memmove(*(void **)v12, v6 + 2, v24);//memmove(pHidPacket, pOutReportDesciptorData + 2, ReportSize);
          (*((void (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(Request, ReportSize);
            v33,
            v25);
        }
      }
      else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        WPP_RECORDER_SF_DDd((__int64)WPP_GLOBAL_Control->DeviceExtension, v23, v8, 0x2Cu, v27);
      }
    }
    else
    {
      v10 = -1073741789;//STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023L)
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_38;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0x28u,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        -1073741789);
    }
    if ( v10 >= 0 )
      goto LABEL_39;
    goto LABEL_38;
  }
  v10 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v11 = 38;
    LODWORD(v28) = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
LABEL_4:
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      v11,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v28);
  }
LABEL_38:
  TraceLoggingHID(v10, *(struct WDFDEVICE__ **)v32, v8, (const GUID *)v9);
LABEL_39:
  if ( v6 )
    ExFreePoolWithTag(v6, 0x49646948u);//htag
  if ( v7 && v29 == 1 )//&& bAllocatePoolFlag == TRUE;
    ExFreePoolWithTag(v7, 0x49646948u);//htag
  return (unsigned int)v10;
}
// 1C0005BE9: variable 'v28' is possibly undefined
// 1C0005E03: variable 'v8' is possibly undefined
// 1C0005E03: variable 'v27' is possibly undefined
// 1C0005F0D: variable 'v9' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005F80) ----------------------------------------------------
__int64 __fastcall HidSetReport(__int64 a1, __int64 a2, int a3)
{
  unsigned __int8 *v3; // rsi
  unsigned __int8 *v7; // r15
  __int64 v8; // r8
  const GUID *v9; // r9
  int v10; // ebx
  unsigned __int16 v11; // r9
  struct WDFDEVICE__ **v12; // r14
  __int64 v14; // rdx
  __int64 v15; // r14
  size_t v16; // rbp
  int v17; // ebx
  int v18; // ecx
  __int16 v19; // cx
  unsigned __int8 v20; // bl
  unsigned __int16 v21; // r12
  unsigned __int8 *v22; // rax
  unsigned __int16 v23; // r13
  unsigned __int8 *v24; // rax
  int v25; // [rsp+20h] [rbp-A8h]
  int v26; // [rsp+28h] [rbp-A0h]
  char v27; // [rsp+40h] [rbp-88h]
  unsigned __int8 v28[2]; // [rsp+44h] [rbp-84h] BYREF//UCHAR PFlag[2];
  __int64 v29; // [rsp+48h] [rbp-80h]
  __int16 v30; // [rsp+50h] [rbp-78h]
  __int64 v31; // [rsp+58h] [rbp-70h]
  __int64 v32[5]; // [rsp+60h] [rbp-68h] BYREF

  v3 = 0i64;
  v31 = a2;
  v29 = a1;
  v27 = 0;
  v7 = 0i64;
  memset(v32, 0, sizeof(v32));
  LOWORD(v32[0]) = 40;
  (*((void (__fastcall **)(PVOID, __int64, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 266))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestGetParameters(Request, &RequestParameters);
    a2,
    v32);
  if ( v32[2] < 0x10ui64 )//if (RequestParameters.Parameters.DeviceIoControl.InputBufferLength < sizeof(HID_XFER_PACKET))
  {
    v10 = -1073741306;//STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_5:
      v12 = (struct WDFDEVICE__ **)a1;
LABEL_6:
      TraceLoggingHID(v10, *v12, v8, v9);
      goto LABEL_7;
    }
    v11 = 47;
    v26 = -1073741306;////STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206L)
LABEL_4:
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      v11,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v26);
    goto LABEL_5;
  }
  v15 = *(_QWORD *)((*((__int64 (__fastcall **)(PVOID, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
                      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//pHidPacket = (PHID_XFER_PACKET) WdfRequestWdmGetIrp(Request)->UserBuffer;
                      a2)
                  + 112);//->UserBuffer
  if ( !v15 )
  {
    v10 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_5;
    v11 = 48;
    v26 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    goto LABEL_4;
  }
  v16 = *(unsigned int *)(v15 + 8);//reportBufferLen = pHidPacket->reportBufferLen;
  if ( (_DWORD)v16 )
  {
    v30 = *(_WORD *)(a1 + 114);//RegisterAddressFirst = pDeviceContext->HidSettings.CommandRegisterAddress;/////注意偏移量114/2=所以是CommandRegisterAddress
    *(_WORD *)v28 = 768;//*(PUSHORT)PFlag= 0x300;
    v17 = a3 - 2;
    if ( v17 )
    {
      if ( v17 != 1 )
      {
        v18 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
        v10 = -1073741811;
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_5;
        v11 = 50;
        goto LABEL_21;
      }
      v19 = 816;//SHORT mflag = 0x330;
    }
    else
    {
      v19 = 800;//SHORT mflag = 0x320;
    }
    v20 = *(_BYTE *)(v15 + 12);//UCHAR reportId = pHidPacket->reportId;
    if ( v20 >= 0xFu )
    {
      v21 = 3;//HeaderLength =3;
      *(_WORD *)v28 = v19 | 0xF; //*(PUSHORT)PFlag= mflag | 0xF;
      v22 = (unsigned __int8 *)ExAllocatePoolWithTag((POOL_TYPE)512, 3ui64, 0x49646948u);//PBYTE pReportDesciptorData = (PBYTE)ExAllocatePoolWithTag(NonPagedPoolNx, 3, HIDI2C_POOL_TAG);
      v3 = v22;//pReportData = pReportDesciptorData;
      if ( !v22 )
      {
        v18 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
        v10 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_5;
        v11 = 51;
LABEL_21:
        v26 = v18;
        goto LABEL_4;
      }
      v27 = 1;//bAllocatePoolFlag = TRUE;
      *(_WORD *)v22 = 0;
      v22[2] = 0;
      *(_WORD *)v22 = *(_WORD *)v28;
      v22[2] = v20;
    }
    else
    {
      v3 = v28;//pReportData = PFlag;
      v21 = 2;//HeaderLength = 2;
      *(_WORD *)v28 = v19 | v20;//*(PUSHORT)PFlag = mflag | reportId;
    }
    v23 = *(_WORD *)(a1 + 116);//RegisterAddressSecond = pDeviceContext->HidSettings.DataRegisterAddress;////注意偏移116/2=58所以是DataRegisterAddress
    v24 = (unsigned __int8 *)ExAllocatePoolWithTag((POOL_TYPE)512, (unsigned __int16)(v16 + 2), 0x49646948u);//pReportDesciptorData = (PBYTE)ExAllocatePoolWithTag(NonPagedPoolNx, reportBufferLen + 2, HIDI2C_POOL_TAG);
    v7 = v24;
    if ( !v24 )
    {
      v10 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          4u,
          0x34u,
          (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
          -1073741670);//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
      v12 = (struct WDFDEVICE__ **)v29;
      goto LABEL_6;
    }
    memset(v24, 0, (unsigned __int16)(v16 + 2));
    *(_WORD *)v7 = v16 + 2;
    memmove(v7 + 2, *(const void **)v15, v16);
    v12 = (struct WDFDEVICE__ **)v29;//=pDeviceContext_a1
    v10 = SpbWriteWrite(*(struct WDFIOTARGET__ **)(v29 + 72), v30, v3, v21, v23, v7, (unsigned __int16)v16 + 2);//pDeviceContext->SpbIoTarget
    //status = SpbWriteWrite(pDeviceContext->SpbIoTarget, RegisterAddressFirst, pReportData, HeaderLength, RegisterAddressSecond, pReportDesciptorData, reportBufferLen + 2);
    if ( v10 >= 0 )
    {
      (*((void (__fastcall **)(PVOID, __int64, size_t))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, reportBufferLen);
        v31,
        v16);
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      WPP_RECORDER_SF_DDd((__int64)WPP_GLOBAL_Control->DeviceExtension, v23, v8, 0x35u, v25);
    }
  }
  else
  {
    v10 = -1073741789;//STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023L)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_5;
    WPP_RECORDER_SF_Ld(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      v14,
      4u,
      0x31u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      0,
      -1073741789);
    v12 = (struct WDFDEVICE__ **)a1;
  }
  if ( v10 < 0 )
    goto LABEL_6;
LABEL_7:
  if ( v7 )
    ExFreePoolWithTag(v7, 0x49646948u);//htag
  if ( v3 && v27 == 1 )
    ExFreePoolWithTag(v3, 0x49646948u);//htag
  return (unsigned int)v10;
}
// 1C0006058: variable 'v8' is possibly undefined
// 1C0006058: variable 'v9' is possibly undefined
// 1C000630A: variable 'v25' is possibly undefined
// 1C0006378: variable 'v14' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0006394) ----------------------------------------------------
__int64 __fastcall HidSendIdleNotification(struct _DEVICE_CONTEXT *a1, struct WDFREQUEST__ *a2, unsigned __int8 *a3)
	//PDEVICE_CONTEXT pDeviceContext,	WDFREQUEST FxRequest,	BOOLEAN *bRequestPending_a3)
{
  _QWORD *v6; // rax
  __int64 v7; // r8
  const GUID *v8; // r9
  int v9; // eax
  int v10; // ebx
  _QWORD *v11; // rax
  int v13; // [rsp+28h] [rbp-31h]
  int v14; // [rsp+30h] [rbp-29h]
  __int64 v15[3]; // [rsp+40h] [rbp-19h] BYREF
  int v16; // [rsp+58h] [rbp-1h] BYREF
  __int128 v17; // [rsp+5Ch] [rbp+3h]
  int v18; // [rsp+6Ch] [rbp+13h]
  int v19; // [rsp+70h] [rbp+17h]
  int v20; // [rsp+74h] [rbp+1Bh]
  struct WDFDEVICE__ *v21; // [rsp+78h] [rbp+1Fh]
  __int64 v22; // [rsp+80h] [rbp+27h]
  void *v23; // [rsp+88h] [rbp+2Fh]
  __int64 v24; // [rsp+D0h] [rbp+77h] BYREF

  *a3 = 0;//*bRequestPending_a3 =FALSE;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x36u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  v6 = *(_QWORD **)(*(_QWORD *)((*((__int64 (__fastcall **)(PVOID, struct WDFREQUEST__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                 + 285))(
                                  WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestWdmGetIrp(Request)
                                  a2)
                              + 184)////PIO_STACK_LOCATION IoStack= IoGetCurrentIrpStackLocation(pIrp);//即是PIO_STACK_LOCATION IoStack = Irp->Tail.Overlay.CurrentStackLocation;
                  + 32i64);//PWORKITEM_CONTEXT pWorkItemContext = (PWORKITEM_CONTEXT)IoStack->Parameters.DeviceIoControl.Type3InputBuffer;//v6是指针因为前面有指针转换
  if ( v6 && *v6 )//if (pWorkItemContext && pWorkItemContext->FxDevice)
  {
    v23 = off_1C000B0C0;//=&WDF_WORKITEM_CONTEXT_TYPE_INFO
    v21 = *(struct WDFDEVICE__ **)a1;//device_v21 = pDeviceContext->device;
    v19 = 1;
    
     v15[0] = 24i64;
    v15[2] = 1i64;//WDF_WORKITEM_CONFIG WorkItemConfig;	WDF_WORKITEM_CONFIG_INIT(&WorkItemConfig, PowerIdleIrpWorkitem);
    v15[1] = (__int64)PowerIdleIrpWorkitem;
    
    v20 = 1;
    v17 = 0i64;
    v18 = 0;
    v22 = 0i64;
    v16 = 56;//WDF_OBJECT_ATTRIBUTES WorkItemAttributes;		WDF_OBJECT_ATTRIBUTES_INIT(&WorkItemAttributes);

    v9 = (*((__int64 (__fastcall **)(PVOID, __int64 *, int *, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 379))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfWorkItemCreate(&WorkItemConfig, &WorkItemAttributes, &IdleWorkItem);
           v15,
           &v16,
           &v24);//&IdleWorkItem_v24
    v10 = v9;
    if ( v9 >= 0 )
    {
      v11 = (_QWORD *)(*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
                        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PWORKITEM_CONTEXT pWorkItemContext_new = GetWorkItemContext(IdleWorkItem);
                        v24,//IdleWorkItem_v24
                        off_1C000B0C0);
      *v11 = *(_QWORD *)a1;//pWorkItemContext_new->FxDevice = pDeviceContext->FxDevice;
      v11[1] = a2;//pWorkItemContext_new->FxRequest = pDeviceContext->DeviceResetNotificationRequest;
      (*((void (__fastcall **)(PVOID, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 380))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfWorkItemEnqueue(IdleWorkItem);
        v24);//IdleWorkItem_v24
      *a3 = 1;////*bRequestPending_a3 =TRUE;
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v13 = v9;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0x38u,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v13);
    }
  }
  else
  {
    v10 = -1073741224;//STATUS_NO_CALLBACK_ACTIVE        ((NTSTATUS)0xC0000258L)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_13:
      TraceLoggingHID(v10, *(struct WDFDEVICE__ **)a1, v7, v8);
      goto LABEL_14;
    }
    v14 = -1073741224;//STATUS_NO_CALLBACK_ACTIVE        ((NTSTATUS)0xC0000258L)
    WPP_RECORDER_SF_qd(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x37u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      a2,
      v14);
  }
  if ( v10 < 0 )
    goto LABEL_13;
LABEL_14:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      4u,
      0x39u,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
  return (unsigned int)v10;
}
// 1C00065A4: variable 'v7' is possibly undefined
// 1C00065A4: variable 'v8' is possibly undefined
// 1C000B0C0: using guessed type void *off_1C000B0C0;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0006600) ----------------------------------------------------
__int64 __fastcall _HidGetHidDescriptor(struct _DEVICE_CONTEXT *a1)
{
  unsigned __int16 v1; // r15
  _WORD *v2; // rsi
  int v4; // eax
  __int64 v5; // rdx
  __int64 v6; // r8
  const GUID *v7; // r9
  unsigned int v8; // ebp
  __int64 v9; // rdx
  unsigned int v11; // [rsp+20h] [rbp-38h]
  __int64 v12; // [rsp+28h] [rbp-30h]

  v1 = *((_WORD *)a1 + 48);//USHORT RegisterAddress = pDeviceContext->AcpiSettings.HidDescriptorAddress;
  v2 = (_WORD *)((char *)a1 + 98);//PUSHORT pHidDescriptorLength = (PUSHORT)&pDeviceContext->HidSettings.HidDescriptorLength;//注意v2需要用指针，因为后spbread后被赋值改变了HidDescriptorLength后续*v2调用需要
  *(_QWORD *)((char *)a1 + 98) = 0i64;//pDeviceContext->HidSettings.HidDescriptorLength = NULL；//注意偏移量98/2=49所以是InputRegisterAddress
  *(_QWORD *)((char *)a1 + 106) = 0i64;////pDeviceContext->HidSettings.InputRegisterAddress = NULL;//注意偏移量106/2=53所以是InputRegisterAddress
  *(_QWORD *)((char *)a1 + 114) = 0i64;//pDeviceContext->HidSettings.CommandRegisterAddress = NULL;////注意偏移量114/2=57所以是CommandRegisterAddress
  *(_DWORD *)((char *)a1 + 122) = 0;//pDeviceContext->HidSettings.VersionId;////注意偏移量122/2=61所以是VersionId
  *((_WORD *)a1 + 63) = 0;//pDeviceContext->HidSettings.Reserved = 0;
  v4 = SpbRead(*((struct WDFIOTARGET__ **)a1 + 9), v1, (unsigned __int8 *)a1 + 98, 0x1Eu, v11, 0);//status = SpbRead(pDeviceContext->SpbIoTarget, RegisterAddress, (PBYTE)&pDeviceContext->HidSettings.HidDescriptorLength, 0x1Eu, DelayUs, 0);//注意是SpbIoTarget
  v8 = v4;
  if ( v4 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v12) = v4;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0x3Au,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v12);
    }
    v9 = 3221291009i64;
LABEL_19:
    DeviceReportPnpProblem(*(_QWORD *)a1, v9, v6, v7);
    return v8;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LODWORD(v12) = v1;
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      v5,
      4u,
      0x3Bu,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v12);
  }
  if ( *v2 != 30  //*pHidDescriptorLength != 30 //pDeviceContext->HidSettings.HidDescriptorLength != 30
    || *((_WORD *)a1 + 50) != 256//pDeviceContext->HidSettings.BcdVersion != 256
    || !*((_WORD *)a1 + 52)//!pDeviceContext->HidSettings.ReportDescriptorAddress
    || !*((_WORD *)a1 + 53)//pDeviceContext->HidSettings.InputRegisterAddress////注意偏移量106/2=53所以是InputRegisterAddress
    || *((_WORD *)a1 + 54) < 2u//pDeviceContext->HidSettings.InputReportMaxLength<2;
    || !*((_WORD *)a1 + 57) ////!pDeviceContext->HidSettings.CommandRegisterAddress//注意偏移量114/2=所以是CommandRegisterAddress
    || !*((_WORD *)a1 + 58)//!pDeviceContext->HidSettings.DataRegisterAddress//注意偏移116/2=58所以是DataRegisterAddress
    || !*((_WORD *)a1 + 59)//!pDeviceContext->VendorID
    || *((_DWORD *)a1 + 31) )//pDeviceContext->HidSettings.Reserved //注意偏移为DWORD和前面比较得出31*2=62以及前面a1 + 63为LONG的低位并且条件和前面取非运算相反所以是pDeviceContext->HidSettings.Reserved
  {
    v8 = -1073741434;//STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v12) = -1073741434;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        4u,
        0x3Cu,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v12);
    }
    v9 = 3221291010i64;
    goto LABEL_19;
  }
  return v8;
}
// 1C0006655: variable 'v11' is possibly undefined
// 1C0006697: variable 'v12' is possibly undefined
// 1C00066DF: variable 'v5' is possibly undefined
// 1C0006760: variable 'v6' is possibly undefined
// 1C0006760: variable 'v7' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0006790) ----------------------------------------------------
void __fastcall HidEvtResetTimerFired(struct WDFTIMER__ *a1)
{
  __int64 v2; // rax
  __int64 v3; // rdi
  __int64 v4; // rax
  int v5; // eax
  __int64 v6; // rdx
  __int64 v7; // r8
  int v8; // [rsp+30h] [rbp-21h]
  __int64 *v9; // [rsp+30h] [rbp-21h]
  __int64 v10; // [rsp+48h] [rbp-9h] BYREF
  __int64 v11[2]; // [rsp+50h] [rbp-1h] BYREF
  char v12[32]; // [rsp+60h] [rbp+Fh] BYREF

  v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFTIMER__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 321))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a1);//WDFOBJECT device_v2 = (WDFDEVICE)WdfTimerGetParentObject(timer_a1);
  v3 = (*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         v2,
         off_1C000B018);//pDeviceContext_v3 = GetDeviceContext(device_v2);
         
         
         //DECLARE_CONST_UNICODE_STRING(ValueNameString, L"DoNotWaitForResetResponse");//效果等同下列多行
	/*PUNICODE_STRING pValueNameString;
	pValueNameString->MaximumLength = 3407922;
	PWCHAR pWCharBuf;
	wcscpy((wchar_t*)pWCharBuf, L"DoNotWaitForResetResponse");
	pValueNameString->Buffer = pWCharBuf;*/
  //PUNICODE_STRING pString;
  wcscpy((wchar_t *)v12, L"DoNotWaitForResetResponse");//	PWCHAR pWCharBuf;	wcscpy((wchar_t*)pWCharBuf, L"DoNotWaitForResetResponse");
  v11[0] = 3407922i64;//	pString->MaximumLength = 3407922;
  v11[1] = (__int64)v12;//pString->Buffer = pWCharBuf;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v8 = 4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      4u,
      0x3Du,
      (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
      v8);
  }
  (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 154))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfIoQueueStart(  WDFQUEUE Queue  )
    *(_QWORD *)(v3 + 32));//pDeviceContext_v3->IoctlQueue //注意偏移4 *8 =32所以是IoctlQueue
    
  v4 = (*((__int64 (__fastcall **)(PVOID, struct WDFTIMER__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 321))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a1);//WDFDEVICE device_v4 = (WDFDEVICE)WdfTimerGetParentObject(timer_a1);
         
  v10 = 0i64;//WDFKEY hKey = NULL;
  v9 = &v10;
  
    //伪代码很可能少了2个参数??
 /* status = WdfDeviceOpenRegistryKey(
		device,
		PLUGPLAY_REGKEY_DEVICE,//1
		KEY_WRITE,
		WDF_NO_OBJECT_ATTRIBUTES,
		&hKey);*/
		
	//WdfDeviceOpenDevicemapKey(
	//	device,
	//	&ValueNameString,
	//	KEY_WRITE,
	//	WDF_NO_OBJECT_ATTRIBUTES,
	//	&hKey);

  v5 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 48))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//
         v4,//device_v4
         1i64,
         131078i64);//0x20006=KEY_WRITE
  if ( v5 >= 0 )
  {
    if ( (*((int (__fastcall **)(PVOID, __int64, __int64 *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 246))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRegistryAssignULong(WDFKEY Key,PCUNICODE_STRING ValueName,ULONG Value )
           v10,
           v11,//PCUNICODE_STRING ValueName
           1i64) >= 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_ZL((__int64)WPP_GLOBAL_Control->DeviceExtension, v6, v7, 0x12u, 0, (const wchar_t *)v11);
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      WPP_RECORDER_SF_Zd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        8i64,
        0x11u,
        (__int64)&WPP_726ae28c65f835e1f9147df5104045df_Traceguids,
        (const wchar_t *)v11);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LODWORD(v9) = v5;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      8u,
      0x10u,
      (__int64)&WPP_726ae28c65f835e1f9147df5104045df_Traceguids,
      v9);
  }
  if ( v10 )//if (hKey)
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 231))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//	WdfObjectDelete(hKey);
}
// 1C00069C7: variable 'v6' is possibly undefined
// 1C00069C7: variable 'v7' is possibly undefined
// 1C0009600: using guessed type wchar_t aDonotwaitforre[26];
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0006A1C) ----------------------------------------------------
__int64 __fastcall HidReset(struct _DEVICE_CONTEXT *a1)//HidReset(PDEVICE_CONTEXT pDeviceContext)
{
  unsigned __int16 v1; // r14
  __int64 v2; // rdx
  int v4; // eax
  int v5; // eax
  __int64 v6; // rdx
  __int64 v7; // r8
  unsigned __int16 v8; // r9
  unsigned __int8 v9; // dl
  __int64 v10; // rdx
  int v11; // esi
  struct _MCGEN_TRACE_CONTEXT *v12; // rcx
  __int64 v13; // r8
  __int64 v15; // [rsp+28h] [rbp-39h]
  __int64 *v16; // [rsp+30h] [rbp-31h]
  unsigned __int8 v17[2]; // [rsp+48h] [rbp-19h] BYREF
  int v18; // [rsp+4Ch] [rbp-15h] BYREF
  __int64 v19; // [rsp+50h] [rbp-11h] BYREF
  __int64 v20[2]; // [rsp+58h] [rbp-9h] BYREF
  char v21[32]; // [rsp+68h] [rbp+7h] BYREF

  v1 = *((_WORD *)a1 + 57);//pDeviceContext->HidSettings.CommandRegisterAddress;
  v2 = *(_QWORD *)a1;// device_v2 = pDeviceContext->FxDevice;
  v18 = 0;//ULONG value = 0;
  v19 = 0i64;//WDFKEY hKey = NULL;
    v16 = &v19;
    
  *(_WORD *)v17 = 256;//UCHAR data[2]; *(PUSHORT)data=256;
  
  //DECLARE_CONST_UNICODE_STRING(ValueNameString, L"DoNotWaitForResetResponse");//效果等同下列多行
	/*PUNICODE_STRING pValueNameString;
	pValueNameString->MaximumLength = 3407922;
	PWCHAR pWCharBuf;
	wcscpy((wchar_t*)pWCharBuf, L"DoNotWaitForResetResponse");
	pValueNameString->Buffer = pWCharBuf;*/
  v20[1] = (__int64)v21;//
  wcscpy((wchar_t *)v21, L"DoNotWaitForResetResponse");
  v20[0] = 3407922i64;
  
  //伪代码很可能少了2个参数??
  	/*status = WdfDeviceOpenRegistryKey(
		device,
		PLUGPLAY_REGKEY_DEVICE,//1
		KEY_READ,
		WDF_NO_OBJECT_ATTRIBUTES,
		&hKey);*/

	//WdfDeviceOpenDevicemapKey(
	//	device,
	//	&ValueNameString,
	//	KEY_READ,
	//	WDF_NO_OBJECT_ATTRIBUTES,
	//	&hKey);
  v4 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 48))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         v2,//device_v2//前面已经有device_v2
         1i64,
         131097i64);//0x20019=KEY_READ
  if ( v4 >= 0 )
  {
    v5 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64 *, int *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 240))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfRegistryQueryULong(hKey, &ValueNameString, &value);
           v19,
           v20,
           &v18);
    if ( v5 >= 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_ZL((__int64)WPP_GLOBAL_Control->DeviceExtension, v6, v7, 0xFu, 0, (const wchar_t *)v20);
    }
    else
    {
      if ( v5 == -1073741772 )//status_v5 == STATUS_OBJECT_NAME_NOT_FOUND     ((NTSTATUS)0xC0000034L)
      {
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_13;
        v8 = 14;
        v9 = 4;
      }
      else
      {
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_13;
        v8 = 13;
        v9 = 2;
      }
      WPP_RECORDER_SF_Zd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v9,
        8i64,
        v8,
        (__int64)&WPP_726ae28c65f835e1f9147df5104045df_Traceguids,
        (const wchar_t *)v20);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LODWORD(v16) = v4;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      8u,
      0xCu,
      (__int64)&WPP_726ae28c65f835e1f9147df5104045df_Traceguids,
      v16);
  }
LABEL_13:
  if ( v19 )//if (hKey)
    (*((void (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 231))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//WdfObjectDelete(hKey);

  (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 144))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfInterruptAcquireLock(WDFINTERRUPT Interrupt   )
    *((_QWORD *)a1 + 2));//WdfInterruptAcquireLock(pDeviceContext->ReadInterrupt);//注意偏移2*8 =16所以是ReadInterrupt
  if ( !v18 )
  {
    (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 156))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfIoQueueStopSynchronously( 
      *((_QWORD *)a1 + 4));//&pDeviceContext->IoctlQueue
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        4u,
        0x3Eu,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids);
    (*((void (__fastcall **)(PVOID, _QWORD, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 319))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfTimerStart(pDeviceContext_a1-> timerHandle_21,  WDF_REL_TIMEOUT_IN_MS(400)); 
      *((_QWORD *)a1 + 21),//pDeviceContext_a1-> timerHandle_21
      -40000000i64);
  }
  v11 = SpbWrite(*((struct WDFIOTARGET__ **)a1 + 9), v1, v17, 2u, 1u);//pDeviceContext->SpbIoTarget,pDeviceContext->HidSettings.CommandRegisterAddress,
  if ( v11 >= 0 )
  {
    *((_BYTE *)a1 + 164) = 1;//pDeviceContext->HostInitiatedResetActive=TRUE
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v16) = v1;
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v10,
        4u,
        0x3Fu,
        (__int64)&WPP_c7bf351957b43414ee78ffacc48fa063_Traceguids,
        v16);
    }
  }
  (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 145))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfInterruptReleaseLock(WDFINTERRUPT Interrupt   )
    *((_QWORD *)a1 + 2));//WdfInterruptReleaseLock(pDeviceContext->ReadInterrupt);//注意偏移2*8 =16所以是ReadInterrupt
  if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
  {
    LODWORD(v16) = v11;
    LOWORD(v15) = *(_WORD *)v17;
    McTemplateK0phq(v12, &EVENT_HIDI2C_COMMAND_RESET, v13, *((_QWORD *)a1 + 9), v15, v16);//pDeviceContext->SpbIoTarget
  }
  return (unsigned int)v11;
}
// 1C0006BEF: variable 'v6' is possibly undefined
// 1C0006BEF: variable 'v7' is possibly undefined
// 1C0006D0A: variable 'v10' is possibly undefined
// 1C0006D0A: variable 'v16' is possibly undefined
// 1C0006D4F: variable 'v12' is possibly undefined
// 1C0006D4F: variable 'v13' is possibly undefined
// 1C0006D4F: variable 'v15' is possibly undefined
// 1C0009600: using guessed type wchar_t aDonotwaitforre[26];
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0006D88) ----------------------------------------------------
__int64 __fastcall _HidPower(__int64 a1, __int16 a2)//_DEVICE_CONTEXT, state_a2
{
  unsigned __int16 v2; // si
  struct WDFIOTARGET__ *v4; // rcx
  struct _MCGEN_TRACE_CONTEXT *v5; // rcx
  int v6; // ebx
  __int64 v7; // r8
  __int64 v8; // r9
  __int64 v10; // [rsp+20h] [rbp-28h]
  int v11; // [rsp+28h] [rbp-20h]
  unsigned __int16 v12; // [rsp+58h] [rbp+10h] BYREF

  v2 = *(_WORD *)(a1 + 114);//RegisterAddress = pDeviceContext->HidSettings.CommandRegisterAddress;////注意偏移量114/2=所以是CommandRegisterAddress
  v4 = *(struct WDFIOTARGET__ **)(a1 + 72);//pDeviceContext->SpbIoTarget
  v12 = a2 | 0x800;
  v6 = SpbWrite(v4, v2, (unsigned __int8 *)&v12, 2u, 5u);//status_v6= 
  if ( v6 >= 0 && WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_DD((__int64)WPP_GLOBAL_Control->DeviceExtension, v12, v7, v8, v10);
  if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
  {
    v11 = v6;
    LOWORD(v10) = v12;
    McTemplateK0phq(v5, &EVENT_HIDI2C_COMMAND_POWER, v7, *(_QWORD *)(a1 + 72), v10, v11);//pDeviceContext->SpbIoTarget
  }
  return (unsigned int)v6;
}
// 1C0006DFB: variable 'v7' is possibly undefined
// 1C0006DFB: variable 'v8' is possibly undefined
// 1C0006DFB: variable 'v10' is possibly undefined
// 1C0006E22: variable 'v5' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0006E40) ----------------------------------------------------
void __fastcall TraceLoggingInterrupt(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C00097F7, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C0006EF4) ----------------------------------------------------
ULONG __fastcall McTemplateK0(struct _MCGEN_TRACE_CONTEXT *a1, __int64 a2, const GUID *a3)
{
  EVENT_DATA_DESCRIPTOR EventData; // [rsp+30h] [rbp-28h] BYREF

  return McGenEventWrite(a1, &EVENT_HIDI2C_IO_INTERRUPT_RECEIVED, a3, 1u, &EventData);
}

//----- (00000001C0006F3C) ----------------------------------------------------
ULONG McTemplateK0p(struct _MCGEN_TRACE_CONTEXT *a1, const EVENT_DESCRIPTOR *a2, const GUID *a3, ...)
{
  EVENT_DATA_DESCRIPTOR v4; // [rsp+30h] [rbp-38h] BYREF
  va_list v5; // [rsp+40h] [rbp-28h]
  int v6; // [rsp+48h] [rbp-20h]
  int v7; // [rsp+4Ch] [rbp-1Ch]
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  va_copy(v5, va);
  v7 = 0;
  v6 = 8;
  return McGenEventWrite(a1, a2, a3, 2u, &v4);
}

//----- (00000001C0006FA0) ----------------------------------------------------
unsigned __int8 __fastcall OnInterruptIsr(struct WDFINTERRUPT__ *a1)
{
  __int64 v2; // rax
  __int64 v3; // rsi
  __int64 v4; // rdx
  struct _MCGEN_TRACE_CONTEXT *v5; // rcx
  unsigned int v6; // edi
  _WORD *v7; // r14
  unsigned __int16 v8; // r15
  int v9; // eax
  __int64 v10; // r8
  const GUID *v11; // r9
  int v12; // ebx
  unsigned __int16 v13; // r9
  int v14; // ecx
  unsigned __int8 v15; // dl
  unsigned __int16 v16; // cx
  char v17; // al
  __int64 v18; // rdx
  int v19; // eax
  __int64 v20; // r15
  int v21; // eax
  unsigned __int16 v22; // r9
  __int64 v23; // rax
  struct _MCGEN_TRACE_CONTEXT *v24; // rcx
  int v25; // eax
  unsigned __int8 v26; // dl
  __int64 v28; // [rsp+28h] [rbp-58h]
  __int64 v29; // [rsp+40h] [rbp-40h] BYREF
  __int64 v30; // [rsp+48h] [rbp-38h] BYREF
  __int64 v31; // [rsp+50h] [rbp-30h] BYREF
  GUID ActivityId; // [rsp+58h] [rbp-28h] BYREF
  struct _GUID v33; // [rsp+68h] [rbp-18h] BYREF

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      6u,
      0xAu,
      (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
  v30 = 0i64;//WDFREQUEST deviceResetNotificationRequest = NULL;
  v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFINTERRUPT__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 151))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//device_v2 =WdfInterruptGetDevice(FxInterrupt)
         a1);
  v3 = (*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//pDeviceContext_v3 = GetDeviceContext(device_v2);
         v2,
         off_1C000B018);
  v33 = *_LogGetActivityId(&ActivityId, 0i64);//_GUID_v33
  if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
    McTemplateK0(v5, v4, &v33);
  v6 = *(unsigned __int16 *)(v3 + 108);//ULONG inputReportMaxLength =*(PUSHORT)pDeviceContext->InputReportMaxLength;//注意偏移量108/2=54所以是InputReportMaxLength
  v7 = *(_WORD **)(v3 + 128);//pInputReportBuffer = (PUSHORT)pDevContext->pHidInputReport;
  v8 = *(_WORD *)(v3 + 106);//USHORT RegisterAddress =  pDeviceContext->HidSettings.InputRegisterAddress ;////注意偏移量106/2=53所以是InputRegisterAddress
  memset(v7, 0, *(unsigned __int16 *)(v3 + 108));//memset(pInputReportBuffer, 0, pDeviceContext->InputReportMaxLength);//RtlZeroMemory(pDevContext->pHidInputReport, inputReportMaxLength);//注意偏移量108/2=54所以是InputReportMaxLength
  v9 = SpbWritelessRead(
         *(struct WDFIOTARGET__ **)(v3 + 72),//pDeviceContext->SpbIoTarget
         *(struct WDFREQUEST__ **)(v3 + 88),//pDeviceContext->SpbRequest
         (unsigned __int8 *)v7,//(PBYTE)pInputReportBuffer
         v6,
         &v33);//_GUID_v33
  v12 = v9;
  if ( v9 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_51;
    v13 = 11;
    v14 = v8;//=RegisterAddress
    v15 = 2;
    goto LABEL_9;
  }
  v16 = *v7;//USHORT Actual_HidDescriptorLength =pInputReportBuffer[0];
  v17 = *(_BYTE *)(v3 + 164);//v17 =pDeviceContext->HostInitiatedResetActive
  if ( *v7 )//*pInputReportBuffer!=0
  {
    if ( v17 == 1 )//pDeviceContext->HostInitiatedResetActive==TRUE
    {
      v12 = -1073741434;//STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          6u,
          0x10u,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
          -1073741434);
      goto LABEL_52;
    }
    v20 = v16;
    v14 = v16 - 2;// LONG Actual_inputReportLength= Actual_HidDescriptorLength-2;
    if ( v14 <= 0 || v14 > v6 )
    {
      v9 = -1073741434;//STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186L)
      v12 = -1073741434;
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      {
LABEL_52:
        TraceLoggingInterrupt(v12, *(struct WDFDEVICE__ **)v3, v10, v11);
        goto LABEL_53;
      }
      v13 = 17;
      v15 = 4;
LABEL_9:
      WPP_RECORDER_SF_Dd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v15,
        6u,
        v13,
        (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
        v14,
        v9);
      goto LABEL_51;
    }
    v29 = 0i64;
    v12 = (*((__int64 (__fastcall **)(PVOID, _QWORD, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 158))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,////Status_v19 = WdfIoQueueRetrieveNextRequest(pDeviceContext->HidQueue, &PtpRequest);
            *(_QWORD *)(v3 + 40),//ReportQueue  //注意偏移5*8 =40所以是ReportQueue
            &v29);
    if ( v12 < 0 || !v29 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v26 = 2;
        if ( v12 == -2147483622 )
          v26 = 4;
        WPP_RECORDER_SF_qd(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          v26,
          6u,
          0x12u,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
          v29,
          v12);
      }
      goto LABEL_51;
    }
    v21 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 268))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfRequestRetrieveOutputMemory(request, &memory);
            v29,
            &v31);
    if ( v21 >= 0 )
    {
      v21 = (*((__int64 (__fastcall **)(PVOID, __int64, _QWORD, _WORD *, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
             + 197))(
              WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfMemoryCopyFromBuffer(
              v31,// memory,
              0i64,
              v7 + 1,//pInputReportBuffer是PUSHORT指针宽度,pInputReportBuffer + 1即是pInputReportBuffer偏移2个字节HID_REPORT_LENGTH_FIELD_SIZE
              v20 - 2);//inputReportActualLength);
      if ( v21 >= 0 )
      {
        (*((void (__fastcall **)(PVOID, __int64, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 275))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestSetInformation(request, inputReportActualLength);
          v29,
          v20 - 2);
        goto LABEL_39;
      }
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v22 = 20;
        goto LABEL_34;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v22 = 19;
LABEL_34:
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        6u,
        v22,
        (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
        v21);
      goto LABEL_39;
    }
LABEL_39:
    v23 = (*((__int64 (__fastcall **)(PVOID, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfRequestWdmGetIrp(Request)
            v29);
    IoSetActivityIdIrp(v23, &v33);
    if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
      McTemplateK0p(v24, &EVENT_HIDI2C_IO_FORWARD_TO_COMPLETIONQUEUE, &v33, v29);////
    v25 = (*((__int64 (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 281))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//ntstatus_v25=WdfRequestForwardToIoQueue(request_a2,pDeviceContext_v3->CompletionQueue
            v29,
            *(_QWORD *)(v3 + 48));//CompletionQueue// //注意偏移6*8 =40所以是CompletionQueue
    v12 = v25;
    if ( v25 < 0 && WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v28) = v25;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        6u,
        0x15u,
        (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
        v28);
    }
    (*((void (__fastcall **)(PVOID, struct WDFINTERRUPT__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 142))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfInterruptQueueDpcForIsr(FxInterrupt);
      a1);
    goto LABEL_51;
  }
  if ( v17 == 1 )//if (pDeviceContext->HostInitiatedResetActive==TRUE
  {
    v18 = *(_QWORD *)(v3 + 168);//timerHandle = pDeviceContext->timerHandle;
    *(_BYTE *)(v3 + 164) = 0;//pDeviceContext->HostInitiatedResetActive =FALSE;
    if ( (*((unsigned __int8 (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 320))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfTimerStop(pDeviceContext->timerHandle, FALSE);
           v18,//timerHandle
           0i64) )
    {
      (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 154))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfIoQueueStart(  WDFQUEUE Queue  )
        *(_QWORD *)(v3 + 32));//pDeviceContext_v3->IoctlQueue
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          4u,
          0xCu,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
    }
  }
  else
  {
    v19 = (*((__int64 (__fastcall **)(PVOID, _QWORD, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 158))(
            WPP_MAIN_CB.Queue.Wcb.DeviceContext,//Status_v19 = WdfIoQueueRetrieveNextRequest(pDeviceContext->HidQueue, &PtpRequest);
            *(_QWORD *)(v3 + 64),///pDeviceContext->ResetNotificationQueue// //注意偏移8*8 =40所以是Queue_8
            &v30);//request_v30,
    v12 = v19;
    if ( v19 < 0 )
    {
      if ( v19 == -2147483622 )//STATUS_NO_MORE_ENTRIES           ((NTSTATUS)0x8000001AL)
      {
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          return 1;
        WPP_RECORDER_SF_(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          3u,
          6u,
          0xEu,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
        goto LABEL_53;
      }
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_d(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          2u,
          6u,
          0xFu,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
          v19);
    }
    else
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_qd(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          6u,
          0xDu,
          (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
          v30,
          v19);
      (*((void (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 263))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfRequestComplete(request_v30, ntstatus_v12);
        v30,
        (unsigned int)v12);
    }
  }
LABEL_51:
  if ( v12 < 0 )
    goto LABEL_52;
LABEL_53:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      6u,
      0x16u,
      (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
  return 1;
}
// 1C000707B: variable 'v5' is possibly undefined
// 1C000707B: variable 'v4' is possibly undefined
// 1C000748F: variable 'v24' is possibly undefined
// 1C00074E7: variable 'v28' is possibly undefined
// 1C000758B: variable 'v10' is possibly undefined
// 1C000758B: variable 'v11' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;
// 1C000D060: using guessed type __int64 __fastcall IoSetActivityIdIrp(_QWORD, _QWORD);

//----- (00000001C0007600) ----------------------------------------------------
void __fastcall OnInterruptDpc(struct WDFINTERRUPT__ *a1, void *a2)
{
  __int64 v3; // rax
  __int64 v4; // rbx
  char v5; // di
  struct _MCGEN_TRACE_CONTEXT *v6; // rcx
  __int64 v7; // rdx
  __int64 v8; // rdx
  int v9; // edi
  char v10; // di
  struct WDFREQUEST__ *v11; // [rsp+30h] [rbp-48h] BYREF
  GUID ActivityId; // [rsp+38h] [rbp-40h] BYREF
  GUID v13; // [rsp+48h] [rbp-30h] BYREF

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      6u,
      0x17u,
      (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
  v3 = (*((__int64 (__fastcall **)(PVOID, struct WDFINTERRUPT__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 151))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,///device_v2 =WdfInterruptGetDevice(FxInterrupt)
         a1);
  v4 = (*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         v3,
         off_1C000B018);//pDeviceContext_v4 = GetDeviceContext(device_v3);
  (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 316))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfSpinLockAcquire(pDeviceContext->InProgressLock);
    *(_QWORD *)(v4 + 8));//pDeviceContext->InProgressLock_8
  if ( *(_BYTE *)(v4 + 26) == 1 )//pDeviceContext->DpcInProgess==TRUE
  {
    v5 = 1;//progress = TRUE;
  }
  else
  {
    *(_BYTE *)(v4 + 26) = 1;//pDeviceContext->DpcInProgess =TRUE
    v5 = 0;//progress = FALSE;
  }
  *(_BYTE *)(v4 + 25) = v5;//pDeviceContext->DpcRerun = progress;
  (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 317))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfSpinLockRelease(pDeviceContext->InProgressLock);
    *(_QWORD *)(v4 + 8));//pDeviceContext->InProgressLock_8
  if ( v5 != 1 )
  {
    do
    {
      while ( 1 )
      {
        v8 = *(_QWORD *)(v4 + 48);//pDeviceContext->CompletionQueue,//48/8=6，queque_6
        v11 = 0i64;
        v9 = (*((__int64 (__fastcall **)(PVOID, __int64, struct WDFREQUEST__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
              + 158))(
               WPP_MAIN_CB.Queue.Wcb.DeviceContext,////Status_v19 = WdfIoQueueRetrieveNextRequest(pDeviceContext->CompletionQueue, &PtpRequest);
               v8,
               &v11);
        if ( v9 < 0 || !v11 )
          break;
        v13 = *_LogGetActivityId(&ActivityId, v11);
        if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 1) != 0 )
          McTemplateK0p(v6, &EVENT_HIDI2C_IO_COMPLETE, &v13, v11);//
        (*((void (__fastcall **)(PVOID, struct WDFREQUEST__ *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 263))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfRequestComplete(request_v11, ntstatus_v9);
          v11,
          (unsigned int)v9);
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          WPP_RECORDER_SF_q(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            v7,
            6u,
            0x18u,
            (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids,
            a1);
      }
      (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 316))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfSpinLockAcquire(pDeviceContext->InProgressLock);
        *(_QWORD *)(v4 + 8));//pDeviceContext->InProgressLock_8
      if ( *(_BYTE *)(v4 + 25) == 1 )//if (pDeviceContext->DpcRerun == TRUE) 
      {
        v10 = 1;//rerun = TRUE;
        *(_BYTE *)(v4 + 25) = 0;//pDeviceContext->DpcRerun = FALSE;
      }
      else
      {
        *(_BYTE *)(v4 + 26) = 0;//pDeviceContext->DpcInProgess =FALSE
        v10 = 0;// rerun = FALSE;
      }
      (*((void (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 317))(
        WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfSpinLockRelease(pDeviceContext->InProgressLock);
        *(_QWORD *)(v4 + 8));//pDeviceContext->InProgressLock_8
    }
    while ( v10 );
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        5u,
        6u,
        0x19u,
        (__int64)&WPP_3de35891b74b33b741300fa81a68062f_Traceguids);
  }
}
// 1C000774B: variable 'v6' is possibly undefined
// 1C000779B: variable 'v7' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C0007890) ----------------------------------------------------
LPGUID __fastcall _LogGetActivityId(LPGUID ActivityId, struct WDFREQUEST__ *a2)
{
  __int64 v3; // rax

  *(_QWORD *)&ActivityId->Data1 = 0i64;
  *(_QWORD *)ActivityId->Data4 = 0i64;
  if ( a2 )
  {
    v3 = (*((__int64 (__fastcall **)(PVOID))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(WPP_MAIN_CB.Queue.Wcb.DeviceContext);//PIRP_v3 =WdfRequestWdmGetIrp(Request)
    IoGetActivityIdIrp(v3, ActivityId);
  }
  if ( !*(_QWORD *)&ActivityId->Data1 && !*(_QWORD *)ActivityId->Data4 )
    EtwActivityIdControl(3u, ActivityId);
  return ActivityId;
}
// 1C000D070: using guessed type __int64 __fastcall IoGetActivityIdIrp(_QWORD, _QWORD);

//----- (00000001C0007910) ----------------------------------------------------
void __fastcall TraceLoggingPowerDevice(int a1, struct WDFDEVICE__ *a2, __int64 a3, const GUID *a4)
{
  struct WDFDEVICE__ *v4; // [rsp+30h] [rbp-68h] BYREF
  EVENT_DATA_DESCRIPTOR v5; // [rsp+40h] [rbp-58h] BYREF
  struct WDFDEVICE__ **v6; // [rsp+60h] [rbp-38h]
  int v7; // [rsp+68h] [rbp-30h]
  int v8; // [rsp+6Ch] [rbp-2Ch]
  int *v9; // [rsp+70h] [rbp-28h]
  int v10; // [rsp+78h] [rbp-20h]
  int v11; // [rsp+7Ch] [rbp-1Ch]
  int v12; // [rsp+A0h] [rbp+8h] BYREF

  v12 = a1;
  if ( (unsigned int)dword_1C000B028 > 5
    && (qword_1C000B038 & 0x200000000000i64) != 0
    && (qword_1C000B040 & 0x200000000000i64) == qword_1C000B040 )
  {
    v4 = a2;
    v6 = &v4;
    v8 = 0;
    v7 = 8;
    v9 = &v12;
    v11 = 0;
    v10 = 4;
    TlgWrite((TraceLoggingHProvider)4, &unk_1C0009824, (LPCGUID)0x200000000000i64, a4, 4u, &v5);
  }
}
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B038: using guessed type __int64 qword_1C000B038;
// 1C000B040: using guessed type __int64 qword_1C000B040;

//----- (00000001C00079D0) ----------------------------------------------------
void __fastcall PowerIdleIrpWorkitem(struct WDFWORKITEM__ *a1)
{
  _QWORD *v2; // rdi
  __int64 v3; // rsi
  __int64 v4; // rax
  int v5; // eax
  __int64 v6; // r8
  const GUID *v7; // r9
  int v8; // ebx
  int v9; // [rsp+38h] [rbp-20h]
  int v10; // [rsp+38h] [rbp-20h]

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      7u,
      0xAu,
      (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids);
  v2 = (_QWORD *)(*((__int64 (__fastcall **)(PVOID, struct WDFWORKITEM__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                  + 202))(
                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PWORKITEM_CONTEXT pWorkItemContext = GetWorkItemContext(IdleWorkItem);
                   a1,
                   off_1C000B0C0);
  v3 = (*((__int64 (__fastcall **)(PVOID, _QWORD, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 202))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         *v2,
         off_1C000B018);//pDeviceContext_v3 = GetDeviceContext(device_v2);
  v4 = (*((__int64 (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 285))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//PIRP pIrp = WdfRequestWdmGetIrp(pWorkItemContext->FxRequest);
         v2[1]);
  (**(void (__fastcall ***)(_QWORD))(*(_QWORD *)(v4 + 184) + 32i64))(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(v4 + 184)////PIO_STACK_LOCATION IoStack= IoGetCurrentIrpStackLocation(pIrp);//即是PIO_STACK_LOCATION IoStack = Irp->Tail.Overlay.CurrentStackLocation;
                                                                                           + 32i64)//PHID_SUBMIT_IDLE_NOTIFICATION_CALLBACK_INFO idleCallbackInfo = (PHID_SUBMIT_IDLE_NOTIFICATION_CALLBACK_INFO)IoStack->Parameters.DeviceIoControl.Type3InputBuffer;
                                                                               + 8i64));//idleCallbackInfo->IdleCallback(idleCallbackInfo->IdleContext);
  v5 = (*((__int64 (__fastcall **)(PVOID, _QWORD, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 281))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//ntstatus_v25=WdfRequestForwardToIoQueue(pWorkItemContext->FxRequest,,pDeviceContext->IdleQueue
         v2[1],
         *(_QWORD *)(v3 + 56));//pDeviceContext->IdleQueue
  v8 = v5;
  if ( v5 >= 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v10 = v5;
      WPP_RECORDER_SF_qqd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        7u,
        0xCu,
        (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids,
        v2[1],
        *(_QWORD *)(v3 + 56),//
        v10);
    }
  }
  else
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v9 = v5;
      WPP_RECORDER_SF_qqd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        7u,
        0xBu,
        (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids,
        v2[1],
        *(_QWORD *)(v3 + 56),
        v9);
    }
    (*((void (__fastcall **)(PVOID, _QWORD, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 263))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfRequestComplete(request_v2[1], ntstatus_v8);
      v2[1],
      (unsigned int)v8);
  }
  if ( v8 < 0 )
    TraceLoggingPowerDevice(v8, *(struct WDFDEVICE__ **)v3, v6, v7);
  (*((void (__fastcall **)(PVOID, struct WDFWORKITEM__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 208))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfObjectDelete(
    a1);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        5u,
        7u,
        0xDu,
        (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids);
  }
}
// 1C0007B8C: variable 'v6' is possibly undefined
// 1C0007B8C: variable 'v7' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B0C0: using guessed type void *off_1C000B0C0;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0007C08) ----------------------------------------------------
void __fastcall PowerIdleIrpCompletion(struct _DEVICE_CONTEXT *a1)
{
  __int64 v2; // rdx
  int v3; // eax
  __int64 v4; // r8
  const GUID *v5; // r9
  int v6; // ebx
  int v7; // [rsp+30h] [rbp-28h]
  int v8; // [rsp+38h] [rbp-20h]
  __int64 v9; // [rsp+60h] [rbp+8h] BYREF

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      7u,
      0xEu,
      (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids);
  v2 = *((_QWORD *)a1 + 7);//Queue_v2 = pDeviceContext->IdleQueue;//Queue_7
  v9 = 0i64;//WDFREQUEST request = NULL;
  v3 = (*((__int64 (__fastcall **)(PVOID, __int64, __int64 *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 158))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,////Status_v19 = WdfIoQueueRetrieveNextRequest(pDeviceContext->IdleQueue, &request);
         v2,
         &v9);
  v6 = v3;
  if ( v3 >= 0 && v9 )
  {
    (*((void (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 263))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,////WdfRequestComplete(request_v9, ntstatus_v3);
      v9,
      (unsigned int)v3);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v8 = v6;
      WPP_RECORDER_SF_qqd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        7u,
        0x10u,
        (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids,
        v9,
        *((_QWORD *)a1 + 7),//pDeviceContext->IdleQueue
        v8);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v7 = v3;
    WPP_RECORDER_SF_qd(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      3u,
      7u,
      0xFu,
      (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids,
      *((_QWORD *)a1 + 7),
      v7);
  }
  if ( v6 < 0 )
    TraceLoggingPowerDevice(v6, *(struct WDFDEVICE__ **)a1, v4, v5);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        5u,
        7u,
        0x11u,
        (__int64)&WPP_5ffd1a9dc269374eb0715b7afb3f035a_Traceguids);
  }
}
// 1C0007D35: variable 'v4' is possibly undefined
// 1C0007D35: variable 'v5' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0007D84) ----------------------------------------------------
__int64 __fastcall WPP_RECORDER_SF_ZL(__int64 a1, __int64 a2, __int64 a3, unsigned __int16 a4, int a5, const wchar_t *a6)
{
  const wchar_t *v7; // rsi
  const wchar_t *v9; // rdx
  bool v10; // zf
  int v12; // [rsp+20h] [rbp-58h]

  v7 = L"\b";
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 0x80u) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
  {
    v9 = L"\b";
    if ( a6 )
      v9 = a6;
    pfnWppTraceMessage(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_726ae28c65f835e1f9147df5104045df_Traceguids,
      a4,
      v9);
  }
  v10 = a6 == 0i64;
  if ( a6 )
    v10 = a6 == 0i64;
  if ( !v10 )
    v7 = a6;
  LOWORD(v12) = a4;
  return WppAutoLogTrace(a1, 4i64, 8i64, &WPP_726ae28c65f835e1f9147df5104045df_Traceguids, v12, v7);
}
// 1C0007ECB: variable 'v12' is possibly undefined
// 1C0009594: using guessed type wchar_t asc_1C0009594[2];
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000D028: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD);

//----- (00000001C0007EF8) ----------------------------------------------------
void FxStubDriverUnloadCommon(void)
{
  _QWORD *v0; // rbx
  void (__fastcall *v1)(__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD), void *, PVOID, _QWORD *); // rax

  v0 = &__KMDF_CLASS_BIND_END;
  if ( off_1C000B168 != &__KMDF_CLASS_BIND_START && &__KMDF_CLASS_BIND_END <= off_1C000B168 )
  {
    do
    {
      v1 = (void (__fastcall *)(__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD), void *, PVOID, _QWORD *))v0[8];
      if ( v1 )
        v1(WdfVersionUnbindClass, &WdfBindInfo, WPP_MAIN_CB.Queue.Wcb.DeviceContext, v0);
      else
        WdfVersionUnbindClass(&WdfBindInfo, WPP_MAIN_CB.Queue.Wcb.DeviceContext, v0);
      v0 += 10;
    }
    while ( v0 <= off_1C000B168 );
  }
  WdfVersionUnbind(&WPP_MAIN_CB.Queue, &WdfBindInfo, WPP_MAIN_CB.Queue.Wcb.DeviceContext);
}
// 1C000B168: using guessed type void *off_1C000B168;
// 1C000D008: using guessed type __int64 __fastcall WdfVersionUnbind(_QWORD, _QWORD, _QWORD);
// 1C000D018: using guessed type __int64 __fastcall WdfVersionUnbindClass(_QWORD, _QWORD, _QWORD);

//----- (00000001C0007FA0) ----------------------------------------------------
void FxStubDriverUnload()
{
  if ( qword_1C000B498 && qword_1C000B498 != FxStubDriverUnload )
    qword_1C000B498();
  FxStubDriverUnloadCommon();
}
// 1C000B498: using guessed type __int64 (*qword_1C000B498)(void);

//----- (00000001C0007FE0) ----------------------------------------------------
NTSTATUS __stdcall FxDriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  _security_init_cookie();
  return FxDriverEntryWorker(DriverObject, RegistryPath);
}

//----- (00000001C0008014) ----------------------------------------------------
NTSTATUS __fastcall FxDriverEntryWorker(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  NTSTATUS result; // eax
  struct _WDF_BIND_INFO *v5; // rcx
  NTSTATUS v6; // ebx
  char *i; // rbx
  __int64 (*v8)(void); // rax
  __int64 (*v9)(void); // rax

  if ( !DriverObject )
    return DriverEntry(0i64, RegistryPath);
  LODWORD(WPP_MAIN_CB.Queue.ListEntry.Flink) = 34078720;
  WPP_MAIN_CB.Queue.ListEntry.Blink = (_LIST_ENTRY *)&WPP_MAIN_CB.Queue.Wcb.DeviceObject;
  RtlCopyUnicodeString((PUNICODE_STRING)&WPP_MAIN_CB.Queue, RegistryPath);
  result = WdfVersionBind(DriverObject, &WPP_MAIN_CB.Queue, &WdfBindInfo, &WPP_MAIN_CB.Queue.Wcb.DeviceContext);
  if ( result >= 0 )
  {
    v6 = FxStubBindClasses(v5);
    if ( v6 < 0 )
    {
LABEL_7:
      FxStubDriverUnloadCommon();
      return v6;
    }
    if ( &__KMDF_TYPE_INIT_START > (_UNKNOWN *)__KMDF_TYPE_INIT_END )
    {
      v6 = -1073741701;
      goto LABEL_7;
    }
    for ( i = __KMDF_TYPE_INIT_END; i < __KMDF_TYPE_INIT_END; i += 40 )
    {
      if ( *(_DWORD *)i != 40 )
      {
        v6 = -1073741820;
        goto LABEL_7;
      }
      v8 = (__int64 (*)(void))*((_QWORD *)i + 4);
      if ( v8 )
        *((_QWORD *)i + 3) = v8();
    }
    v6 = DriverEntry(DriverObject, RegistryPath);
    if ( v6 < 0 )
      goto LABEL_7;
    if ( *((_BYTE *)WPP_MAIN_CB.Queue.Wcb.DeviceContext + 48) )
    {
      v9 = qword_1C000B498;
      if ( DriverObject->DriverUnload )
        v9 = (__int64 (*)(void))DriverObject->DriverUnload;
      qword_1C000B498 = v9;
      DriverObject->DriverUnload = (PDRIVER_UNLOAD)FxStubDriverUnload;
    }
    result = 0;
  }
  return result;
}
// 1C0008094: variable 'v5' is possibly undefined
// 1C000B498: using guessed type __int64 (*qword_1C000B498)(void);
// 1C000D000: using guessed type __int64 __fastcall WdfVersionBind(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C000815C) ----------------------------------------------------
__int64 __fastcall FxStubBindClasses(struct _WDF_BIND_INFO *a1)
{
  __int64 result; // rax
  _QWORD *v2; // r8
  bool i; // cf
  _QWORD *v4; // rbx
  __int64 (__fastcall *v5)(__int64 (__fastcall *)(_QWORD, _QWORD), void *, PVOID, _QWORD *); // rax

  result = 0i64;
  if ( &__KMDF_CLASS_BIND_START > (_UNKNOWN *)&__KMDF_CLASS_BIND_END )
    return 3221225595i64;
  v2 = &__KMDF_CLASS_BIND_END;
  for ( i = 0; i; i = v4 < &__KMDF_CLASS_BIND_END )
  {
    if ( (_QWORD *)((char *)v2 + 4) > &__KMDF_CLASS_BIND_END )
      return 3221225595i64;
    if ( *(_DWORD *)v2 != 80 )
      return 3221225476i64;
    v4 = v2 + 10;
    if ( v2 + 10 > &__KMDF_CLASS_BIND_END )
      return 3221225595i64;
    v5 = (__int64 (__fastcall *)(__int64 (__fastcall *)(_QWORD, _QWORD), void *, PVOID, _QWORD *))v2[7];
    off_1C000B168 = v2;
    if ( v5 )
      result = v5(WdfVersionBindClass, &WdfBindInfo, WPP_MAIN_CB.Queue.Wcb.DeviceContext, v2);
    else
      result = WdfVersionBindClass(&WdfBindInfo, WPP_MAIN_CB.Queue.Wcb.DeviceContext);
    if ( (int)result < 0 )
      return result;
    v2 = v4;
  }
  return result;
}
// 1C000B168: using guessed type void *off_1C000B168;
// 1C000D010: using guessed type __int64 __fastcall WdfVersionBindClass(_QWORD, _QWORD);

//----- (00000001C000829C) ----------------------------------------------------
__int64 __fastcall _GSHandlerCheckCommon(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  unsigned __int8 v3; // dl

  result = *(_QWORD *)(a2 + 8);/
  v3 = *(_BYTE *)(*(unsigned int *)(*(_QWORD *)(a2 + 16) + 8i64) + result + 3);//
  if ( (v3 & 0xF) != 0 )
    result = v3 & 0xF0;
  return result;
}

//----- (00000001C0008340) ----------------------------------------------------
void *__cdecl memmove(void *_RCX, const void *Src, size_t Size)
{
  __m128i *v3; // r11
  bool v4; // cf
  size_t k; // r9
  __int64 v7; // rax
  size_t l; // r8
  char v9; // al
  void *result; // rax
  unsigned int v11; // ecx
  size_t v12; // r9
  __m128i v13; // xmm0
  __m128i v14; // xmm1
  int v15; // eax
  int v16; // eax
  __m128i v17; // xmm1
  __m128i v18; // xmm1
  size_t i; // r9
  __int64 v21; // rax
  size_t j; // r8
  __int8 v23; // al
  __m128i *v24; // rax
  __int64 v25; // rcx
  size_t v26; // r9
  __m128i v27; // xmm0
  __m128i v28; // xmm1
  int v29; // eax
  int v30; // eax
  __m128i v31; // xmm1
  __m128i v32; // xmm1
  void *retaddr; // [rsp+0h] [rbp+0h] BYREF

  v3 = (__m128i *)_RCX;
  v4 = Src < _RCX;
  _RDX = (_BYTE *)Src - (_BYTE *)_RCX;
  if ( v4 )
  {
    _RCX = (__m128i *)((char *)_RCX + Size);
    if ( Size >= 0x4F )
    {
      if ( _RDX > 0xFFFFFFFFFFFFFFF0ui64 )
      {
        for ( ; ((unsigned __int8)_RCX & 0xF) != 0; _RCX->m128i_i8[0] = _RCX->m128i_i8[_RDX] )
        {
          _RCX = (__m128i *)((char *)_RCX - 1);
          --Size;
        }
      }
      else
      {
        v24 = _RCX;
        v25 = (unsigned __int8)_RCX & 0xF;
        if ( (_DWORD)v25 )
        {
          Size -= (unsigned int)v25;
          v25 = -(__int64)(unsigned int)v25;
          v24[-1] = _mm_loadu_si128((__m128i *)((char *)v24 + _RDX - 16));
        }
        _RCX = (__m128i *)((char *)v24 + v25);
      }
      v26 = Size >> 5;
      if ( Size >> 5 <= 0x2000 || _RDX > 0xFFFFFFFFFFFFFE00ui64 )
        goto LABEL_38;
      do
      {
        v29 = 4;
        do
        {
          _RCX -= 8;
          __asm
          {
            prefetchnta byte ptr [rcx+rdx]
            prefetchnta byte ptr [rcx+rdx+40h]
          }
          --v29;
        }
        while ( v29 );
        _RCX += 32;
        v30 = 8;
        do
        {
          v31 = _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX - 32));
          _mm_stream_si128(_RCX - 1, _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX - 16)));
          _mm_stream_si128(_RCX - 2, v31);
          _RCX -= 4;
          v32 = _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX));
          _mm_stream_si128(_RCX + 1, _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX + 16)));
          _mm_stream_si128(_RCX, v32);
          --v30;
        }
        while ( v30 );
        Size -= 512i64;
      }
      while ( Size >= 0x200 );
      _InterlockedOr8((volatile signed __int8 *)&retaddr, 0);
      v26 = Size >> 5;
      if ( Size >> 5 )
      {
LABEL_38:
        Size &= 0x1Fu;
        do
        {
          v27 = _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX - 16));
          v28 = _mm_loadu_si128((__m128i *)((char *)_RCX + _RDX - 32));
          _RCX -= 2;
          _RCX[1] = v27;
          *_RCX = v28;
          --v26;
        }
        while ( v26 );
      }
    }
    for ( i = Size >> 3; i; _RCX->m128i_i64[0] = v21 )
    {
      v21 = *(__int64 *)((char *)&_RCX->m128i_i64[-1] + _RDX);
      _RCX = (__m128i *)((char *)_RCX - 8);
      --i;
    }
    for ( j = Size & 7; j; _RCX->m128i_i8[0] = v23 )
    {
      v23 = _RCX->m128i_i8[_RDX - 1];
      _RCX = (__m128i *)((char *)_RCX - 1);
      --j;
    }
    result = v3;
  }
  else
  {
    if ( Size >= 0x4F )
    {
      if ( _RDX < 0x10 )
      {
        for ( ; ((unsigned __int8)_RCX & 0xF) != 0; _RCX = (char *)_RCX + 1 )
        {
          --Size;
          *(_BYTE *)_RCX = *((_BYTE *)_RCX + _RDX);
        }
      }
      else
      {
        v11 = -(int)_RCX & 0xF;
        if ( v11 )
        {
          Size -= v11;
          *v3 = _mm_loadu_si128((__m128i *)((char *)v3 + _RDX));
        }
        _RCX = &v3->m128i_i8[v11];
      }
      v12 = Size >> 5;
      if ( Size >> 5 <= 0x2000 || _RDX < 0x200 )
        goto LABEL_13;
      do
      {
        v15 = 4;
        do
        {
          __asm
          {
            prefetchnta byte ptr [rcx+rdx]
            prefetchnta byte ptr [rcx+rdx+40h]
          }
          _RCX = (char *)_RCX + 128;
          --v15;
        }
        while ( v15 );
        _RCX = (char *)_RCX - 512;
        v16 = 8;
        do
        {
          v17 = _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX + 16));
          _mm_stream_si128((__m128i *)_RCX, _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX)));
          _mm_stream_si128((__m128i *)_RCX + 1, v17);
          _RCX = (char *)_RCX + 64;
          v18 = _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX - 16));
          _mm_stream_si128((__m128i *)_RCX - 2, _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX - 32)));
          _mm_stream_si128((__m128i *)_RCX - 1, v18);
          --v16;
        }
        while ( v16 );
        Size -= 512i64;
      }
      while ( Size >= 0x200 );
      _InterlockedOr8((volatile signed __int8 *)&retaddr, 0);
      v12 = Size >> 5;
      if ( Size >> 5 )
      {
LABEL_13:
        Size &= 0x1Fu;
        do
        {
          v13 = _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX));
          v14 = _mm_loadu_si128((const __m128i *)((char *)_RCX + _RDX + 16));
          _RCX = (char *)_RCX + 32;
          *((__m128i *)_RCX - 2) = v13;
          *((__m128i *)_RCX - 1) = v14;
          --v12;
        }
        while ( v12 );
      }
    }
    for ( k = Size >> 3; k; *((_QWORD *)_RCX - 1) = v7 )
    {
      v7 = *(_QWORD *)((char *)_RCX + _RDX);
      _RCX = (char *)_RCX + 8;
      --k;
    }
    for ( l = Size & 7; l; *((char *)_RCX - 1) = v9 )
    {
      v9 = *((_BYTE *)_RCX + _RDX);
      _RCX = (char *)_RCX + 1;
      --l;
    }
    result = v3;
  }
  return result;
}

//----- (00000001C0008680) ----------------------------------------------------
void *__cdecl memset(void *a1, int Val, size_t Size)
{
  void *result; // rax
  __int64 v4; // rdx
  size_t v5; // r9
  char *v6; // rcx
  size_t v7; // r8
  size_t i; // r8
  __m128 v9; // xmm0
  char *v10; // r8
  __m128 *v11; // rcx
  unsigned __int64 v12; // r8
  unsigned __int64 v13; // r9
  unsigned __int64 j; // r9
  __int64 v15; // r8

  result = a1;
  if ( Size < 8 )
  {
    for ( i = Size & 7; i; --i )
      *((char *)a1 + i - 1) = Val;
  }
  else
  {
    v4 = 0x101010101010101i64 * (unsigned __int8)Val;
    if ( Size >= 0x4F )
    {
      v9 = _mm_movelh_ps((__m128)(unsigned __int64)v4, (__m128)(unsigned __int64)v4);
      *(__m128 *)a1 = v9;
      v10 = (char *)a1 + Size;
      v11 = (__m128 *)(((unsigned __int64)a1 + 16) & 0xFFFFFFFFFFFFFFF0ui64);//
      v12 = v10 - (char *)v11;
      v13 = v12 >> 7;
      if ( v12 >> 7 )
      {
        do
        {
          *v11 = v9;
          v11[1] = v9;
          v11 += 8;
          v11[-6] = v9;
          v11[-5] = v9;
          --v13;
          v11[-4] = v9;
          v11[-3] = v9;
          v11[-2] = v9;
          v11[-1] = v9;
        }
        while ( v13 );
        v12 &= 0x7Fu;
      }
      for ( j = v12 >> 4; j; --j )
        *v11++ = v9;
      v15 = v12 & 0xF;
      if ( v15 )
        *(__m128 *)((char *)v11 + v15 - 16) = v9;
    }
    else
    {
      v5 = Size & 0xFFFFFFFFFFFFFFF8ui64;
      v6 = (char *)a1 + (Size & 0xFFFFFFFFFFFFFFF8ui64);
      do
      {
        *(_QWORD *)((char *)result + v5 - 8) = v4;
        v5 -= 8i64;
      }
      while ( v5 );
      v7 = Size & 7;
      if ( v7 )
        *(_QWORD *)&v6[v7 - 8] = v4;
    }
  }
  return result;
}

//----- (00000001C000E010) ----------------------------------------------------
void __stdcall TlgEnableCallback(LPCGUID pSourceId, ULONG callbackType, UCHAR level, ULONGLONG keywordAny, ULONGLONG keywordAll, PEVENT_FILTER_DESCRIPTOR pFilterData, PVOID pCallbackContext)
{
  int v7; // eax
  void (__fastcall *v8)(LPCGUID, ULONG, UCHAR, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, _QWORD); // rax

  if ( pCallbackContext )
  {
    if ( callbackType )
    {
      if ( callbackType == 1 )
      {
        v7 = 256;
        *((_QWORD *)pCallbackContext + 2) = keywordAny;
        *((_QWORD *)pCallbackContext + 3) = keywordAll;
        if ( level )
          v7 = level + 1;
        *(_DWORD *)pCallbackContext = v7;
      }
    }
    else
    {
      *(_DWORD *)pCallbackContext = 0;
    }
    v8 = (void (__fastcall *)(LPCGUID, ULONG, UCHAR, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, _QWORD))*((_QWORD *)pCallbackContext + 5);
    if ( v8 )
      v8(pSourceId, callbackType, level, keywordAny, keywordAll, pFilterData, *((_QWORD *)pCallbackContext + 6));
  }
}

//----- (00000001C000E090) ----------------------------------------------------
PVOID WppLoadTracingSupport()
{
  PVOID result; // rax
  struct _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-10h] BYREF
  unsigned int v2; // [rsp+50h] [rbp+10h] BYREF

  v2 = 0;
  *(_QWORD *)&DestinationString.Length = 0i64;
  DestinationString.Buffer = 0i64;
  RtlInitUnicodeString(&DestinationString, L"PsGetVersion");
  pfnWppGetVersion = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiTraceMessage");
  pfnWppTraceMessage = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiQueryTraceInformation");
  pfnWppQueryTraceInformation = (__int64)MmGetSystemRoutineAddress(&DestinationString);
  result = pfnWppGetVersion;
  WPPTraceSuite = 2;
  if ( pfnWppGetVersion )
    result = (PVOID)pfnWppGetVersion(&v2, 0i64, 0i64, 0i64);
  if ( v2 >= 6 )
  {
    RtlInitUnicodeString(&DestinationString, L"EtwRegisterClassicProvider");
    result = MmGetSystemRoutineAddress(&DestinationString);
    pfnEtwRegisterClassicProvider = (__int64)result;
    if ( result )
    {
      RtlInitUnicodeString(&DestinationString, L"EtwUnregister");
      result = MmGetSystemRoutineAddress(&DestinationString);
      *(_QWORD *)&WPP_MAIN_CB.Queue.Wcb.NumberOfChannels = result;
      WPPTraceSuite = 4;
    }
  }
  return result;
}
// 1C000B1C0: using guessed type __int64 pfnEtwRegisterClassicProvider;
// 1C000B1C8: using guessed type __int64 (__fastcall *pfnWppTraceMessage)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1C000B1D0: using guessed type __int64 (__fastcall *pfnWppGetVersion)(_QWORD, _QWORD, _QWORD, _QWORD);
// 1C000B1D8: using guessed type int WPPTraceSuite;
// 1C000B208: using guessed type __int64 pfnWppQueryTraceInformation;

//----- (00000001C000E1E0) ----------------------------------------------------
__int64 __fastcall WppTraceCallback(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // ebx
  __int64 v9; // rbp
  unsigned int v10; // edi
  __int64 v11; // rax
  const void **v12; // r15
  unsigned int v13; // er14
  unsigned int v14; // er12
  _WORD *v15; // rcx
  _DWORD *v16; // rsi
  __int64 v17; // rcx
  __int128 v18; // xmm0
  __int64 v19; // rdi
  _DWORD *v20; // rdx
  bool v21; // zf
  __int64 v23; // [rsp+30h] [rbp-38h]
  char v24; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 > 5u )
  {
    if ( a1 <= 7u )
      return v7;
    if ( a1 == 8 )
    {
      v9 = a5;
      v10 = 0;
      v11 = a5;
      v12 = *(const void ***)(a5 + 32);
      do
      {
        v11 = *(_QWORD *)(v11 + 16);//
        ++v10;
      }
      while ( v11 );
      if ( v10 > 0x3F )
        return (unsigned int)-1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL) 
      v13 = 32 * v10 + 24;
      if ( v12 )
      {
        v14 = 32 * v10 + 24;
        v13 += *(unsigned __int16 *)v12 + 2;
      }
      else
      {
        v14 = 0;
      }
      if ( v13 > a3 )
      {
        v7 = -1073741789;//STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023L)
        if ( a3 >= 4 )
        {
          *a4 = v13;
          *v6 = 4;
        }
      }
      else
      {
        memset(a4, 0, a3);
        *a4 = v13;
        a4[2] = v14;
        a4[4] = v10;
        if ( v12 )
        {
          v15 = (_WORD *)((char *)a4 + v14);
          *v15 = *(_WORD *)v12;
          memmove(v15 + 1, v12[1], *(unsigned __int16 *)v12);
        }
        if ( v10 )
        {
          v16 = a4 + 10;
          v17 = v10;
          do
          {
            v18 = *(_OWORD *)*(_QWORD *)(v9 + 8);//reportBufferLen = pHidPacket->reportBufferLen;
            *v16 = 528384;
            v16 += 8;
            *((_OWORD *)v16 - 3) = v18;
            *(_BYTE *)(v9 + 41) = 0;
            *(_DWORD *)(v9 + 44) = 0;
            v9 = *(_QWORD *)(v9 + 16);//pHidPacket->
            --v17;
          }
          while ( v17 );
        }
        *v6 = v13;
      }
      return v7;
    }
    return (unsigned int)-1073741808;// STATUS_INVALID_DEVICE_REQUEST    ((NTSTATUS)0xC0000010L)
  }
  v19 = a5;
  if ( !a5 )
    return (unsigned int)-1073741163;//STATUS_WMI_GUID_NOT_FOUND        ((NTSTATUS)0xC0000295L)
  if ( a3 < 0x30 )
    return (unsigned int)-1073741811;//STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL) 
  do
  {
    v20 = *(_DWORD **)(v19 + 8);///pDeviceContext->InProgressLock_8
    if ( *v20 == a4[6] && v20[1] == a4[7] && v20[2] == a4[8] && v20[3] == a4[9] )
      break;
    v19 = *(_QWORD *)(v19 + 16);//pHidPacket->
  }
  while ( v19 );
  if ( !v19 )
    return (unsigned int)-1073741163;
  if ( a1 == 5 )
  {
    *(_BYTE *)(v19 + 41) = 0;
    *(_DWORD *)(v19 + 44) = 0;
    *(_QWORD *)(v19 + 24) = 0i64;
  }
  else
  {
    v21 = WPPTraceSuite == 2;
    v23 = *((_QWORD *)a4 + 1);
    *(_QWORD *)(v19 + 24) = v23;
    if ( v21 )
    {
      if ( !(unsigned int)pfnWppQueryTraceInformation(3i64, &v24, 4i64, &a6, a4) )
        *(_BYTE *)(v19 + 41) = v24;
      v7 = pfnWppQueryTraceInformation(2i64, v19 + 44, 4i64, &a6, a4);
    }
    else
    {
      *(_DWORD *)(v19 + 44) = HIDWORD(v23);
      *(_BYTE *)(v19 + 41) = BYTE2(v23);
    }
  }
  return v7;
}
// 1C000B208: invalid function type has been ignored
// 1C000B1D8: using guessed type int WPPTraceSuite;
// 1C000B208: using guessed type __int64 (__fastcall *pfnWppQueryTraceInformation)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C000E434) ----------------------------------------------------
void __fastcall WppInitKm(__int64 a1, __int64 a2)
{
  struct _DEVICE_OBJECT *v4; // rbx
  void (__fastcall *v5)(_DRIVER_OBJECT *, _QWORD, __int64 (__fastcall *)(__int64, unsigned __int8, __int64 *, __int64), struct _DEVICE_OBJECT *, PVPB *); // rax

  if ( WPP_GLOBAL_Control != &WPP_MAIN_CB )
  {
    WPP_GLOBAL_Control = &WPP_MAIN_CB;
    if ( WPPTraceSuite == 4 )
    {
      v4 = &WPP_MAIN_CB;
      do
      {
        v5 = (void (__fastcall *)(_DRIVER_OBJECT *, _QWORD, __int64 (__fastcall *)(__int64, unsigned __int8, __int64 *, __int64), struct _DEVICE_OBJECT *, PVPB *))pfnEtwRegisterClassicProvider;
        v4->Vpb = 0i64;
        v5(v4->DriverObject, 0i64, WppClassicProviderCallback, v4, &v4->Vpb);
        v4 = v4->NextDevice;
      }
      while ( v4 );
    }
    else if ( WPPTraceSuite == 2 )
    {
      *(_QWORD *)&WPP_MAIN_CB.Type = WppTraceCallback;
      IoWMIRegistrationControl(&WPP_MAIN_CB, 0x80010001);
    }
    WppAutoLogStart(WPP_GLOBAL_Control, a1, a2);
    WPP_RECORDER_INITIALIZED = &WPP_MAIN_CB;
  }
}
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B1C0: using guessed type __int64 pfnEtwRegisterClassicProvider;
// 1C000B1D8: using guessed type int WPPTraceSuite;
// 1C000D038: using guessed type __int64 __fastcall WppAutoLogStart(_QWORD, _QWORD, _QWORD);

//----- (00000001C000E510) ----------------------------------------------------
void __fastcall WppCleanupKm(__int64 a1)
{
  PDEVICE_OBJECT v1; // rbx

  v1 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (PDEVICE_OBJECT)&WPP_GLOBAL_Control )
  {
    if ( WPPTraceSuite == 4 )
    {
      while ( v1 )
      {
        if ( v1->Vpb )
        {
          (*(void (**)(void))&WPP_MAIN_CB.Queue.Wcb.NumberOfChannels)();
          v1->Vpb = 0i64;
        }
        v1 = v1->NextDevice;
      }
    }
    else if ( WPPTraceSuite == 2 )
    {
      IoWMIRegistrationControl(WPP_GLOBAL_Control, 0x80000002);
    }
    WppAutoLogStop(WPP_GLOBAL_Control, a1);
    WPP_GLOBAL_Control = (PDEVICE_OBJECT)&WPP_GLOBAL_Control;
    WPP_RECORDER_INITIALIZED = &WPP_RECORDER_INITIALIZED;
  }
}
// 1C000B270: invalid function type has been ignored
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B1D8: using guessed type int WPPTraceSuite;
// 1C000D040: using guessed type __int64 __fastcall WppAutoLogStop(_QWORD, _QWORD);

//----- (00000001C000E5C0) ----------------------------------------------------
__int64 __fastcall OnDeviceAdd(__int64 a1, __int64 a2)
{
  int v2; // eax
  __int64 v3; // r8
  const GUID *v4; // r9
  int v5; // ebx
  unsigned __int16 v6; // r9
  struct WDFDEVICE__ **v7; // rsi
  struct WDFDEVICE__ *v9; // [rsp+48h] [rbp-C0h] BYREF
  __int64 v10; // [rsp+50h] [rbp-B8h] BYREF
  _QWORD v11[18]; // [rsp+58h] [rbp-B0h] BYREF
  _QWORD v12[7]; // [rsp+E8h] [rbp-20h] BYREF
  _QWORD v13[5]; // [rsp+120h] [rbp+18h] BYREF //PVOID v13

  v10 = a2;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0xCu,
      (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids);
    a2 = v10;
  }
  (*((void (__fastcall **)(PVOID, __int64, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 57))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WdfDeviceInitSetPowerPolicyOwnership(FxDeviceInit_a2, FALSE);
    a2,
    0i64);
  
  //WDF_PNPPOWER_EVENT_CALLBACKS pnpPowerCallbacks_v11;
  memset(v11, 0, sizeof(v11));//WDF_PNPPOWER_EVENT_CALLBACKS_INIT(&pnpPowerCallbacks);
  v11[5] = OnPrepareHardware;//pnpPowerCallbacks.EvtDevicePrepareHardware = OnPrepareHardware;
  v11[6] = OnReleaseHardware;//pnpPowerCallbacks.EvtDeviceReleaseHardware = OnReleaseHardware;
  v11[1] = OnD0Entry;//pnpPowerCallbacks.EvtDeviceD0Entry = OnD0Entry;
  v11[3] = OnD0Exit;//	pnpPowerCallbacks.EvtDeviceD0Exit = OnD0Exit;
  v11[2] = OnPostInterruptsEnabled;//pnpPowerCallbacks.EvtDeviceD0EntryPostInterruptsEnabled= OnPostInterruptsEnabled;
  v11[10] = OnSelfManagedIoSuspend;//pnpPowerCallbacks.EvtDeviceSelfManagedIoSuspend =OnSelfManagedIoSuspend;
  LODWORD(v11[0]) = 144;
  
  (*((void (__fastcall **)(PVOID, __int64, _QWORD *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 55))(
    WPP_MAIN_CB.Queue.Wcb.DeviceContext,
    v10,
    v11);//WdfDeviceInitSetPnpPowerEventCallbacks(DeviceInit_v10, &pnpPowerCallbacks);
  
  memset(v12, 0, sizeof(v12));
  v12[6] = off_1C000B018;
  LODWORD(v12[0]) = 56;
  v12[3] = 0x100000001i64;// WDF_OBJECT_ATTRIBUTES_INIT_CONTEXT_TYPE(&DeviceAttributes_v12, DEVICE_CONTEXT);
  
  v2 = (*((__int64 (__fastcall **)(PVOID, __int64 *, _QWORD *, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 75))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         &v10,
         v12,
         &v9);//Status_v2 = WdfDeviceCreate(&DeviceInit_v10, &DeviceAttributes_v12, &Device_v9);
  
  v5 = v2;
  if ( v2 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_28;
    v6 = 13;
    goto LABEL_7;
  }
  v7 = (struct WDFDEVICE__ **)(*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                               + 202))(
                                WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                v9,
                                off_1C000B018);//pDeviceContext_v7 = DeviceGetContext(Device_v9);
  *v7 = v9;  //pDeviceContext_v7->hDevice = Device_v9;
  
 //    WDF_TIMER_CONFIG   timerConfig_v13;
  memset(v13, 0, sizeof(v13));
  LODWORD(v13[0]) = 40;
  v13[1] = HidEvtResetTimerFired;//WDF_TIMER_CONFIG_INIT(&timerConfig_v13, HidEvtResetTimerFired);//默认 串行执行timerFunc
  LODWORD(v13[2]) = 0;//
  LODWORD(v13[3]) = 0;// timerConfig.AutomaticSerialization = FALSE;
  BYTE4(v13[2]) = 0;


//	WDF_OBJECT_ATTRIBUTES   TimerAttributes_v11;	
  ////下面3行实际是WDF_OBJECT_ATTRIBUTES_INIT(&TimerAttributes_v11)执行的联合效果;
  memset(v11, 0, 0x38ui64);
  LODWORD(v11[0]) = 56;
  v11[3] = 0x100000002i64;
    v11[4] = v9;  //timerAttributes_v11.ParentObject = Device_v9;
  
  v2 = (*((__int64 (__fastcall **)(PVOID, _QWORD *, _QWORD *, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 318))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfTimerCreate(
         v13,//&timerConfig_v13,
         v11,//&timerAttributes_v11,
         v7 + 21);// WDFTIMER pDeviceContext_v7-> timerHandle_21  
  
  v5 = v2;
  if ( v2 >= 0 )
  {
  	  //  WDF_DEVICE_STATE deviceState_v13;
  	  //  WDF_DEVICE_STATE_INIT(&deviceState);
    v13[0] = 0x20000001Ci64;
    LODWORD(v13[1]) = 2;
    *(_QWORD *)((char *)&v13[1] + 4) = 2i64;
    HIDWORD(v13[2]) = 2;  //2=WdfUseDefault
    LODWORD(v13[3]) = 2;
  
    (*((void (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 29))(
      WPP_MAIN_CB.Queue.Wcb.DeviceContext,
      v9,
      v13);//WdfDeviceSetDeviceState(Device_v9, &deviceState_v13);
    
    //WDF_IO_QUEUE_CONFIG_INIT_DEFAULT_QUEUE( &QueueConfig_v11,WdfIoQueueDispatchParallel);
    memset(v11, 0, 0x60ui64);
    LODWORD(v11[10]) = -1;//Config->Settings.Parallel.NumberOfPresentedRequests = (ULONG)-1;    
    v11[6] = OnInternalDeviceIoControl;//QueueConfig_v11.EvtIoInternalDeviceControl = OnInternalDeviceIoControl;
    v11[0] = 0x200000060i64;
    v11[7] = OnIoStop;//QueueConfig_v11.EvtIoStop = OnIoStop;
    BYTE5(v11[1]) = 1;//queueConfig_v11.DefaultQueue=TRUE;//queueConfig.PowerManaged = WdfTrue;???
    LODWORD(v11[1]) = 1;
    v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *, _QWORD, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
          + 152))(
           WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v2 = WdfIoQueueCreate(
           v9,//Device_v9
           v11,//QueueConfig_v11
           0i64,//WDF_NO_OBJECT_ATTRIBUTES
           v7 + 4);//pDeviceContext_v7->queue_4//IoctlQueue
           
    v5 = v2;
    if ( v2 >= 0 )
    {
    	//  WDF_IO_QUEUE_CONFIG_INIT(&queueConfig, WdfIoQueueDispatchManual);
      memset((char *)&v11[1] + 4, 0, 0x54ui64);
      LODWORD(v11[0]) = 96;
      *(_QWORD *)((char *)v11 + 4) = 3i64;//QueueConfig_v11.DispatchType = WdfIoQueueDispatchManual;
      v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *, _QWORD, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
            + 152))(
             WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v2 = WdfIoQueueCreate(
             v9,////Device_v9
             v11,//QueueConfig_v11
             0i64,//WDF_NO_OBJECT_ATTRIBUTES
             v7 + 5);//pDeviceContext_v7->queue_5//ReportQueue
      v5 = v2;
      if ( v2 >= 0 )
      {
      //WDF_IO_QUEUE_CONFIG_INIT(&queueConfig, WdfIoQueueDispatchManual);	  
        memset((char *)&v11[1] + 4, 0, 0x54ui64);
        LODWORD(v11[0]) = 96;
        *(_QWORD *)((char *)v11 + 4) = 3i64;//QueueConfig_v11.DispatchType = WdfIoQueueDispatchManual;
        v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *, _QWORD, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
              + 152))(
               WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v2 = WdfIoQueueCreate(
               v9,////Device_v9
               v11,//QueueConfig_v11
               0i64,//WDF_NO_OBJECT_ATTRIBUTES
               v7 + 6);//pDeviceContext_v7->queue_6//CompletionQueue
        v5 = v2;
        if ( v2 >= 0 )
        {
        	// //WDF_IO_QUEUE_CONFIG_INIT(&queueConfig, WdfIoQueueDispatchManual);	  
          memset((char *)&v11[1] + 4, 0, 0x54ui64);
          LODWORD(v11[0]) = 96;
          *(_QWORD *)((char *)v11 + 4) = 3i64;
          
          v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *, _QWORD, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                + 152))(
                 WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v2 = WdfIoQueueCreate(
                 v9,////Device_v9
                 v11,//QueueConfig_v11
                 0i64,//WDF_NO_OBJECT_ATTRIBUTES
                 v7 + 7);//pDeviceContext_v7->queue_7//IdleQueue
          v5 = v2;
          if ( v2 >= 0 )
          {
          	  // //WDF_IO_QUEUE_CONFIG_INIT(&queueConfig, WdfIoQueueDispatchManual);	  
            memset((char *)&v11[1] + 4, 0, 0x54ui64);
            LODWORD(v11[0]) = 96;
            *(_QWORD *)((char *)v11 + 4) = 3i64;
            
            v2 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *, _QWORD *, _QWORD, struct WDFDEVICE__ **))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                  + 152))(
                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status_v2 = WdfIoQueueCreate(
                   v9,////Device_v9
                   v11,//QueueConfig_v11
                   0i64,//WDF_NO_OBJECT_ATTRIBUTES
                   v7 + 8);//pDeviceContext_v7->queue_8//ResetNotificationQueue
            v5 = v2;
            if ( v2 >= 0 )
            {
              if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
                WPP_RECORDER_SF_qd(
                  (__int64)WPP_GLOBAL_Control->DeviceExtension,
                  4u,
                  1u,
                  0x14u,
                  (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids,
                  v9,
                  v2);
            }
            else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            {
              v6 = 19;
              goto LABEL_7;
            }
          }
          else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            v6 = 18;
            goto LABEL_7;
          }
        }
        else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          v6 = 17;
          goto LABEL_7;
        }
      }
      else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v6 = 16;
        goto LABEL_7;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v6 = 15;
      goto LABEL_7;
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v6 = 14;
LABEL_7:
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      1u,
      v6,
      (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids,
      v2);
    goto LABEL_28;
  }
LABEL_28:
  if ( v5 < 0 )
    TraceLoggingDeviceDriver(v5, v9, v3, v4);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x15u,
      (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids);
  return (unsigned int)v5;
}
// 1C000EB04: variable 'v3' is possibly undefined
// 1C000EB04: variable 'v4' is possibly undefined
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000EB70) ----------------------------------------------------
void __fastcall OnDriverUnload(ULONGLONG *a1)
{
  __int64 v2; // rax

  McGenEventUnregister(a1);
  EtwUnregister(RegHandle);
  RegHandle = 0i64;
  dword_1C000B028 = 0;
  v2 = (*((__int64 (__fastcall **)(PVOID, ULONGLONG *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 118))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         a1);//PDRIVER_OBJECT pDriverObject_v2= WdfDriverWdmGetDriverObject(Driver_a1);
  WppCleanupKm(v2);
}
// 1C000B028: using guessed type int dword_1C000B028;

//----- (00000001C000EBE0) ----------------------------------------------------
__int64 __fastcall OnD0Exit(__int64 a1, enum _WDF_POWER_DEVICE_STATE a2)
{
  struct _DEVICE_CONTEXT *v4; // rsi
  unsigned int v5; // ebx
  __int32 v7; // [rsp+30h] [rbp-18h]

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x12u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  v4 = (struct _DEVICE_CONTEXT *)(*((__int64 (__fastcall **)(PVOID, __int64, void *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
                                  + 202))(
                                   WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                   a1,
                                   off_1C000B018);//DEVICE_CONTEXT_v4=GetDeviceContext(Device_a1);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v7 = a2 - 1;
    WPP_RECORDER_SF_qd(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      1u,
      0x13u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids,
      a1,
      v7);
  }
  v5 = HidDestroy(v4, a2);//Status = HidDestroy(pDeviceContext, TargetState);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x14u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  return v5;
}
// 1C000B018: using guessed type void *off_1C000B018;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000ECFC) ----------------------------------------------------
void __fastcall DeviceReportPnpProblem(__int64 a1, __int64 a2, __int64 a3, const GUID *a4)//device_a4, status_a2,
{
  ULONG v4; // ebp
  __int64 v6; // rax
  NTSTATUS v7; // eax
  unsigned __int16 v8; // r9
  unsigned __int64 v9; // rdx
  unsigned __int16 v10; // r9
  unsigned __int64 v11; // rdx
  unsigned __int64 v12; // rax
  BYTE *v13; // rcx
  unsigned __int64 i; // r8
  signed int v15; // ecx
  SIZE_T v16; // rbx
  wchar_t *v17; // rax
  wchar_t *Data; // rsi
  NTSTATUS v19; // eax
  unsigned __int16 v20; // r9
  unsigned __int64 v21; // rbx
  int v22; // eax
  unsigned __int64 v23; // rdx
  wchar_t *j; // rax
  signed int v25; // ecx
  int v26; // ebx
  _DEVICE_OBJECT *v27; // rax
  PMESSAGE_RESOURCE_ENTRY *MessageResourceEntry; // [rsp+20h] [rbp-98h]
  ULONG Size; // [rsp+28h] [rbp-90h]
  __int64 Sizea; // [rsp+28h] [rbp-90h]
  PMESSAGE_RESOURCE_ENTRY v31; // [rsp+40h] [rbp-78h] BYREF
  char v32[32]; // [rsp+48h] [rbp-70h] BYREF

  v4 = a2;
  wcscpy((wchar_t *)v32, L"@System32\\drivers\\hidi2c.sys");
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      1u,
      0x17u,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  TraceLoggingPNPFailure((const struct _TlgProvider_t *)v4, a2, a3, a4);
  v6 = (*((__int64 (__fastcall **)(PVOID, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 118))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         *(_QWORD *)WPP_MAIN_CB.Queue.Wcb.DeviceContext);
  v7 = RtlFindMessage(*(PVOID *)(v6 + 24), 0xBu, 0, v4, &v31);
  if ( v7 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return;
    v8 = 24;
    Size = v7;
LABEL_7:
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      1u,
      v8,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids,
      Size);
    goto LABEL_47;
  }
  v9 = v31->Length - 4i64;
  if ( v9 > 0xFFFFFFFE )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return;
    v10 = 25;
LABEL_11:
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      1u,
      v10,
      (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
    goto LABEL_47;
  }
  v11 = v9 >> 1;
  v12 = 0i64;
  v13 = v31->Text;
  if ( v31 == (PMESSAGE_RESOURCE_ENTRY)-4i64 || v11 > 0x7FFFFFFF )
  {
    v15 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
  }
  else
  {
    for ( i = v11; i; --i )
    {
      if ( !*(_WORD *)v13 )
        break;
      v13 += 2;
    }
    v15 = i == 0 ? 0xC000000D : 0;
    if ( i )
      v12 = v11 - i;
    else
      v12 = 0i64;
  }
  if ( v15 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return;
    v8 = 26;
    Size = v15;
    goto LABEL_7;
  }
  v16 = 2 * v12 + 86;
  v17 = (wchar_t *)ExAllocatePoolWithTag((POOL_TYPE)512, v16, 0x49646948u);//htag
  Data = v17;
  if ( !v17 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return;
    v10 = 27;
    goto LABEL_11;
  }
  LODWORD(MessageResourceEntry) = v4;
  v19 = RtlStringCbPrintfW(v17, v16, L"%s,#%d;%s", v32, MessageResourceEntry, v31->Text);
  if ( v19 >= 0 )
  {
    v21 = v16 >> 1;
    v22 = 0;
    if ( v21 > 0x7FFFFFFF )
    {
      v25 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    }
    else
    {
      v23 = v21;
      for ( j = Data; v23; --v23 )
      {
        if ( !*j )
          break;
        ++j;
      }
      v25 = v23 == 0 ? 0xC000000D : 0;
      if ( v23 )
        v22 = v21 - v23;
      else
        v22 = 0;
    }
    v26 = 2 * v22;
    if ( v25 >= 0 )
    {
      v27 = (_DEVICE_OBJECT *)(*((__int64 (__fastcall **)(PVOID, __int64))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 33))(
                                WPP_MAIN_CB.Queue.Wcb.DeviceContext,
                                a1);
      v19 = IoSetDevicePropertyData(v27, &DEVPKEY_Device_DriverProblemDesc, 0, 0, 0x19u, v26 + 2, Data);
      if ( v19 >= 0 || WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_46;
      v20 = 30;
      goto LABEL_44;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v20 = 29;
      LODWORD(Sizea) = v25;
LABEL_45:
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        1u,
        v20,
        (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids,
        Sizea);
      goto LABEL_46;
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v20 = 28;
LABEL_44:
    LODWORD(Sizea) = v19;
    goto LABEL_45;
  }
LABEL_46:
  ExFreePoolWithTag(Data, 0x49646948u);
LABEL_47:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        5u,
        1u,
        0x1Fu,
        (__int64)&WPP_3ddab8cc3e813e123c06a7e2c1802a48_Traceguids);
  }
}
// 1C000EDB1: variable 'a2' is possibly undefined
// 1C000EDB1: variable 'a3' is possibly undefined
// 1C000EDB1: variable 'a4' is possibly undefined
// 1C000EF5B: variable 'MessageResourceEntry' is possibly undefined
// 1C000F071: variable 'Sizea' is possibly undefined
// 1C0009338: using guessed type wchar_t aSystem32Driver[29];
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000F0F4) ----------------------------------------------------
__int64 __fastcall AcpiInitialize(__int64 *a1, __int64 a2)//ntstatus AcpiInitialize((__int64 *)DEVICE_CONTEXT_a1, writedata_a2); 
{
  int v3; // eax
  struct _MCGEN_TRACE_CONTEXT *v4; // rcx
  __int64 v5; // r8
  const GUID *v6; // r9
  unsigned int v7; // ebx
  __int64 v9; // [rsp+20h] [rbp-18h]

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      2u,
      0xAu,
      (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids);
  v3 = AcpiGetDeviceMethod((__int64)a1, a2);//DEVICE_CONTEXT_a1, writedata_a2
  v7 = v3;
  if ( v3 < 0 )
  {
    if ( (Microsoft_Windows_SPB_HIDI2CEnableBits & 2) != 0 )
    {
      LODWORD(v9) = v3;
      McTemplateK0pq(v4, &EVENT_HIDI2C_ENUMERATION_ACPI_FAILURE, v5, *a1, v9);
    }
    DeviceReportPnpProblem(*a1, 3221291008i64, v5, v6);
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      2u,
      0xBu,
      (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids);
  return v7;
}
// 1C000F150: variable 'a2' is possibly undefined
// 1C000F172: variable 'v4' is possibly undefined
// 1C000F172: variable 'v5' is possibly undefined
// 1C000F172: variable 'v9' is possibly undefined
// 1C000F17F: variable 'v6' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B200: using guessed type char Microsoft_Windows_SPB_HIDI2CEnableBits;

//----- (00000001C000F1D8) ----------------------------------------------------
__int64 __fastcall AcpiGetDeviceMethod(__int64 a1, __int64 a2)//DEVICE_CONTEXT_a1, writedata_a2
{
  void *v2; // rdi
  __int64 v4; // rdx
  int v5; // ebx
  __int64 v6; // r8
  const GUID *v7; // r9
  _DWORD *v8; // rax
  __int64 v9; // rdx
  struct WDFDEVICE__ *v10; // rdx
  __int64 v11; // rax
  __int64 v12; // rdx
  unsigned __int16 v13; // r9
  int v14; // ecx
  int v16; // [rsp+20h] [rbp-49h]
  __int64 v17; // [rsp+28h] [rbp-41h]
  char v18[8]; // [rsp+50h] [rbp-19h] BYREF
  __int64 v19[3]; // [rsp+58h] [rbp-11h] BYREF
  __int64 v20[3]; // [rsp+70h] [rbp+7h] BYREF
  __int64 v21; // [rsp+88h] [rbp+1Fh] BYREF
  __int64 v22; // [rsp+90h] [rbp+27h]
  int v23; // [rsp+98h] [rbp+2Fh]

  v21 = 0i64;
  v18[0] = 0;//BOOLEAN                         isSupported = FALSE;
  v2 = 0i64;
  v22 = 0i64;
  v23 = 0;
  v5 = AcpiDsmSupported((struct WDFDEVICE__ **)a1, a2, v18);//DEVICE_CONTEXT_a1, writedata_a2,
  //status = AcpiDsmSupported( FxDeviceContext,ACPI_DSM_HIDI2C_FUNCTION, &isSupported);
  if ( v5 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_cd((__int64)WPP_GLOBAL_Control->DeviceExtension, v4, v6, 0xFu, v16);
    goto LABEL_20;
  }
  if ( !v18[0] )//if (isSupported == FALSE)
  {
    v5 = -1073741637;//STATUS_NOT_SUPPORTED             ((NTSTATUS)0xC00000BBL)

    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_cd((__int64)WPP_GLOBAL_Control->DeviceExtension, v4, v6, 0x10u, v16);
    goto LABEL_21;
  }
  v8 = ExAllocatePoolWithTag(PagedPool, 0x40ui64, 0x49646948u);//acpiInput = (PACPI_EVAL_INPUT_BUFFER_COMPLEX) HIDI2C_ALLOCATE_POOL(PagedPool, acpiInputSize);
  v2 = v8;
  if ( !v8 )// if (acpiInput == NULL) 
  {
    v5 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        2u,
        0x11u,
        (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
        -1073741670);//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    goto LABEL_21;
  }
  AcpiPrepareInputParametersForDsm(v8, v9, 1);// AcpiPrepareInputParametersForDsm(acpiInput, acpiInputSize,   ACPI_DSM_HIDI2C_FUNCTION);
  
  v10 = *(struct WDFDEVICE__ **)a1;//FxDeviceContext->FxDevice
  
  //   WDF_MEMORY_DESCRIPTOR  inputDescriptor;
    //WDF_MEMORY_DESCRIPTOR  outputDescriptor;
  v21 = 0i64;
  v22 = 0i64;
  v23 = 0;

  v20[0] = 1i64;
  v20[2] = 64i64;
  v20[1] = (__int64)v2;//// WDF_MEMORY_DESCRIPTOR_INIT_BUFFER( &inputDescriptor, (PVOID)acpiInput, acpiInputSize);
  
   v19[1] = (__int64)&v21;// //WDF_MEMORY_DESCRIPTOR_INIT_BUFFER( &outputDescriptor,   (PVOID)&acpiOutput,  sizeof(ACPI_EVAL_OUTPUT_BUFFER));
  v19[0] = 1i64;
  v19[2] = 20i64;
  v11 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 42))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,//WDFIOTARGET acpiIoTarget = WdfDeviceGetIoTarget(pDeviceContext->FxDevice);
          v10);
  v5 = (*((__int64 (__fastcall **)(PVOID, __int64, _QWORD, __int64, __int64 *, __int64 *, _QWORD, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 186))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,////status = WdfIoTargetSendIoctlSynchronously(acpiIoTarget, NULL, IOCTL_ACPI_EVAL_METHOD, &memoryDescriptor, NULL,  NULL, &bytes);
         v11,
         0i64,
         3325956i64,//IOCTL_ACPI_EVAL_METHOD
         v20,//&inputDescriptor
         v19,//&outputDescriptor
         0i64,
         0i64);
  if ( v5 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_20;
    v13 = 18;
    goto LABEL_19;
  }
  if ( !WORD2(v22) && HIWORD(v22) )//if ((acpiOutput.Argument[0].Type != ACPI_METHOD_ARGUMENT_INTEGER) ||    (acpiOutput.Argument[0].DataLength == 0)) 
  {
    v14 = (unsigned __int8)v23;
    *(_WORD *)(a1 + 96) = (unsigned __int8)v23;//pDeviceContext->AcpiSettings.HidDescriptorAddress =(USHORT) acpiOutput.Argument[0].Data[0];//注意偏移量96/2=48所以是pDeviceContext->AcpiSettings.HidDescriptorAddress
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v17) = v14;
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v12,
        2u,
        0x14u,
        (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
        v17);
    }
LABEL_20:
    if ( v5 >= 0 )
      goto LABEL_22;
    goto LABEL_21;
  }
  v5 = -1073741823;//STATUS_UNSUCCESSFUL              ((NTSTATUS)0xC0000001L)
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v13 = 19;
LABEL_19:
    LODWORD(v17) = v5;
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      2u,
      v13,
      (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
      v17);
    goto LABEL_20;
  }
LABEL_21:
  TraceLoggingACPI(v5, *(struct WDFDEVICE__ **)a1, v6, v7);
LABEL_22:
  if ( v2 )//if (acpiInput != NULL)
    ExFreePoolWithTag(v2, 0x49646948u);// HIDI2C_FREE_POOL(acpiInput);
  return (unsigned int)v5;
}
// 1C000F257: variable 'v4' is possibly undefined
// 1C000F257: variable 'v6' is possibly undefined
// 1C000F257: variable 'v16' is possibly undefined
// 1C000F317: variable 'v9' is possibly undefined
// 1C000F41E: variable 'v12' is possibly undefined
// 1C000F41E: variable 'v17' is possibly undefined
// 1C000F472: variable 'v7' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000F4BC) ----------------------------------------------------
__int64 __fastcall AcpiDsmSupported(struct WDFDEVICE__ **a1, __int64 a2, char *a3)//DEVICE_CONTEXT_a1, writedata_a2,
{
  char v5; // si
  _DWORD *v6; // rax
  __int64 v7; // rdx
  __int64 v8; // r8
  const GUID *v9; // r9
  void *v10; // rdi
  int v11; // ebx
  struct WDFDEVICE__ *v12; // rdx
  __int64 v13; // rax
  int v14; // eax
  unsigned __int16 v15; // r9
  __int64 v17; // [rsp+28h] [rbp-41h]
  __int64 v18[3]; // [rsp+50h] [rbp-19h] BYREF
  __int64 v19[3]; // [rsp+68h] [rbp-1h] BYREF
  __int64 v20; // [rsp+80h] [rbp+17h] BYREF
  __int64 v21; // [rsp+88h] [rbp+1Fh]
  int v22; // [rsp+90h] [rbp+27h]

  v20 = 0i64;
  v21 = 0i64;
  v22 = 0;
  v5 = 0;//BOOLEAN support = FALSE;
  v6 = ExAllocatePoolWithTag(PagedPool, 0x40ui64, 0x49646948u);//acpiInput = (PACPI_EVAL_INPUT_BUFFER_COMPLEX) HIDI2C_ALLOCATE_POOL(PagedPool, acpiInputSize);
  v10 = v6;
  if ( !v6 )
  {
    v11 = -1073741670;//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        2u,
        0x15u,
        (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
        -1073741670);//STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009AL) 
    goto LABEL_16;
  }
  AcpiPrepareInputParametersForDsm(v6, v7, 0);// AcpiPrepareInputParametersForDsm(  acpiInput,  acpiInputSize,   ACPI_DSM_QUERY_FUNCTION);
  v12 = *a1;
  v20 = 0i64;
  v21 = 0i64;
  v22 = 0;
  v18[1] = (__int64)&v20;
  v19[0] = 1i64;
  v19[2] = 64i64;
  v19[1] = (__int64)v10;
  v18[0] = 1i64;
  v18[2] = 20i64;
  v13 = (*((__int64 (__fastcall **)(PVOID, struct WDFDEVICE__ *))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine + 42))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,// acpiIoTarget = WdfDeviceGetIoTarget(pDeviceContext->FxDevice);
          v12);
  v14 = (*((__int64 (__fastcall **)(PVOID, __int64, _QWORD, __int64, __int64 *, __int64 *, _QWORD, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
         + 186))(
          WPP_MAIN_CB.Queue.Wcb.DeviceContext,//status = WdfIoTargetSendIoctlSynchronously(acpiIoTarget, NULL, IOCTL_ACPI_EVAL_METHOD, &memoryDescriptor, NULL,  NULL, &bytes);
          v13,
          0i64,
          3325956i64,
          v19,
          v18,
          0i64,
          0i64);
  v11 = v14;
  if ( v14 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_15;
    v15 = 22;
    LODWORD(v17) = v14;
LABEL_14:
    WPP_RECORDER_SF_d(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      2u,
      2u,
      v15,
      (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
      v17);
LABEL_15:
    if ( v11 >= 0 )
      goto LABEL_17;
    goto LABEL_16;
  }
  if ( WORD2(v21) != 2 || !HIWORD(v21) )//if ((acpiOutput.Argument[0].Type != ACPI_METHOD_ARGUMENT_BUFFER) || (acpiOutput.Argument[0].DataLength == 0)) 
  {
    v11 = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    {
LABEL_16:
      TraceLoggingACPI(v11, *a1, v8, v9);
      goto LABEL_17;
    }
    v15 = 23;
    LODWORD(v17) = -1073741811;////STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000DL)
    goto LABEL_14;
  }
  v11 = 0;
  if ( (v22 & 2) != 0 )//if ((acpiOutput.Argument[0].Data[0] & (1 << FunctionIndex)) != 0) 
  {
    v5 = 1;//support = TRUE;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v17) = 1;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        2u,
        0x18u,
        (__int64)&WPP_bbb5d3a40b7a34b6a2ec846befa6302c_Traceguids,
        v17);
    }
  }
LABEL_17:
  if ( v10 )//if (acpiInput != NULL) 
    ExFreePoolWithTag(v10, 0x49646948u);// HIDI2C_FREE_POOL(acpiInput);
  *a3 = v5;
  return (unsigned int)v11;
}
// 1C000F574: variable 'v7' is possibly undefined
// 1C000F695: variable 'v17' is possibly undefined
// 1C000F6E5: variable 'v8' is possibly undefined
// 1C000F6E5: variable 'v9' is possibly undefined
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000F738) ----------------------------------------------------
__int64 __fastcall AcpiPrepareInputParametersForDsm(_DWORD *a1, __int64 a2, int a3)//
//AcpiPrepareInputParametersForDsm(   _Inout_ PACPI_EVAL_INPUT_BUFFER_COMPLEX ParametersBuffer,    _In_ ULONG ParametersBufferSize,    _In_ ULONG FunctionIndex    ),
{
  __int64 result; // rax

  memset(a1, 0, 0x40ui64);//RtlZeroMemory(ParametersBuffer, ParametersBufferSize);
  a1[2] = 64;//0x40//ParametersBuffer->Size = ParametersBufferSize;
  *a1 = 1130980673;//0x43696541//ParametersBuffer->Signature = ACPI_EVAL_INPUT_BUFFER_COMPLEX_SIGNATURE;
  a1[1] = 1297302623; //0x4d53445f//MSD_//ParametersBuffer->MethodNameAsUlong = (ULONG)'MSD_';
  a1[3] = 4;//ParametersBuffer->ArgumentCount = ACPI_DSM_INPUT_ARGUMENTS_COUNT;
  a1[4] = 1048578;//0x100002
  memcpy_s(a1 + 5, 0x10ui64, &ACPI_DSM_GUID_HIDI2C, 0x10ui64);//ACPI_METHOD_SET_ARGUMENT_BUFFER(pArgument, &ACPI_DSM_GUID_HIDI2C, sizeof(GUID));
  LOWORD(result) = *((_WORD *)a1 + 9);//ParametersBuffer->
  if ( (unsigned __int16)result >= 4u )
    result = (unsigned __int16)result;
  else
    result = 4i64;
  *(_DWORD *)((char *)a1 + result + 20) = 0x40000;
  *(_DWORD *)((char *)a1 + result + 24) = 1;// ACPI_METHOD_SET_ARGUMENT_INTEGER(pArgument, ACPI_DSM_REVISION);
  *(_DWORD *)((char *)a1 + result + 28) = 0x40000;
  *(_DWORD *)((char *)a1 + result + 32) = a3;// ACPI_METHOD_SET_ARGUMENT_INTEGER(pArgument, FunctionIndex);
  *(_QWORD *)((char *)a1 + result + 36) = 262147i64;//=0x40003
  return result;
}

//----- (00000001C0010008) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  PETWENABLECALLBACK v4; // rdx
  LPCGUID v5; // rcx
  PVOID v6; // r8
  PREGHANDLE v7; // r9
  int v8; // ebx
  GUID v9; // xmm0
  __int64 v10; // rdx
  __int64 v11; // r8
  const GUID *v12; // r9
  PREGHANDLE v13; // rcx
  __int64 v15; // [rsp+28h] [rbp-60h]
  __int64 v16[3]; // [rsp+40h] [rbp-48h] BYREF
  int v17; // [rsp+58h] [rbp-30h]
  int v18; // [rsp+5Ch] [rbp-2Ch]
  GUID ProviderId; // [rsp+60h] [rbp-28h] BYREF

  WPP_MAIN_CB.Timer = (PIO_TIMER)1;
  *(_QWORD *)&WPP_MAIN_CB.Type = 0i64;
  WPP_MAIN_CB.DriverObject = (_DRIVER_OBJECT *)&WPP_ThisDir_CTLGUID_HidI2CTraceGuid;
  WPP_MAIN_CB.NextDevice = 0i64;
  WPP_MAIN_CB.CurrentIrp = 0i64;
  WPP_MAIN_CB.DeviceExtension = 0i64;
  WPP_MAIN_CB.DeviceType = 0;
  WppLoadTracingSupport();
  WPP_MAIN_CB.CurrentIrp = 0i64;
  WppInitKm((__int64)DriverObject, (__int64)RegistryPath);// WPP_INIT_TRACING(DriverObject, RegistryPath);
  McGenEventRegister(v5, v4, v6, v7);
  
  //WDF_DRIVER_CONFIG      config;
  v16[0] = 32i64;
  v16[1] = (__int64)OnDeviceAdd;////WDF_DRIVER_CONFIG_INIT(&config, OnDeviceAdd);//EvtDeviceAdd
  v17 = 0;
  v16[2] = (__int64)OnDriverUnload;//config.EvtDriverUnload=OnDriverUnload
  v18 = 1231317320;
  
  v8 = (*((__int64 (__fastcall **)(PVOID, _DRIVER_OBJECT *, PUNICODE_STRING, _QWORD, __int64 *, _QWORD))WPP_MAIN_CB.Queue.Wcb.DeviceRoutine
        + 116))(
         WPP_MAIN_CB.Queue.Wcb.DeviceContext,
         DriverObject,// status_v8 = WdfDriverCreate(DriverObject,
         RegistryPath,//  RegistryPath,
         0i64,//  &attributes,   =NULL
         v16,// &config,_v16
         0i64);//  WDF_NO_HANDLE
  
  v9 = (GUID)*((_OWORD *)EventInformation - 1);
  xmmword_1C000B050 = 0i64;
  ProviderId = v9;
  if ( !EtwRegister(&ProviderId, TlgEnableCallback, &dword_1C000B028, &RegHandle) )
    EtwSetInformation(RegHandle, EventProviderSetTraits, EventInformation, *(unsigned __int16 *)EventInformation);
  if ( v8 >= 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_q(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        v10,
        1u,
        0xBu,
        (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids,
        DriverObject);
  }
  else
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v15) = v8;
      WPP_RECORDER_SF_d(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        1u,
        0xAu,
        (__int64)&WPP_ea388f3d0afe39bad432b1506e0dfc21_Traceguids,
        v15);
    }
    TraceLoggingWDFDevice(v8, DriverObject, v11, v12);
    EtwUnregister(RegHandle);
    RegHandle = 0i64;
    dword_1C000B028 = 0;
    McGenEventUnregister(v13);
    WppCleanupKm((__int64)DriverObject);
  }
  return v8;
}
// 1C0010083: variable 'v5' is possibly undefined
// 1C0010083: variable 'v4' is possibly undefined
// 1C0010083: variable 'v6' is possibly undefined
// 1C0010083: variable 'v7' is possibly undefined
// 1C001018C: variable 'v15' is possibly undefined
// 1C0010196: variable 'v11' is possibly undefined
// 1C0010196: variable 'v12' is possibly undefined
// 1C00101BB: variable 'v13' is possibly undefined
// 1C0010200: variable 'v10' is possibly undefined
// 1C000B028: using guessed type int dword_1C000B028;
// 1C000B050: using guessed type __int128 xmmword_1C000B050;
// 1C000B100: using guessed type void *WPP_RECORDER_INITIALIZED;

// nfuncs=104 queued=98 decompiled=98 lumina nreq=0 worse=0 better=0
// ALL OK, 98 function(s) have been successfully decompiled