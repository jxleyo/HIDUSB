/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall tlgCreate1Sz_char(__int64 a1, const CHAR *a2);
bool tlgKeywordOn();
NTSTATUS __fastcall tlgWriteTransfer_EtwWriteTransfer(__int64 a1, unsigned __int8 *a2, __int64 a3, __int64 a4, ULONG UserDataCount, PEVENT_DATA_DESCRIPTOR UserData);
__int64 __fastcall HumInternalIoctl(PDEVICE_OBJECT DeviceObject, PVOID Tag); // idb
__int64 WPP_RECORDER_SF_Lqq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
__int64 __fastcall HumGetDescriptorRequest(PDEVICE_OBJECT DeviceObject, __int16 a2, char a3, void **a4, __int64 a5, int a6, char a7, __int16 a8);
__int64 __fastcall HumCallUSB(PDEVICE_OBJECT DeviceObject, ULONG_PTR a2);
__int64 WPP_RECORDER_SF_qDd(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
__int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char); // weak
__int64 __fastcall HumCallUsbComplete(PDEVICE_OBJECT DeviceObject, PIRP Irp, PVOID Context);
NTSTATUS __fastcall HumWriteReport(__int64 a1, IRP *a2, char a3, _BYTE *a4);
NTSTATUS __fastcall HumPower(__int64 a1, IRP *a2);
__int64 __fastcall HumPowerCompletion(PDEVICE_OBJECT DeviceObject, PVOID Tag); // idb
__int64 __fastcall HumReadCompletion(__int64 a1, __int64 a2, unsigned int *a3);
__int64 __fastcall HumPnpCompletion(PDEVICE_OBJECT DeviceObject, PIRP Irp, PVOID Context);
__int64 __fastcall HumWriteCompletion(__int64 a1, __int64 a2, unsigned int *a3);
__int64 __fastcall HumInitDevice(PDEVICE_OBJECT DeviceObject); // idb
__int64 __fastcall HumSetIdle(PDEVICE_OBJECT DeviceObject); // idb
__int64 __fastcall HumSelectConfiguration(PDEVICE_OBJECT DeviceObject, PUSB_CONFIGURATION_DESCRIPTOR ConfigurationDescriptor); // idb
__int64 __fastcall HumGetDeviceDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2);
__int64 __fastcall HumGetConfigDescriptor(PDEVICE_OBJECT DeviceObject, _QWORD *a2, _DWORD *a3);
__int64 __fastcall HumParseHidInterface(__int64 a1, char *a2, unsigned int a3, char **a4);
__int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64); // weak
__int64 __fastcall HumAddDevice(__int64 a1, __int64 a2);
__int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char); // weak
void __fastcall HumCompleteDeviceResetNotificationIrp(__int64 a1, int a2);
void **__fastcall HumDeviceResetNotificationIrpCancelled(__int64 a1, IRP *a2);
__int64 WPP_RECORDER_SF_qdq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
_BOOL8 __fastcall WppIsEqualGuid(_DWORD *a1, _DWORD *a2);
void tlgDefineProvider_annotation__Tlgg_TraceLoggingProviderProv();
__int64 __fastcall HumIncrementPendingRequestCount(__int64 a1);
__int64 WPP_RECORDER_SF_qcc(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...);
__int64 __fastcall WPP_RECORDER_SF_dD(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, char); // weak
__int64 __fastcall _GSHandlerCheckCommon(__int64 a1, __int64 a2);
__int64 _cpu_features_init();
void *__cdecl memmove(void *, const void *Src, size_t Size);
void *__cdecl memset(void *, int Val, size_t Size);
__int64 __fastcall _memset_repmovs(_OWORD *a1, __int64 a2, __int64 a3);
void _memset_query();
void __fastcall _memset_spec_ermsb(char *a1, unsigned __int8 a2, unsigned __int64 a3);
void __fastcall _memset_spec_ermsb_repmovsb(_OWORD *a1, __int64 a2, __int64 a3);
_OWORD *__fastcall _memset_spec_plain(_OWORD *a1, unsigned __int8 a2, unsigned __int64 a3);
__int64 __fastcall HumCreateClose(__int64 a1, __int64 a2);
void __fastcall HumUnload(__int64 a1);
__int64 WPP_RECORDER_SF_dq(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 WPP_RECORDER_SF_qq(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall WppClassicProviderCallback(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4);
void __fastcall HumSetIdleWorker(PDEVICE_OBJECT DeviceObject, PVOID Context);
__int64 __fastcall WPP_RECORDER_SF_L(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char); // weak
__int64 WPP_RECORDER_SF_qd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
__int64 __fastcall GetInterruptInputPipeForDevice(__int64 a1);
LONG __fastcall HumDecrementPendingRequestCount(__int64 a1);
NTSTATUS __fastcall HumGetPortStatus(__int64 a1, _DWORD *a2);
NTSTATUS __fastcall HumGetSetReport(__int64 a1, IRP *a2, _BYTE *a3);
__int64 __fastcall HumGetSetReportCompletion(__int64 a1, __int64 a2, unsigned int *a3);
__int64 __fastcall HumQueueResetWorkItem(__int64 a1, __int64 a2);
__int64 __fastcall HumResetInterruptPipe(PDEVICE_OBJECT DeviceObject); // idb
NTSTATUS __fastcall HumResetParentPort(__int64 a1);
void __fastcall HumResetWorkItem(PDEVICE_OBJECT DeviceObject, PVOID Context);
__int64 WPP_RECORDER_SF_D(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...);
// NTSTATUS __stdcall HidRegisterMinidriver(PHID_MINIDRIVER_REGISTRATION MinidriverRegistration);
// PUSB_INTERFACE_DESCRIPTOR __stdcall USBD_ParseConfigurationDescriptorEx(PUSB_CONFIGURATION_DESCRIPTOR ConfigurationDescriptor, PVOID StartPosition, LONG InterfaceNumber, LONG AlternateSetting, LONG InterfaceClass, LONG InterfaceSubClass, LONG InterfaceProtocol);
// PURB __stdcall USBD_CreateConfigurationRequestEx(PUSB_CONFIGURATION_DESCRIPTOR ConfigurationDescriptor, PUSBD_INTERFACE_LIST_ENTRY InterfaceList);
// __int64 __fastcall WppAutoLogStart(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// __int64 __fastcall imp_WppRecorderReplay(_QWORD, _QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall WppAutoLogStop(_QWORD, _QWORD); weak
// void __stdcall IoInitializeRemoveLockEx(PIO_REMOVE_LOCK Lock, ULONG AllocateTag, ULONG MaxLockedMinutes, ULONG HighWatermark, ULONG RemlockSize);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// void __stdcall IoReleaseRemoveLockEx(PIO_REMOVE_LOCK RemoveLock, PVOID Tag, ULONG RemlockSize);
// void __stdcall IoReleaseCancelSpinLock(KIRQL Irql);
// NTSTATUS __stdcall IoAcquireRemoveLockEx(PIO_REMOVE_LOCK RemoveLock, PVOID Tag, PCSTR File, ULONG Line, ULONG RemlockSize);
// NTSTATUS __stdcall IoSetCompletionRoutineEx(PDEVICE_OBJECT DeviceObject, PIRP Irp, PIO_COMPLETION_ROUTINE CompletionRoutine, PVOID Context, BOOLEAN InvokeOnSuccess, BOOLEAN InvokeOnError, BOOLEAN InvokeOnCancel);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// void __stdcall ExFreePool(PVOID P);
// void __stdcall IoFreeWorkItem(PIO_WORKITEM IoWorkItem);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// PIO_WORKITEM __stdcall IoAllocateWorkItem(PDEVICE_OBJECT DeviceObject);
// void __stdcall IoQueueWorkItem(PIO_WORKITEM IoWorkItem, PIO_WORKITEM_ROUTINE WorkerRoutine, WORK_QUEUE_TYPE QueueType, PVOID Context);
// void __stdcall PoStartNextPowerIrp(PIRP Irp);
// NTSTATUS __stdcall PoCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD); weak
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// void __stdcall IoReleaseRemoveLockAndWaitEx(PIO_REMOVE_LOCK RemoveLock, PVOID Tag, ULONG RemlockSize);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// void __stdcall IoInvalidateDeviceState(PDEVICE_OBJECT PhysicalDeviceObject);
// PVOID __stdcall MmMapLockedPagesSpecifyCache(PMDL MemoryDescriptorList, KPROCESSOR_MODE AccessMode, MEMORY_CACHING_TYPE CacheType, PVOID RequestedAddress, ULONG BugCheckOnFailure, ULONG Priority);
// BOOLEAN __stdcall IoCancelIrp(PIRP Irp);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// NTSTATUS __stdcall EtwUnregister(REGHANDLE RegHandle);
// NTSTATUS __stdcall EtwWriteTransfer(REGHANDLE RegHandle, PCEVENT_DESCRIPTOR EventDescriptor, LPCGUID ActivityId, LPCGUID RelatedActivityId, ULONG UserDataCount, PEVENT_DATA_DESCRIPTOR UserData);
// void __stdcall KeInitializeSpinLock(PKSPIN_LOCK SpinLock);
// NTSTATUS __stdcall EtwRegister(LPCGUID ProviderId, PETWENABLECALLBACK EnableCallback, PVOID CallbackContext, PREGHANDLE RegHandle);
// NTSTATUS __stdcall EtwSetInformation(REGHANDLE RegHandle, EVENT_INFO_CLASS InformationClass, PVOID EventInformation, ULONG InformationLength);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// KIRQL KeGetCurrentIrql(void);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
__int64 TraceLoggingRegisterEx_EtwRegister_EtwSetInformation();
__int64 TraceLoggingRegister_EtwRegister_EtwSetInformation();
NTSTATUS TraceLoggingUnregister_EtwUnregister();
void __fastcall tlgEnableCallback(LPCGUID SourceId, __int64 ControlCode, __int64 Level, ULONGLONG MatchAnyKeyword, ULONGLONG MatchAllKeyword, PEVENT_FILTER_DESCRIPTOR FilterData, PVOID CallbackContext);
__int64 __fastcall HumGetStringDescriptor(PDEVICE_OBJECT DeviceObject, _QWORD *a2);
__int64 __fastcall HumPnP(PDEVICE_OBJECT DeviceObject, PVOID Tag); // idb
__int64 __fastcall HumGetReportDescriptor(PDEVICE_OBJECT DeviceObject, PVOID Tag, _BYTE *a3);
__int64 __fastcall HumGetHidDescriptor(__int64 a1, __int64 a2);
__int64 __fastcall HumGetDeviceAttributes(__int64 a1, _QWORD *a2);
PVOID WppLoadTracingSupport();
void __fastcall WppInitKm(__int64 a1, __int64 a2);
void __fastcall WppCleanupKm(__int64 a1);
__int64 __fastcall WppTraceCallback(char a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
__int64 __fastcall HumAbortPendingRequests(PDEVICE_OBJECT DeviceObject); // idb
__int64 __fastcall HumRemoveDevice(PDEVICE_OBJECT DeviceObject, PVOID Tag); // idb
__int64 __fastcall HumStopDevice(PDEVICE_OBJECT DeviceObject); // idb
NTSTATUS __fastcall HumSystemControl(__int64 a1, IRP *a2);
__int64 __fastcall HumGetMsGenreDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2);
__int64 __fastcall HumGetPhysicalDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2);
NTSTATUS __stdcall GsDriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath);
void __cdecl _security_init_cookie();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids; // weak
_UNKNOWN WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids; // weak
const CHAR File[8] = { '\0', '\0', '\0', '\0', '\0', '\0', '\0', '\0' }; // idb
_UNKNOWN WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids; // weak
_UNKNOWN WPP_ThisDir_CTLGUID_HidUsbTraceGuid; // weak
_UNKNOWN WPP_3df5017319393635ea3e191f08ba3365_Traceguids; // weak
_UNKNOWN WPP_b40a5588456f3c2c427887b931342e5d_Traceguids; // weak
int dword_1C00077B9[13] =
{
  1291,
  0,
  704643104,
  1962967040,
  1886938478,
  1702126437,
  1767982692,
  1701999980,
  1400139264,
  1970561396,
  243794035,
  1936942445,
  6645601
}; // idb
int dword_1C00077EF[13] =
{
  1291,
  0,
  721420320,
  1677754368,
  1667855973,
  1635013477,
  1845519732,
  1635013492,
  7566708,
  1953697416,
  6648929,
  1936026888,
  1701273971
}; // idb
int dword_1C0007826[14] =
{
  1291,
  0,
  469762080,
  1761640448,
  1920222063,
  1953366124,
  1952543827,
  -2013236363,
  1685021454,
  67633253,
  -350844514,
  1367256632,
  767053097,
  1951178952
}; // idb
void *WPP_RECORDER_INITIALIZED = &WPP_RECORDER_INITIALIZED; // weak
PDEVICE_OBJECT WPP_GLOBAL_Control = &WPP_GLOBAL_Control; // idb
int dword_1C0009010 = 0; // weak
PVOID EventInformation = &unk_1C000785E; // idb
__int64 qword_1C0009020 = 0i64; // weak
__int64 qword_1C0009028 = 0i64; // weak
REGHANDLE RegHandle = 0ui64; // idb
__int128 xmmword_1C0009038 = 0i64; // weak
uintptr_t _security_cookie = 47936899621426ui64;
__int64 _security_cookie_complement = -47936899621427i64; // weak
char _isa_info = '\x02'; // weak
_LARGE_INTEGER Timeout = { { 4244967296u, -1 } }; // idb
KSPIN_LOCK resetWorkItemsListSpinLock = 0ui64; // idb
_DEVICE_OBJECT WPP_MAIN_CB =
{
  0,
  0u,
  0,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  0u,
  0u,
  NULL,
  NULL,
  0u,
  '\0',
  { { { { { NULL, NULL }, 0u, 0u } }, NULL, NULL, 0u, NULL, NULL, NULL } },
  0u,
  { 0, 0, { NULL, NULL }, 0ui64, { { -256i64, -72057594037927936i64 } } },
  { { 0u }, { NULL }, 0ui64, NULL, NULL, NULL, NULL, NULL },
  0u,
  NULL,
  { { { { 0 } }, 0, { NULL, NULL } } },
  0u,
  0u,
  NULL,
  NULL
}; // idb


//----- (00000001C0001008) ----------------------------------------------------
__int64 __fastcall tlgCreate1Sz_char(__int64 a1, const CHAR *a2)
{
  __int64 v2; // rax
  __int64 result; // rax

  if ( a2 )
  {
    v2 = -1i64;
    do
      ++v2;
    while ( a2[v2] );
    result = (unsigned int)(v2 + 1);
  }
  else
  {
    a2 = File;
    result = 1i64;
  }
  *(_DWORD *)(a1 + 12) = 0;
  *(_QWORD *)a1 = a2;
  *(_DWORD *)(a1 + 8) = result;
  return result;
}

//----- (00000001C000103C) ----------------------------------------------------
bool tlgKeywordOn()
{
  return (qword_1C0009020 & 0x200000000000i64) != 0 && (qword_1C0009028 & 0x200000000000i64) == qword_1C0009028;
}
// 1C0009020: using guessed type __int64 qword_1C0009020;
// 1C0009028: using guessed type __int64 qword_1C0009028;

//----- (00000001C0001070) ----------------------------------------------------
NTSTATUS __fastcall tlgWriteTransfer_EtwWriteTransfer(__int64 a1, unsigned __int8 *a2, __int64 a3, __int64 a4, ULONG UserDataCount, PEVENT_DATA_DESCRIPTOR UserData)
{
  EVENT_DESCRIPTOR EventDescriptor; // [rsp+30h] [rbp-18h] BYREF

  *(_DWORD *)&EventDescriptor.Id = *a2 << 24;
  *(_DWORD *)&EventDescriptor.Level = *(unsigned __int16 *)(a2 + 1);
  EventDescriptor.Keyword = *(_QWORD *)(a2 + 3);
  UserData->Ptr = (ULONGLONG)EventInformation;
  UserData->Size = *(unsigned __int16 *)EventInformation;
  UserData[1].Ptr = (ULONGLONG)(a2 + 11);
  UserData->Reserved = 2;
  UserData[1].Size = *(unsigned __int16 *)(a2 + 11);
  UserData[1].Reserved = 1;
  return EtwWriteTransfer(RegHandle, &EventDescriptor, 0i64, 0i64, UserDataCount, UserData);
}

//----- (00000001C0001120) ----------------------------------------------------
__int64 __fastcall HumInternalIoctl(PDEVICE_OBJECT DeviceObject, PVOID Tag)
{
  _QWORD *v2; // rdi
  char v4; // si
  __int64 v5; // r13
  struct _IO_REMOVE_LOCK *v6; // r12
  NTSTATUS v7; // eax
  __int64 v8; // rdx
  __int64 v9; // r8
  __int64 v10; // r9
  int v11; // ebx
  unsigned int v12; // edx
  unsigned int v13; // er15
  __int64 v14; // rcx
  __int64 v15; // r8
  __int64 v16; // r9
  __int64 *v17; // rax
  _QWORD *v18; // rax
  __int64 v19; // r12
  int v20; // ecx
  __int64 v21; // rax
  __int64 v22; // r9
  unsigned int v23; // er8
  __int64 v24; // rax
  __int64 v25; // r13
  __int64 v26; // rax
  void *v27; // rbx
  __int64 v28; // rax
  __int64 v29; // r8
  _BYTE *v30; // rax
  __int64 v31; // rcx
  __int64 v32; // r8
  __int64 v33; // r9
  int v34; // eax
  __int64 v35; // rcx
  __int64 v36; // r8
  __int64 v37; // r9
  __int64 v38; // rbx
  _QWORD *v39; // rax
  NTSTATUS v40; // eax
  KIRQL v41; // cl
  int RemlockSize; // [rsp+20h] [rbp-69h]
  char v44[3]; // [rsp+41h] [rbp-48h] BYREF
  int v45; // [rsp+44h] [rbp-45h] BYREF
  __int64 v46; // [rsp+48h] [rbp-41h] BYREF
  struct _IO_REMOVE_LOCK *v47; // [rsp+50h] [rbp-39h]
  __int64 v48; // [rsp+58h] [rbp-31h]
  struct _EVENT_DATA_DESCRIPTOR v49; // [rsp+60h] [rbp-29h] BYREF
  __int64 *v50; // [rsp+80h] [rbp-9h]
  __int64 v51; // [rsp+88h] [rbp-1h]
  __int64 *v52; // [rsp+90h] [rbp+7h]
  __int64 v53; // [rsp+98h] [rbp+Fh]

  v2 = Tag;
  v44[0] = 1;
  v4 = 0;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(Tag) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      (_DWORD)Tag,
      3,
      10,
      (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids);
  }
  v5 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v6 = (struct _IO_REMOVE_LOCK *)(v5 + 104);
  v47 = (struct _IO_REMOVE_LOCK *)(v5 + 104);
  v7 = IoAcquireRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), v2, File, 1u, 0x20u);
  v11 = v7;
  if ( v7 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      WPP_RECORDER_SF_qd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        3u,
        0xBu,
        (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
        v5 + 104,
        v7);
      *((_DWORD *)v2 + 12) = v11;
      IofCompleteRequest((PIRP)v2, 0);
      goto LABEL_77;
    }
    goto LABEL_71;
  }
  v13 = *(_DWORD *)(v2[23] + 24i64);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_Lqq((__int64)WPP_GLOBAL_Control->DeviceExtension, v8, v9, v10, RemlockSize);
  if ( v13 > 0xB0191 )
  {
    switch ( v13 )
    {
      case 0xB0192u:
      case 0xB0195u:
      case 0xB01A2u:
        goto LABEL_58;
      case 0xB019Au:
        v11 = HumGetPhysicalDescriptor(DeviceObject, (__int64)v2);
        *((_DWORD *)v2 + 12) = v11;
        goto LABEL_75;
      case 0xB01E2u:
LABEL_39:
        v34 = HumGetStringDescriptor(DeviceObject, v2);
        goto LABEL_40;
      case 0xB01E6u:
        v34 = HumGetMsGenreDescriptor(DeviceObject, (__int64)v2);
LABEL_40:
        v11 = v34;
        if ( v34 >= 0 || (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
          goto LABEL_70;
        v45 = v11;
        v50 = (__int64 *)&v45;
        v51 = 4i64;
        v52 = &v46;
        LODWORD(v46) = v13;
        v53 = 4i64;
        tlgWriteTransfer_EtwWriteTransfer(v35, (unsigned __int8 *)dword_1C0007826, v36, v37, 4u, &v49);
LABEL_74:
        *((_DWORD *)v2 + 12) = v11;
LABEL_75:
        IofCompleteRequest((PIRP)v2, 0);
        goto LABEL_76;
      case 0xB0233u:
        v41 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(v5 + 136));
        if ( *(_QWORD *)(v5 + 144) )
        {
          KeReleaseSpinLock((PKSPIN_LOCK)(v5 + 136), v41);
          v11 = -1073741808;
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            WPP_RECORDER_SF_qq(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              4u,
              1u,
              0xFu,
              (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
              v2,
              DeviceObject);
            *((_DWORD *)v2 + 12) = -1073741808;
            IofCompleteRequest((PIRP)v2, 0);
            goto LABEL_76;
          }
LABEL_70:
          v4 = 1;
          goto LABEL_71;
        }
        *(_QWORD *)(v5 + 144) = v2;
        _InterlockedExchange64(v2 + 13, (__int64)HumDeviceResetNotificationIrpCancelled);
        if ( *((_BYTE *)v2 + 68) && _InterlockedExchange64(v2 + 13, 0i64) )
        {
          *(_QWORD *)(v5 + 144) = 0i64;
          KeReleaseSpinLock((PKSPIN_LOCK)(v5 + 136), v41);
          v11 = -1073741536;
          if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
            goto LABEL_28;
          WPP_RECORDER_SF_qq(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            4u,
            1u,
            0xEu,
            (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
            v2,
            DeviceObject);
          *((_DWORD *)v2 + 12) = -1073741536;
          IofCompleteRequest((PIRP)v2, 0);
          goto LABEL_76;
        }
        *(_BYTE *)(v2[23] + 3i64) |= 1u;
        KeReleaseSpinLock((PKSPIN_LOCK)(v5 + 136), v41);
        v11 = 259;
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          return (unsigned int)v11;
        WPP_RECORDER_SF_qq(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          1u,
          0xDu,
          (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
          v2,
          DeviceObject);
        break;
      case 0xB0263u:
LABEL_53:
        v40 = HumWriteReport((__int64)DeviceObject, (IRP *)v2, v13 == 721507, v44);
        goto LABEL_54;
      default:
LABEL_73:
        v11 = *((_DWORD *)v2 + 12);
        goto LABEL_74;
    }
  }
  else
  {
    if ( v13 == 721297 )
    {
LABEL_58:
      v40 = HumGetSetReport((__int64)DeviceObject, (IRP *)v2, v44);
LABEL_54:
      v11 = v40;
      if ( v40 < 0 && (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
      {
        v45 = v11;
        v50 = (__int64 *)&v45;
        v17 = &v46;
        LODWORD(v46) = v13;
LABEL_17:
        v52 = v17;
        v51 = 4i64;
        v53 = 4i64;
        tlgWriteTransfer_EtwWriteTransfer(v14, (unsigned __int8 *)dword_1C0007826, v15, v16, 4u, &v49);
      }
    }
    else
    {
      v12 = -1073741824;
      switch ( v13 )
      {
        case 0xB0003u:
          v11 = HumGetHidDescriptor((__int64)DeviceObject, (__int64)v2);
          *((_DWORD *)v2 + 12) = v11;
          goto LABEL_75;
        case 0xB0007u:
          v11 = HumGetReportDescriptor(DeviceObject, v2, v44);
          if ( v11 >= 0 || (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
            goto LABEL_27;
          LODWORD(v46) = v11;
          v50 = &v46;
          v17 = (__int64 *)&v45;
          v45 = v13;
          goto LABEL_17;
        case 0xB000Bu:
          v18 = DeviceObject->DeviceExtension;
          v48 = v2[23];
          v19 = v18[2];
          v20 = *(_DWORD *)(v48 + 8);
          v21 = v2[14];
          v46 = v21;
          v45 = v20;
          if ( !v20 || !v21 )
          {
            v11 = -1073741811;
            goto LABEL_36;
          }
          v22 = *(_QWORD *)(v19 + 16);
          v12 = 0;
          v23 = *(_DWORD *)(v22 + 16);
          if ( !v23 )
            goto LABEL_24;
          break;
        case 0xB000Fu:
          goto LABEL_53;
        case 0xB0013u:
          goto LABEL_39;
        case 0xB001Fu:
        case 0xB0023u:
          v11 = 0;
          *((_DWORD *)v2 + 12) = 0;
          goto LABEL_75;
        case 0xB0027u:
          v11 = HumGetDeviceAttributes((__int64)DeviceObject, v2);
          *((_DWORD *)v2 + 12) = v11;
          goto LABEL_75;
        case 0xB002Bu:
          v38 = v2[23];
          if ( *(_DWORD *)(v38 + 16) >= 0x10u )
          {
            IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(*((_QWORD *)DeviceObject->DeviceExtension + 2) + 104i64), v2, 0x20u);
            *(_BYTE *)(v38 - 72) = *(_BYTE *)v38;
            *(_DWORD *)(v38 - 56) = *(_DWORD *)(v38 + 16);
            *(_QWORD *)(v38 - 40) = *(_QWORD *)(v38 + 32);
            *(_DWORD *)(v38 - 48) = 2228263;
            v39 = DeviceObject->DeviceExtension;
            v44[0] = 0;
            *(_QWORD *)(v38 - 32) = v39[1];
            v11 = IofCallDriver(*((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1), (PIRP)v2);
            if ( v11 >= 0 )
              goto LABEL_77;
          }
          else
          {
            v11 = -1073741789;
          }
          if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
            goto LABEL_27;
          v45 = v11;
          v50 = (__int64 *)&v45;
          v17 = &v46;
          LODWORD(v46) = v13;
          goto LABEL_17;
        default:
          goto LABEL_73;
      }
      while ( 1 )
      {
        v24 = v22 + 24i64 * v12;
        if ( *(char *)(v24 + 26) < 0 && *(_DWORD *)(v24 + 28) == 3 )
          break;
        if ( ++v12 >= v23 )
          goto LABEL_24;
      }
      v25 = v24 + 24;
      if ( v24 == -24 )
      {
LABEL_24:
        v11 = -1073741438;
        goto LABEL_25;
      }
      v26 = ExAllocatePool2(64i64, 152i64, 1432643912i64);
      v27 = (void *)v26;
      if ( v26 )
      {
        *(_DWORD *)v26 = 589952;
        *(_QWORD *)(v26 + 24) = *(_QWORD *)(v25 + 8);
        *(_DWORD *)(v26 + 36) = v45;
        *(_QWORD *)(v26 + 40) = v46;
        *(_QWORD *)(v26 + 48) = 0i64;
        *(_DWORD *)(v26 + 32) = 3;
        *(_QWORD *)(v26 + 56) = 0i64;
        v28 = v2[23];
        *(_QWORD *)(v28 - 16) = HumReadCompletion;
        *(_QWORD *)(v28 - 8) = v27;
        *(_BYTE *)(v28 - 69) = -32;
        v29 = v2[23];
        v30 = (_BYTE *)v48;
        *(_QWORD *)(v29 - 64) = v27;
        *(_BYTE *)(v29 - 72) = *v30;
        *(_DWORD *)(v29 - 48) = 2228227;
        *(_QWORD *)(v29 - 32) = *((_QWORD *)DeviceObject->DeviceExtension + 1);
        _InterlockedIncrement((volatile signed __int32 *)(v19 + 32));
        if ( (unsigned int)(*(_DWORD *)v19 - 1) <= 1 )
        {
          v11 = IofCallDriver(*((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1), (PIRP)v2);
          v44[0] = 0;
        }
        else
        {
          HumDecrementPendingRequestCount(v19);
          ExFreePool(v27);
          v11 = -1073741810;
        }
      }
      else
      {
        v11 = -1073741670;
      }
LABEL_25:
      if ( v11 >= 0 )
        goto LABEL_26;
LABEL_36:
      if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
      {
        v45 = v31;
        v50 = (__int64 *)&v45;
        v51 = 4i64;
        v52 = &v46;
        LODWORD(v46) = v13;
        v53 = 4i64;
        tlgWriteTransfer_EtwWriteTransfer(v31, (unsigned __int8 *)dword_1C0007826, v32, v33, 4u, &v49);
      }
LABEL_26:
      v6 = v47;
    }
LABEL_27:
    if ( v44[0] )
    {
LABEL_28:
      v4 = 1;
LABEL_71:
      *((_DWORD *)v2 + 12) = v11;
      IofCompleteRequest((PIRP)v2, 0);
      if ( v4 )
LABEL_76:
        IoReleaseRemoveLockEx(v6, v2, 0x20u);
      goto LABEL_77;
    }
  }
LABEL_77:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(v12) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      v12,
      3,
      16,
      (__int64)&WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids);
  }
  return (unsigned int)v11;
}
// 1C000126A: variable 'v8' is possibly undefined
// 1C000126A: variable 'v9' is possibly undefined
// 1C000126A: variable 'v10' is possibly undefined
// 1C000126A: variable 'RemlockSize' is possibly undefined
// 1C0001330: variable 'v14' is possibly undefined
// 1C0001330: variable 'v15' is possibly undefined
// 1C0001330: variable 'v16' is possibly undefined
// 1C00014EC: variable 'v31' is possibly undefined
// 1C0001527: variable 'v32' is possibly undefined
// 1C0001527: variable 'v33' is possibly undefined
// 1C000159F: variable 'v35' is possibly undefined
// 1C000159F: variable 'v36' is possibly undefined
// 1C000159F: variable 'v37' is possibly undefined
// 1C0001988: variable 'v12' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C0009010: using guessed type int dword_1C0009010;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C00019C0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_Lqq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-48h]
  __int64 v8; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  __int64 v10; // [rsp+A0h] [rbp+38h] BYREF
  va_list va1; // [rsp+A0h] [rbp+38h]
  va_list va2; // [rsp+A8h] [rbp+40h] BYREF

  va_start(va2, a5);
  va_start(va1, a5);
  va_start(va, a5);
  v8 = va_arg(va1, _QWORD);
  va_copy(va2, va1);
  v10 = va_arg(va2, _QWORD);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 4) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    ((void (__fastcall *)(_DEVICE_OBJECT *, __int64, void *, __int64, __int64 *, __int64, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
      12i64,
      (__int64 *)va,
      4i64,
      (__int64 *)va1,
      8i64,
      va2,
      8i64,
      0i64);
  LOWORD(v7) = 12;
  return WppAutoLogTrace(
           a1,
           4i64,
           3i64,
           &WPP_2854d9da723b379c5be992cbaea3dfcc_Traceguids,
           v7,
           (__int64 *)va,
           4i64,
           (__int64 *)va1,
           8i64,
           va2,
           8i64,
           0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0001A47: variable 'v7' is possibly undefined
// 1C000B030: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C0001A70) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  int v4; // edx
  NTSTATUS v5; // eax
  int v6; // edx
  NTSTATUS v7; // ebx
  int v8; // edx
  __int64 v9; // r8
  __int64 v10; // r9
  NTSTATUS v12; // [rsp+30h] [rbp-98h] BYREF
  struct _HID_MINIDRIVER_REGISTRATION MinidriverRegistration; // [rsp+38h] [rbp-90h] BYREF
  struct _EVENT_DATA_DESCRIPTOR v14; // [rsp+60h] [rbp-68h] BYREF
  int *v15; // [rsp+80h] [rbp-48h]
  __int64 v16; // [rsp+88h] [rbp-40h]
  char v17[16]; // [rsp+90h] [rbp-38h] BYREF

  *(&MinidriverRegistration.Revision + 1) = 0;
  TraceLoggingRegister_EtwRegister_EtwSetInformation();
  *(_QWORD *)&WPP_MAIN_CB.Type = 0i64;
  WPP_MAIN_CB.DriverObject = (_DRIVER_OBJECT *)&WPP_ThisDir_CTLGUID_HidUsbTraceGuid;
  WPP_MAIN_CB.NextDevice = 0i64;
  WPP_MAIN_CB.CurrentIrp = 0i64;
  WPP_MAIN_CB.Timer = (PIO_TIMER)1;
  WPP_MAIN_CB.DeviceExtension = 0i64;
  WPP_MAIN_CB.DeviceType = 0;
  WppLoadTracingSupport();
  WPP_MAIN_CB.CurrentIrp = 0i64;
  WppInitKm((__int64)DriverObject, (__int64)RegistryPath);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
    {
      LOBYTE(v4) = 5;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v4,
        1,
        10,
        (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v4) = 4;
      WPP_RECORDER_SF_q(
        WPP_GLOBAL_Control->DeviceExtension,
        v4,
        1,
        11,
        (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
        (char)DriverObject);
    }
  }
  DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)HumCreateClose;
  DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)HumCreateClose;
  DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)HumInternalIoctl;
  DriverObject->MajorFunction[27] = (PDRIVER_DISPATCH)HumPnP;
  DriverObject->MajorFunction[22] = (PDRIVER_DISPATCH)HumPower;
  DriverObject->MajorFunction[23] = (PDRIVER_DISPATCH)HumSystemControl;
  DriverObject->DriverExtension->AddDevice = (PDRIVER_ADD_DEVICE)HumAddDevice;
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)HumUnload;
  MinidriverRegistration.Revision = 1;
  MinidriverRegistration.DriverObject = DriverObject;
  MinidriverRegistration.RegistryPath = RegistryPath;
  MinidriverRegistration.DeviceExtensionSize = 152;
  MinidriverRegistration.DevicesArePolled = 0;
  v5 = HidRegisterMinidriver(&MinidriverRegistration);
  v7 = v5;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LOBYTE(v6) = 4;
    WPP_RECORDER_SF_d(
      WPP_GLOBAL_Control->DeviceExtension,
      v6,
      1,
      12,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
      v5);
  }
  KeInitializeSpinLock(&resetWorkItemsListSpinLock);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(v8) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      v8,
      1,
      13,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
  }
  if ( v7 < 0 )
  {
    if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
    {
      v12 = v7;
      v15 = &v12;
      v16 = 4i64;
      tlgCreate1Sz_char((__int64)v17, "HIDUSB_MiniportReg");
      tlgWriteTransfer_EtwWriteTransfer((__int64)&v14, (unsigned __int8 *)dword_1C00077B9, v9, v10, 4u, &v14);
    }
    TraceLoggingUnregister_EtwUnregister();
    WppCleanupKm((__int64)DriverObject);
  }
  return v7;
}
// 1C0001B31: variable 'v4' is possibly undefined
// 1C0001C24: variable 'v6' is possibly undefined
// 1C0001C67: variable 'v8' is possibly undefined
// 1C0001CCC: variable 'v9' is possibly undefined
// 1C0001CCC: variable 'v10' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C0009010: using guessed type int dword_1C0009010;

//----- (00000001C0001D10) ----------------------------------------------------
__int64 __fastcall HumGetDescriptorRequest(PDEVICE_OBJECT DeviceObject, __int16 a2, char a3, void **a4, __int64 a5, int a6, char a7, __int16 a8)
{
  __int16 v10; // bp
  char v12; // r15
  int v13; // edx
  _WORD *v14; // rdi
  int v15; // ebp
  __int64 v16; // rdx
  int v17; // ebx
  __int64 v18; // r8
  __int64 v19; // r9
  int v21; // [rsp+20h] [rbp-48h]

  v10 = a2;
  v12 = 0;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        5,
        5,
        93,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(a2) = 4;
      WPP_RECORDER_SF_q(
        WPP_GLOBAL_Control->DeviceExtension,
        a2,
        5,
        94,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        (char)DeviceObject);
    }
  }
  v14 = (_WORD *)ExAllocatePool2(64i64, 136i64, 1432643912i64);
  if ( v14 )
  {
    if ( !*a4 )
    {
      *a4 = (void *)ExAllocatePool2(64i64, *(unsigned int *)a5, 1432643912i64);
      v12 = 1;
    }
    if ( !*a4 )
    {
      v17 = -1073741801;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(v13) = 2;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          v13,
          5,
          98,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          23);
        ExFreePool(v14);
        goto LABEL_30;
      }
      goto LABEL_25;
    }
    if ( !v12 )
      memset(*a4, 0, *(unsigned int *)a5);
    v14[1] = v10;
    *v14 = 136;
    v15 = 0;
    *((_DWORD *)v14 + 9) = *(_DWORD *)a5;
    *((_QWORD *)v14 + 6) = 0i64;
    *((_QWORD *)v14 + 5) = *a4;
    *((_BYTE *)v14 + 130) = a7;
    v14[66] = a8;
    *((_BYTE *)v14 + 131) = a3;
    *((_QWORD *)v14 + 7) = 0i64;
    v17 = HumCallUSB(DeviceObject, (ULONG_PTR)v14);
    if ( v17 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(v16) = 2;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          v16,
          5,
          97,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          v17);
      }
    }
    else
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_qDd((__int64)WPP_GLOBAL_Control->DeviceExtension, v16, v18, v19, v21);
      if ( *((int *)v14 + 1) >= 0 )
      {
        v17 = 0;
        v15 = *((_DWORD *)v14 + 9);
LABEL_24:
        *(_DWORD *)a5 = v15;
LABEL_25:
        ExFreePool(v14);
        goto LABEL_30;
      }
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_dD(WPP_GLOBAL_Control->DeviceExtension, v16, v18, v19, v21, v17, *((_DWORD *)v14 + 1));
      v17 = -1073741823;
    }
    if ( v12 )
    {
      ExFreePool(*a4);
      *a4 = 0i64;
    }
    goto LABEL_24;
  }
  v17 = -1073741801;
  if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
    return (unsigned int)v17;
  LOBYTE(v13) = 2;
  WPP_RECORDER_SF_d(
    WPP_GLOBAL_Control->DeviceExtension,
    v13,
    5,
    99,
    (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
    23);
LABEL_30:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      100,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  return (unsigned int)v17;
}
// 1C0001DA8: variable 'a2' is possibly undefined
// 1C0001E9E: variable 'v16' is possibly undefined
// 1C0001E9E: variable 'v18' is possibly undefined
// 1C0001E9E: variable 'v19' is possibly undefined
// 1C0001E9E: variable 'v21' is possibly undefined
// 1C0001F75: variable 'v13' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004D28: using guessed type __int64 __fastcall WPP_RECORDER_SF_dD(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0002020) ----------------------------------------------------
__int64 __fastcall HumCallUSB(PDEVICE_OBJECT DeviceObject, ULONG_PTR a2)
{
  IRP *v4; // rax
  int v5; // edx
  IRP *v6; // rdi
  NTSTATUS v8; // eax
  int v9; // edx
  unsigned int v10; // esi
  NTSTATUS v11; // eax
  unsigned int v12; // ebx
  NTSTATUS v13; // eax
  int v14; // edx
  _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+60h] [rbp-38h] BYREF

  *(_OWORD *)&Event.Header.Lock = 0i64;
  Event.Header.WaitListHead.Blink = 0i64;
  IoStatusBlock = 0i64;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_qq(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      5u,
      5u,
      0x65u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      DeviceObject,
      *((_QWORD *)DeviceObject->DeviceExtension + 2));
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v4 = IoBuildDeviceIoControlRequest(
         0x220003u,
         *((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1),
         0i64,
         0,
         0i64,
         0,
         1u,
         &Event,
         &IoStatusBlock);
  v6 = v4;
  if ( !v4 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v5) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v5,
        5,
        102,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    }
    return 3221225626i64;
  }
  v8 = IoSetCompletionRoutineEx(DeviceObject, v4, (PIO_COMPLETION_ROUTINE)HumCallUsbComplete, &Event, 1u, 1u, 1u);
  v10 = v8;
  if ( v8 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v9) = 2;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v9,
        5,
        103,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v8);
    }
    IofCompleteRequest(v6, 0);
    return v10;
  }
  v6->Tail.Overlay.CurrentStackLocation[-1].Parameters.WMI.ProviderId = a2;
  v11 = IofCallDriver(*((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1), v6);
  v12 = v11;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_d(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      104,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v11);
  if ( v12 == 259 )
  {
    v13 = KeWaitForSingleObject(&Event, Suspended, 0, 0, &Timeout);
    if ( v13 == 258 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(v14) = 2;
        WPP_RECORDER_SF_(
          WPP_GLOBAL_Control->DeviceExtension,
          v14,
          5,
          105,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
      }
      IoCancelIrp(v6);
      LOBYTE(v13) = KeWaitForSingleObject(&Event, Suspended, 0, 0, 0i64);
      IoStatusBlock.Status = -1073741643;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    {
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        5,
        5,
        106,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v13);
      IofCompleteRequest(v6, 0);
LABEL_24:
      v12 = IoStatusBlock.Status;
      goto LABEL_25;
    }
  }
  IofCompleteRequest(v6, 0);
  if ( v12 == 259 )
    goto LABEL_24;
LABEL_25:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        5,
        5,
        107,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v12);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        5,
        5,
        108,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  }
  return v12;
}
// 1C000212E: variable 'v5' is possibly undefined
// 1C00021A1: variable 'v9' is possibly undefined
// 1C000227A: variable 'v14' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00023C0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qDd(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-48h]
  __int64 v8; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  __int64 v10; // [rsp+A0h] [rbp+38h] BYREF
  va_list va1; // [rsp+A0h] [rbp+38h]
  va_list va2; // [rsp+A8h] [rbp+40h] BYREF

  va_start(va2, a5);
  va_start(va1, a5);
  va_start(va, a5);
  v8 = va_arg(va1, _QWORD);
  va_copy(va2, va1);
  v10 = va_arg(va2, _QWORD);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 0x10) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    ((void (__fastcall *)(_DEVICE_OBJECT *, __int64, void *, __int64, __int64 *, __int64, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      95i64,
      (__int64 *)va,
      8i64,
      (__int64 *)va1,
      4i64,
      va2,
      4i64,
      0i64);
  LOWORD(v7) = 95;
  return WppAutoLogTrace(
           a1,
           4i64,
           5i64,
           &WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
           v7,
           (__int64 *)va,
           8i64,
           (__int64 *)va1,
           4i64,
           va2,
           4i64,
           0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0002447: variable 'v7' is possibly undefined
// 1C000B030: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C0002470) ----------------------------------------------------
#error "1C0002500: call analysis failed (funcsize=58)"

//----- (00000001C0002530) ----------------------------------------------------
__int64 __fastcall HumCallUsbComplete(PDEVICE_OBJECT DeviceObject, PIRP Irp, PVOID Context)
{
  KeSetEvent((PRKEVENT)Context, 0, 0);
  return 3221225494i64;
}

//----- (00000001C0002560) ----------------------------------------------------
NTSTATUS __fastcall HumWriteReport(__int64 a1, IRP *a2, char a3, _BYTE *a4)
{
  _DWORD *v5; // rdi
  _IO_STACK_LOCATION *v7; // r14
  __int64 v10; // rsi
  _DWORD *v11; // rbx
  __int64 v12; // rax
  unsigned __int8 v13; // al
  __int16 v14; // ax
  NTSTATUS result; // eax
  __int64 v16; // r10
  __int64 v17; // rax
  unsigned int v18; // edx
  unsigned int v19; // er8
  __int64 v20; // rax
  int v21; // eax
  _IO_STACK_LOCATION *v22; // rax

  v5 = a2->UserBuffer;
  v7 = a2->Tail.Overlay.CurrentStackLocation;
  v10 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( !v5 || !*(_QWORD *)v5 || !v5[2] )
    return -1073741762;
  v11 = (_DWORD *)ExAllocatePool2(64i64, 152i64, 1432643912i64);
  if ( !v11 )
    return -1073741670;
  if ( (*(_DWORD *)(v10 + 64) & 1) != 0 )
  {
    v12 = GetInterruptInputPipeForDevice(v10);
    if ( !v12 )
    {
      ExFreePool(v11);
      return -1073741762;
    }
    v13 = *(_BYTE *)(v12 + 2) & 0x7F;
    *v11 = 1835144;
    *((_WORD *)v11 + 66) = v13;
    *((_WORD *)v11 + 64) = 2338;
    v14 = *((unsigned __int8 *)v5 + 12) + 512;
  }
  else
  {
    v16 = *(_QWORD *)(v10 + 16);
    v17 = 0i64;
    v18 = 0;
    v19 = *(_DWORD *)(v16 + 16);
    if ( v19 )
    {
      while ( 1 )
      {
        v20 = v16 + 24i64 * v18;
        if ( *(char *)(v20 + 26) >= 0 && *(_DWORD *)(v20 + 28) == 3 )
          break;
        if ( ++v18 >= v19 )
          goto LABEL_14;
      }
      v17 = v20 + 24;
    }
    if ( v17 )
    {
      *v11 = 589952;
      *((_QWORD *)v11 + 3) = *(_QWORD *)(v17 + 8);
      v11[9] = v5[2];
      *((_QWORD *)v11 + 6) = 0i64;
      *((_QWORD *)v11 + 5) = *(_QWORD *)v5;
      v11[8] = 2;
      *((_QWORD *)v11 + 7) = 0i64;
      goto LABEL_23;
    }
LABEL_14:
    *(_WORD *)v11 = 136;
    if ( a3 )
    {
      v11[8] = 8;
      *((_WORD *)v11 + 1) = 50;
      *((_QWORD *)v11 + 5) = *(_QWORD *)v5;
      v11[9] = v5[2];
      v21 = v5[5];
      *((_WORD *)v11 + 64) = 2337;
      if ( !v21 )
        v21 = 5000;
      v11[14] = v21;
      *((_WORD *)v11 + 65) = *((unsigned __int8 *)v5 + 12) + 512;
      *((_WORD *)v11 + 66) = *(unsigned __int8 *)(*(_QWORD *)(v10 + 16) + 2i64);
      *((_WORD *)v11 + 67) = *((_WORD *)v5 + 4);
      goto LABEL_23;
    }
    *((_WORD *)v11 + 1) = 27;
    *((_WORD *)v11 + 66) = *(unsigned __int8 *)(*(_QWORD *)(v10 + 16) + 2i64);
    *((_WORD *)v11 + 64) = 2338;
    v14 = *((unsigned __int8 *)v5 + 12) + 512;
  }
  *((_WORD *)v11 + 65) = v14;
  v11[8] = 0;
  *((_QWORD *)v11 + 5) = *(_QWORD *)v5;
  v11[9] = v5[2];
LABEL_23:
  v22 = a2->Tail.Overlay.CurrentStackLocation;
  v22[-1].CompletionRoutine = (PIO_COMPLETION_ROUTINE)HumWriteCompletion;
  v22[-1].Context = v11;
  v22[-1].Control = -32;
  v7[-1].Parameters.WMI.ProviderId = (ULONG_PTR)v11;
  v7[-1].MajorFunction = v7->MajorFunction;
  v7[-1].Parameters.Read.ByteOffset.LowPart = 2228227;
  v7[-1].DeviceObject = *(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64);
  if ( (int)HumIncrementPendingRequestCount(v10) < 0 )
  {
    ExFreePool(v11);
    result = -1073741810;
  }
  else
  {
    result = IofCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), a2);
    *a4 = 0;
  }
  return result;
}
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0002830) ----------------------------------------------------
NTSTATUS __fastcall HumPower(__int64 a1, IRP *a2)
{
  NTSTATUS v4; // esi
  _IO_STACK_LOCATION *v5; // rax
  _IO_STACK_LOCATION *v6; // rax
  NTSTATUS result; // eax

  v4 = IoAcquireRemoveLockEx((PIO_REMOVE_LOCK)(*(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64) + 104i64), a2, File, 1u, 0x20u);
  if ( v4 < 0 )
  {
    PoStartNextPowerIrp(a2);
    a2->IoStatus.Status = v4;
    a2->IoStatus.Information = 0i64;
    IofCompleteRequest(a2, 0);
    result = v4;
  }
  else
  {
    v5 = a2->Tail.Overlay.CurrentStackLocation;
    *(_OWORD *)&v5[-1].MajorFunction = *(_OWORD *)&v5->MajorFunction;
    *(_OWORD *)&v5[-1].Parameters.NotifyDirectoryEx.CompletionFilter = *(_OWORD *)&v5->Parameters.NotifyDirectoryEx.CompletionFilter;
    *(_OWORD *)(&v5[-1].Parameters.SetQuota + 6) = *(_OWORD *)(&v5->Parameters.SetQuota + 6);
    v5[-1].FileObject = v5->FileObject;
    v5[-1].Control = 0;
    v6 = a2->Tail.Overlay.CurrentStackLocation;
    v6[-1].CompletionRoutine = (PIO_COMPLETION_ROUTINE)HumPowerCompletion;
    v6[-1].Context = 0i64;
    v6[-1].Control = -32;
    result = PoCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), a2);
  }
  return result;
}

//----- (00000001C0002900) ----------------------------------------------------
__int64 __fastcall HumPowerCompletion(PDEVICE_OBJECT DeviceObject, PVOID Tag)
{
  _QWORD *v3; // rax
  int v5; // ecx
  __int64 v6; // r15
  __int64 v7; // rdx
  struct _IO_WORKITEM *v8; // rax
  int v9; // edx
  __int64 v10; // r14
  _WORD *v11; // rax
  ULONG_PTR v12; // rdi
  int v13; // ecx
  __int16 v14; // ax

  v3 = DeviceObject->DeviceExtension;
  v5 = *((_DWORD *)Tag + 12);
  v6 = v3[2];
  if ( *((_BYTE *)Tag + 65) )
    *(_BYTE *)(*((_QWORD *)Tag + 23) + 3i64) |= 1u;
  if ( v5 >= 0 )
  {
    v7 = *((_QWORD *)Tag + 23);
    if ( *(_BYTE *)(v7 + 1) == 2 && *(_DWORD *)(v7 + 16) == 1 && *(_DWORD *)(v7 + 24) == 1 && *(_DWORD *)v6 == 2 )
    {
      if ( KeGetCurrentIrql() < 2u )
      {
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
          WPP_RECORDER_SF_(
            WPP_GLOBAL_Control->DeviceExtension,
            5,
            5,
            91,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
        v10 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
        if ( v10 )
        {
          v11 = (_WORD *)ExAllocatePool2(64i64, 136i64, 1432643912i64);
          v12 = (ULONG_PTR)v11;
          if ( v11 )
          {
            v13 = *(_DWORD *)(v10 + 64);
            *v11 = 136;
            if ( _bittest(&v13, 0) )
            {
              v11[1] = 28;
              v14 = 0;
            }
            else
            {
              v11[1] = 27;
              v14 = *(unsigned __int8 *)(*(_QWORD *)(v10 + 16) + 2i64);
            }
            *(_WORD *)(v12 + 132) = v14;
            *(_DWORD *)(v12 + 128) = 2594;
            *(_QWORD *)(v12 + 32) = 0i64;
            *(_QWORD *)(v12 + 40) = 0i64;
            HumCallUSB(DeviceObject, v12);
            ExFreePool((PVOID)v12);
          }
        }
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
          WPP_RECORDER_SF_(
            WPP_GLOBAL_Control->DeviceExtension,
            5,
            5,
            92,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
      }
      else
      {
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          WPP_RECORDER_SF_(
            WPP_GLOBAL_Control->DeviceExtension,
            4,
            4,
            16,
            (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids);
        v8 = IoAllocateWorkItem(DeviceObject);
        if ( v8 )
        {
          IoQueueWorkItem(v8, (PIO_WORKITEM_ROUTINE)HumSetIdleWorker, CriticalWorkQueue, v8);
        }
        else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LOBYTE(v9) = 2;
          WPP_RECORDER_SF_(
            WPP_GLOBAL_Control->DeviceExtension,
            v9,
            4,
            17,
            (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids);
        }
      }
    }
  }
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v6 + 104), Tag, 0x20u);
  return 0i64;
}
// 1C0002A1A: variable 'v9' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0002B90) ----------------------------------------------------
__int64 __fastcall HumReadCompletion(__int64 a1, __int64 a2, unsigned int *a3)
{
  int v4; // edx
  unsigned int v5; // er14
  __int64 v8; // rdi
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // r9
  unsigned __int8 v11; // dl
  int v13; // [rsp+30h] [rbp-28h]

  v4 = *(_DWORD *)(a2 + 48);
  v5 = 0;
  v8 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( v4 >= 0 )
  {
    *(_QWORD *)(a2 + 56) = a3[9];
    goto LABEL_14;
  }
  if ( v4 == -1073741536 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v9 = WPP_GLOBAL_Control;
      if ( LOWORD(WPP_GLOBAL_Control->DeviceType) )
      {
        v13 = -1073741536;
        v10 = 23;
        v11 = 5;
LABEL_13:
        WPP_RECORDER_SF_qd(
          (__int64)v9->DeviceExtension,
          v11,
          2u,
          v10,
          (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
          a2,
          v13);
        goto LABEL_14;
      }
    }
  }
  else
  {
    if ( v4 == -1073741667 )
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_14;
      v9 = WPP_GLOBAL_Control;
      v10 = 25;
      v13 = -1073741667;
      v11 = 3;
      goto LABEL_13;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_qd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        3u,
        2u,
        0x18u,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        a2,
        v4);
    v5 = HumQueueResetWorkItem(a1, a2);
  }
LABEL_14:
  ExFreePool(a3);
  if ( _InterlockedDecrement((volatile signed __int32 *)(v8 + 32)) < 0 )
    KeSetEvent((PRKEVENT)(v8 + 40), 0, 0);
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v8 + 104), (PVOID)a2, 0x20u);
  return v5;
}
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0002D20) ----------------------------------------------------
__int64 __fastcall HumPnpCompletion(PDEVICE_OBJECT DeviceObject, PIRP Irp, PVOID Context)
{
  KeSetEvent((PRKEVENT)Context, 1, 0);
  return 3221225494i64;
}

//----- (00000001C0002D50) ----------------------------------------------------
__int64 __fastcall HumWriteCompletion(__int64 a1, __int64 a2, unsigned int *a3)
{
  __int64 v4; // rdi

  v4 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( *(int *)(a2 + 48) >= 0 )
    *(_QWORD *)(a2 + 56) = a3[9];
  ExFreePool(a3);
  if ( *(_BYTE *)(a2 + 65) )
    *(_BYTE *)(*(_QWORD *)(a2 + 184) + 3i64) |= 1u;
  if ( _InterlockedDecrement((volatile signed __int32 *)(v4 + 32)) < 0 )
    KeSetEvent((PRKEVENT)(v4 + 40), 0, 0);
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v4 + 104), (PVOID)a2, 0x20u);
  return 0i64;
}

//----- (00000001C0002DE0) ----------------------------------------------------
__int64 __fastcall HumInitDevice(PDEVICE_OBJECT DeviceObject)
{
  PVOID v1; // rax
  int *v3; // rsi
  int v4; // ebx
  __int64 result; // rax
  struct _USB_CONFIGURATION_DESCRIPTOR *v6; // r15
  PUSB_CONFIGURATION_DESCRIPTOR v7; // rdx
  struct _USB_CONFIGURATION_DESCRIPTOR *v8; // rcx
  __int64 v9; // r14
  PUSB_INTERFACE_DESCRIPTOR v10; // rax
  int v11; // edx
  bool v12; // zf
  PUSB_CONFIGURATION_DESCRIPTOR v13; // rax
  int v14; // er9
  const CHAR *v15; // rdx
  int *v16; // rax
  __int64 v17; // r8
  __int64 v18; // r9
  const CHAR *v19; // rdx
  __int64 v20; // r8
  __int64 v21; // r9
  int v22; // [rsp+40h] [rbp-39h] BYREF
  PUSB_CONFIGURATION_DESCRIPTOR ConfigurationDescriptor; // [rsp+48h] [rbp-31h] BYREF
  struct _EVENT_DATA_DESCRIPTOR v24; // [rsp+50h] [rbp-29h] BYREF
  PUSB_CONFIGURATION_DESCRIPTOR *v25; // [rsp+70h] [rbp-9h]
  __int64 v26; // [rsp+78h] [rbp-1h]
  int *v27; // [rsp+80h] [rbp+7h]
  __int64 v28; // [rsp+88h] [rbp+Fh]
  char v29[16]; // [rsp+90h] [rbp+17h] BYREF

  v1 = DeviceObject->DeviceExtension;
  ConfigurationDescriptor = 0i64;
  v22 = 0;
  v3 = (int *)*((_QWORD *)v1 + 2);
  v4 = HumGetDeviceDescriptor(DeviceObject, (__int64)v3);
  if ( v4 < 0 )
  {
    if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
      return (unsigned int)v4;
    v19 = "PNP_DeviceDesc";
    goto LABEL_38;
  }
  result = HumGetConfigDescriptor(DeviceObject, &ConfigurationDescriptor, &v22);
  v4 = result;
  if ( (int)result >= 0 )
  {
    v4 = 0;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        5,
        5,
        10,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    v6 = ConfigurationDescriptor;
    v7 = ConfigurationDescriptor;
    v8 = ConfigurationDescriptor;
    v9 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
    *(_QWORD *)(v9 + 80) = 0i64;
    *(_BYTE *)(v9 + 88) = 0;
    v10 = USBD_ParseConfigurationDescriptorEx(v8, v7, -1, -1, 3, -1, -1);
    if ( v10 )
    {
      v12 = v10->bInterfaceClass == 3;
      ConfigurationDescriptor = 0i64;
      if ( v12 )
      {
        HumParseHidInterface(v9, (char *)v10, v22 + (_DWORD)v6 - (_DWORD)v10, (char **)&ConfigurationDescriptor);
        v13 = ConfigurationDescriptor;
        if ( ConfigurationDescriptor )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LOBYTE(v11) = 4;
            WPP_RECORDER_SF_(
              WPP_GLOBAL_Control->DeviceExtension,
              v11,
              5,
              11,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
            v13 = ConfigurationDescriptor;
          }
          *(_QWORD *)(v9 + 80) = *(_QWORD *)&v13->bLength;
          *(_BYTE *)(v9 + 88) = v13->MaxPower;
LABEL_18:
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
            WPP_RECORDER_SF_(
              WPP_GLOBAL_Control->DeviceExtension,
              5,
              5,
              14,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
          if ( v4 < 0 )
          {
            if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
              goto LABEL_31;
            LODWORD(ConfigurationDescriptor) = v4;
            v25 = &ConfigurationDescriptor;
            v15 = "PNP_HIDInfo";
            v22 = *v3;
            v16 = &v22;
          }
          else
          {
            v4 = HumSelectConfiguration(DeviceObject, v6);
            if ( v4 >= 0 )
            {
              HumSetIdle(DeviceObject);
LABEL_31:
              ExFreePool(v6);
              return (unsigned int)v4;
            }
            if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
              goto LABEL_31;
            v22 = v4;
            v25 = (PUSB_CONFIGURATION_DESCRIPTOR *)&v22;
            v15 = "PNP_Configuration";
            LODWORD(ConfigurationDescriptor) = *v3;
            v16 = (int *)&ConfigurationDescriptor;
          }
          v26 = 4i64;
          v27 = v16;
          v28 = 4i64;
          tlgCreate1Sz_char((__int64)v29, v15);
          tlgWriteTransfer_EtwWriteTransfer((__int64)&v24, (unsigned __int8 *)dword_1C00077EF, v17, v18, 5u, &v24);
          goto LABEL_31;
        }
      }
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v14 = 12;
LABEL_16:
        LOBYTE(v11) = 3;
        WPP_RECORDER_SF_(
          WPP_GLOBAL_Control->DeviceExtension,
          v11,
          5,
          v14,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
        goto LABEL_17;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v14 = 13;
      goto LABEL_16;
    }
LABEL_17:
    v4 = -1073741823;
    goto LABEL_18;
  }
  if ( (unsigned int)dword_1C0009010 <= 5 )
    return result;
  if ( tlgKeywordOn() )
  {
    v19 = "PNP_ConfigDesc";
LABEL_38:
    v25 = &ConfigurationDescriptor;
    v22 = *v3;
    LODWORD(ConfigurationDescriptor) = v4;
    v26 = 4i64;
    v27 = &v22;
    v28 = 4i64;
    tlgCreate1Sz_char((__int64)v29, v19);
    tlgWriteTransfer_EtwWriteTransfer((__int64)&v24, (unsigned __int8 *)dword_1C00077EF, v20, v21, 5u, &v24);
  }
  return (unsigned int)v4;
}
// 1C0002F49: variable 'v11' is possibly undefined
// 1C00030B6: variable 'v17' is possibly undefined
// 1C00030B6: variable 'v18' is possibly undefined
// 1C0003154: variable 'v20' is possibly undefined
// 1C0003154: variable 'v21' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C0009010: using guessed type int dword_1C0009010;

//----- (00000001C0003180) ----------------------------------------------------
__int64 __fastcall HumSetIdle(PDEVICE_OBJECT DeviceObject)
{
  __int64 v2; // rbx
  _WORD *v3; // rax
  ULONG_PTR v4; // rdi
  int v5; // ecx
  __int16 v6; // ax
  unsigned int v7; // ebx

  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      91,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  v2 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  if ( v2 )
  {
    v3 = (_WORD *)ExAllocatePool2(64i64, 136i64, 1432643912i64);
    v4 = (ULONG_PTR)v3;
    if ( v3 )
    {
      v5 = *(_DWORD *)(v2 + 64);
      *v3 = 136;
      if ( _bittest(&v5, 0) )
      {
        v3[1] = 28;
        v6 = 0;
      }
      else
      {
        v3[1] = 27;
        v6 = *(unsigned __int8 *)(*(_QWORD *)(v2 + 16) + 2i64);
      }
      *(_WORD *)(v4 + 132) = v6;
      *(_DWORD *)(v4 + 128) = 2594;
      *(_QWORD *)(v4 + 32) = 0i64;
      *(_QWORD *)(v4 + 40) = 0i64;
      v7 = HumCallUSB(DeviceObject, v4);
      ExFreePool((PVOID)v4);
    }
    else
    {
      v7 = -1073741801;
    }
  }
  else
  {
    v7 = -1073741275;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      92,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  return v7;
}
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C00032F0) ----------------------------------------------------
__int64 __fastcall HumSelectConfiguration(PDEVICE_OBJECT DeviceObject, PUSB_CONFIGURATION_DESCRIPTOR ConfigurationDescriptor)
{
  unsigned __int16 *v3; // rdi
  __int64 v5; // rbp
  int v6; // edx
  PURB v7; // rax
  int v8; // edx
  _QWORD *v9; // rsi
  int v10; // eax
  int v11; // edx
  int v12; // ebx
  void *v13; // rax
  int v14; // edx
  struct _USBD_INTERFACE_LIST_ENTRY InterfaceList; // [rsp+40h] [rbp-38h] BYREF
  __int64 v17; // [rsp+50h] [rbp-28h]

  v3 = 0i64;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      69,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  v5 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  InterfaceList.InterfaceDescriptor = USBD_ParseConfigurationDescriptorEx(
                                        ConfigurationDescriptor,
                                        ConfigurationDescriptor,
                                        -1,
                                        -1,
                                        3,
                                        -1,
                                        -1);
  v17 = 0i64;
  if ( InterfaceList.InterfaceDescriptor )
  {
    v7 = USBD_CreateConfigurationRequestEx(ConfigurationDescriptor, &InterfaceList);
    v9 = &v7->UrbHeader.Length;
    if ( v7 )
    {
      v10 = HumCallUSB(DeviceObject, (ULONG_PTR)v7);
      v12 = v10;
      if ( v10 < 0 )
      {
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LOBYTE(v11) = 2;
          WPP_RECORDER_SF_d(
            WPP_GLOBAL_Control->DeviceExtension,
            v11,
            5,
            71,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
            v10);
        }
        *(_QWORD *)(v5 + 24) = 0i64;
      }
      else
      {
        v3 = (unsigned __int16 *)(v9 + 5);
        *(_QWORD *)(v5 + 24) = v9[4];
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LOBYTE(v11) = 4;
          WPP_RECORDER_SF_q(
            WPP_GLOBAL_Control->DeviceExtension,
            v11,
            5,
            70,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
            (_BYTE)v9 + 40);
        }
      }
      if ( v12 >= 0 )
      {
        v13 = (void *)ExAllocatePool2(64i64, *v3, 1432643912i64);
        *(_QWORD *)(v5 + 16) = v13;
        if ( v13 )
        {
          memmove(v13, v3, *v3);
          ExFreePool(v9);
          goto LABEL_24;
        }
        v12 = -1073741801;
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LOBYTE(v14) = 2;
          WPP_RECORDER_SF_d(
            WPP_GLOBAL_Control->DeviceExtension,
            v14,
            5,
            89,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
            23);
        }
      }
      ExFreePool(v9);
      goto LABEL_24;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v8) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v8,
        5,
        72,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    }
    v12 = -1073741801;
  }
  else
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v6) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v6,
        5,
        73,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    }
    v12 = -1073741811;
  }
LABEL_24:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      90,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  return (unsigned int)v12;
}
// 1C000340E: variable 'v11' is possibly undefined
// 1C00034BF: variable 'v14' is possibly undefined
// 1C00034FA: variable 'v8' is possibly undefined
// 1C000352B: variable 'v6' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C00035A0) ----------------------------------------------------
__int64 __fastcall HumGetDeviceDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2)
{
  int v4; // eax
  int v5; // edx
  unsigned int v6; // esi
  int v8; // [rsp+28h] [rbp-30h]
  __int64 v9; // [rsp+28h] [rbp-30h]
  __int64 v10; // [rsp+28h] [rbp-30h]
  __int64 v11; // [rsp+28h] [rbp-30h]
  __int64 v12; // [rsp+28h] [rbp-30h]
  __int64 v13; // [rsp+28h] [rbp-30h]
  __int64 v14; // [rsp+28h] [rbp-30h]
  __int64 v15; // [rsp+28h] [rbp-30h]
  __int64 v16; // [rsp+28h] [rbp-30h]
  __int64 v17; // [rsp+68h] [rbp+10h] BYREF

  LODWORD(v17) = 18;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      15,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  v4 = HumGetDescriptorRequest(DeviceObject, 11, 1, (void **)(a2 + 8), (__int64)&v17, v8, 0, 0);
  v6 = v4;
  if ( v4 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LOBYTE(v5) = 2;
    WPP_RECORDER_SF_d(
      WPP_GLOBAL_Control->DeviceExtension,
      v5,
      5,
      25,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v4);
  }
  else
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LOBYTE(v5) = 4;
    WPP_RECORDER_SF_q(
      WPP_GLOBAL_Control->DeviceExtension,
      v5,
      5,
      16,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      a2);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v9) = **(unsigned __int8 **)(a2 + 8);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x11u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v9);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v10) = *(unsigned __int8 *)(*(_QWORD *)(a2 + 8) + 1i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x12u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v10);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v11) = *(unsigned __int8 *)(*(_QWORD *)(a2 + 8) + 4i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x13u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v11);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v12) = *(unsigned __int8 *)(*(_QWORD *)(a2 + 8) + 5i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x14u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v12);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v13) = *(unsigned __int8 *)(*(_QWORD *)(a2 + 8) + 6i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x15u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v13);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v14) = *(unsigned __int16 *)(*(_QWORD *)(a2 + 8) + 8i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x16u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v14);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v15) = *(unsigned __int16 *)(*(_QWORD *)(a2 + 8) + 10i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x17u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v15);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return v6;
    LODWORD(v16) = *(unsigned __int16 *)(*(_QWORD *)(a2 + 8) + 12i64);
    WPP_RECORDER_SF_D(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      5u,
      0x18u,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v16);
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      26,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  return v6;
}
// 1C0003627: variable 'v8' is possibly undefined
// 1C0003664: variable 'v5' is possibly undefined
// 1C000369D: variable 'v9' is possibly undefined
// 1C00036D7: variable 'v10' is possibly undefined
// 1C0003711: variable 'v11' is possibly undefined
// 1C000374B: variable 'v12' is possibly undefined
// 1C0003785: variable 'v13' is possibly undefined
// 1C00037BF: variable 'v14' is possibly undefined
// 1C00037F9: variable 'v15' is possibly undefined
// 1C0003833: variable 'v16' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00038C0) ----------------------------------------------------
__int64 __fastcall HumGetConfigDescriptor(PDEVICE_OBJECT DeviceObject, _QWORD *a2, _DWORD *a3)
{
  int v3; // ebp
  int v7; // eax
  int v8; // edx
  unsigned int v9; // er14
  int v10; // er9
  unsigned int v11; // esi
  int v12; // edx
  __int64 result; // rax
  int v14; // eax
  unsigned __int8 *v15; // rdi
  int v16; // [rsp+28h] [rbp-50h]
  int v17; // [rsp+28h] [rbp-50h]
  char v18; // [rsp+28h] [rbp-50h]
  __int64 v19; // [rsp+28h] [rbp-50h]
  __int64 v20; // [rsp+28h] [rbp-50h]
  __int64 v21; // [rsp+28h] [rbp-50h]
  __int64 v22; // [rsp+28h] [rbp-50h]
  __int64 v23; // [rsp+28h] [rbp-50h]
  __int64 v24; // [rsp+28h] [rbp-50h]
  __int64 v25; // [rsp+28h] [rbp-50h]
  __int64 v26; // [rsp+28h] [rbp-50h]
  PVOID P[2]; // [rsp+40h] [rbp-38h] BYREF
  __int64 v28; // [rsp+98h] [rbp+20h] BYREF

  v3 = 0;
  LODWORD(v28) = 9;
  P[0] = 0i64;
  v7 = HumGetDescriptorRequest(DeviceObject, 11, 2, P, (__int64)&v28, v16, 0, 0);
  v9 = v7;
  if ( v7 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v8) = 2;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v8,
        5,
        41,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v7);
    }
    goto LABEL_36;
  }
  if ( (unsigned int)v28 < 9 )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return 3221225628i64;
    v10 = 27;
    v18 = v28;
LABEL_29:
    LOBYTE(v8) = 2;
    WPP_RECORDER_SF_d(
      WPP_GLOBAL_Control->DeviceExtension,
      v8,
      5,
      v10,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      v18);
    return 3221225628i64;
  }
  v11 = *((unsigned __int16 *)P[0] + 1);
  ExFreePool(P[0]);
  if ( !v11 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v12) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v12,
        5,
        28,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
      return 3221225628i64;
    }
    return 3221225628i64;
  }
  P[0] = 0i64;
  LODWORD(v28) = v11;
  v14 = HumGetDescriptorRequest(DeviceObject, 11, 2, P, (__int64)&v28, v17, 0, 0);
  v9 = v14;
  if ( v14 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v8) = 2;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v8,
        5,
        40,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v14);
    }
    v3 = v28;
LABEL_36:
    v15 = (unsigned __int8 *)P[0];
    goto LABEL_37;
  }
  v3 = v28;
  if ( (unsigned int)v28 < 9 )
  {
    if ( P[0] )
      ExFreePool(P[0]);
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return 3221225628i64;
    v10 = 29;
    v18 = v11;
    goto LABEL_29;
  }
  v15 = (unsigned __int8 *)P[0];
  if ( *((unsigned __int16 *)P[0] + 1) > v11 )
    *((_WORD *)P[0] + 1) = v11;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LOBYTE(v8) = 4;
    WPP_RECORDER_SF_q(
      WPP_GLOBAL_Control->DeviceExtension,
      v8,
      5,
      30,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
      (char)v15);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v19) = *v15;
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        5u,
        0x1Fu,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v19);
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v20) = v15[1];
        WPP_RECORDER_SF_D(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          5u,
          0x20u,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          v20);
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LODWORD(v21) = *((unsigned __int16 *)v15 + 1);
          WPP_RECORDER_SF_D(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            4u,
            5u,
            0x21u,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
            v21);
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LODWORD(v22) = v15[4];
            WPP_RECORDER_SF_D(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              4u,
              5u,
              0x22u,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
              v22);
            if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            {
              LODWORD(v23) = v15[5];
              WPP_RECORDER_SF_D(
                (__int64)WPP_GLOBAL_Control->DeviceExtension,
                4u,
                5u,
                0x23u,
                (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                v23);
              if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
              {
                LODWORD(v24) = v15[6];
                WPP_RECORDER_SF_D(
                  (__int64)WPP_GLOBAL_Control->DeviceExtension,
                  4u,
                  5u,
                  0x24u,
                  (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                  v24);
                if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
                {
                  LODWORD(v25) = v15[7];
                  WPP_RECORDER_SF_D(
                    (__int64)WPP_GLOBAL_Control->DeviceExtension,
                    4u,
                    5u,
                    0x25u,
                    (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                    v25);
                  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
                  {
                    LODWORD(v26) = v15[8];
                    WPP_RECORDER_SF_D(
                      (__int64)WPP_GLOBAL_Control->DeviceExtension,
                      4u,
                      5u,
                      0x26u,
                      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                      v26);
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if ( *v15 < 9u )
  {
    *v15 = 9;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v8) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v8,
        5,
        39,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    }
  }
LABEL_37:
  *a2 = v15;
  result = v9;
  *a3 = v3;
  return result;
}
// 1C0003908: variable 'v16' is possibly undefined
// 1C0003993: variable 'v12' is possibly undefined
// 1C00039D4: variable 'v17' is possibly undefined
// 1C0003A41: variable 'v8' is possibly undefined
// 1C0003A76: variable 'v19' is possibly undefined
// 1C0003AAC: variable 'v20' is possibly undefined
// 1C0003AE2: variable 'v21' is possibly undefined
// 1C0003B18: variable 'v22' is possibly undefined
// 1C0003B4E: variable 'v23' is possibly undefined
// 1C0003B84: variable 'v24' is possibly undefined
// 1C0003BB6: variable 'v25' is possibly undefined
// 1C0003BE8: variable 'v26' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0003D40) ----------------------------------------------------
__int64 __fastcall HumParseHidInterface(__int64 a1, char *a2, unsigned int a3, char **a4)
{
  unsigned int v4; // er14
  int v8; // er15
  const CHAR *v9; // rdx
  int v10; // eax
  int v11; // er9
  int v12; // edi
  unsigned int v13; // eax
  char *v14; // rbx
  __int64 v15; // rax
  char v16; // al
  unsigned __int8 v17; // cl
  __int64 v18; // r8
  __int64 v19; // r9
  __int64 v20; // r8
  __int64 v21; // r9
  __int64 v22; // r8
  __int64 v23; // r9
  int v24; // er9
  char v26; // [rsp+30h] [rbp-41h]
  __int64 v27; // [rsp+30h] [rbp-41h]
  __int64 v28; // [rsp+30h] [rbp-41h]
  __int64 v29; // [rsp+30h] [rbp-41h]
  __int64 v30; // [rsp+30h] [rbp-41h]
  __int64 v31; // [rsp+30h] [rbp-41h]
  __int64 v32; // [rsp+30h] [rbp-41h]
  __int64 v33; // [rsp+30h] [rbp-41h]
  int v34; // [rsp+38h] [rbp-39h] BYREF
  char *v35; // [rsp+40h] [rbp-31h]
  struct _EVENT_DATA_DESCRIPTOR v36; // [rsp+48h] [rbp-29h] BYREF
  int *v37; // [rsp+68h] [rbp-9h]
  __int64 v38; // [rsp+70h] [rbp-1h]
  char v39[16]; // [rsp+78h] [rbp+7h] BYREF

  v4 = 0;
  v8 = 0;
  v35 = a2;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      42,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
    a2 = v35;
  }
  *a4 = 0i64;
  if ( a3 < 9 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(a2) = 3;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        (_DWORD)a2,
        5,
        43,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        a3);
    }
    if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
    {
      v9 = "USB_DescriptorOverflow";
LABEL_91:
      v38 = 4i64;
      v37 = &v34;
      v34 = -1073741823;
      tlgCreate1Sz_char((__int64)v39, v9);
      tlgWriteTransfer_EtwWriteTransfer((__int64)&v36, (unsigned __int8 *)dword_1C00077B9, v22, v23, 4u, &v36);
      goto LABEL_92;
    }
    goto LABEL_92;
  }
  v10 = (unsigned __int8)*a2;
  if ( (unsigned __int8)v10 < 9u )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v11 = 44;
      v26 = *a2;
LABEL_87:
      LOBYTE(a2) = 2;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        (_DWORD)a2,
        5,
        v11,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v26);
      goto LABEL_88;
    }
    goto LABEL_88;
  }
  v12 = a3 - v10;
  if ( (unsigned int)v12 < 2 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(a2) = 3;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        (_DWORD)a2,
        5,
        45,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        v12);
    }
    goto LABEL_88;
  }
  v13 = *(_DWORD *)(a1 + 64) & 0xFFFFFFFE;
  *(_DWORD *)(a1 + 64) = v13;
  v14 = &a2[(unsigned __int8)*a2];
  if ( (unsigned __int8)*v14 < 2u )
  {
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_88;
    v11 = 46;
LABEL_86:
    v26 = *v14;
    goto LABEL_87;
  }
  if ( v14[1] == 33 )
  {
    if ( *v14 != 9 )
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_88;
      v11 = 48;
      goto LABEL_86;
    }
    *a4 = v14;
    v15 = (unsigned __int8)*v14;
    v12 -= v15;
    if ( v12 < 0 )
    {
      *a4 = 0i64;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(a2) = 3;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          (_DWORD)a2,
          5,
          47,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          v12);
      }
      goto LABEL_88;
    }
    v14 += v15;
  }
  else
  {
    *(_DWORD *)(a1 + 64) = v13 | 1;
  }
  LODWORD(a2) = (unsigned __int8)a2[4];
  if ( (_DWORD)a2 )
  {
    while ( (unsigned int)v12 >= 2 )
    {
      v16 = v14[1];
      if ( v16 == 5 )
      {
        if ( *v14 != 7 )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LOBYTE(a2) = 2;
            WPP_RECORDER_SF_d(
              WPP_GLOBAL_Control->DeviceExtension,
              (_DWORD)a2,
              5,
              50,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
              *v14);
          }
          if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
          {
            v9 = "USB_DescriptorEndpoint";
            goto LABEL_91;
          }
          goto LABEL_92;
        }
        v17 = *v14;
        ++v8;
      }
      else
      {
        if ( v16 == 4 )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LOBYTE(a2) = 2;
            WPP_RECORDER_SF_(
              WPP_GLOBAL_Control->DeviceExtension,
              (_DWORD)a2,
              5,
              51,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
          }
          if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
          {
            v9 = "USB_DescriptorEndpoint";
            goto LABEL_91;
          }
          goto LABEL_92;
        }
        v17 = *v14;
        if ( !*v14 )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LOBYTE(a2) = 2;
            WPP_RECORDER_SF_d(
              WPP_GLOBAL_Control->DeviceExtension,
              (_DWORD)a2,
              5,
              52,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
              0);
          }
          if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
          {
            v34 = -1073741823;
            v37 = &v34;
            v38 = 4i64;
            tlgCreate1Sz_char((__int64)v39, "USB_DescriptorLength");
            tlgWriteTransfer_EtwWriteTransfer((__int64)&v36, (unsigned __int8 *)dword_1C00077B9, v18, v19, 4u, &v36);
          }
          goto LABEL_92;
        }
      }
      v12 -= v17;
      if ( v12 < 0 )
      {
        if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_88;
        v11 = 53;
        v26 = v12;
        goto LABEL_87;
      }
      v14 += v17;
      if ( v8 == (_DWORD)a2 )
        goto LABEL_35;
    }
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      goto LABEL_88;
    v11 = 49;
    v26 = v12;
    goto LABEL_87;
  }
LABEL_35:
  if ( (*(_DWORD *)(a1 + 64) & 1) == 0 )
  {
LABEL_74:
    if ( !*a4 )
      goto LABEL_93;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(a2) = 4;
      WPP_RECORDER_SF_q(
        WPP_GLOBAL_Control->DeviceExtension,
        (_DWORD)a2,
        5,
        58,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
        (char)*a4);
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v27) = (unsigned __int8)**a4;
        WPP_RECORDER_SF_D(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          4u,
          5u,
          0x3Bu,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          v27);
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LODWORD(v28) = (unsigned __int8)(*a4)[1];
          WPP_RECORDER_SF_D(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            4u,
            5u,
            0x3Cu,
            (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
            v28);
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LODWORD(v29) = *((unsigned __int16 *)*a4 + 1);
            WPP_RECORDER_SF_D(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              4u,
              5u,
              0x3Du,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
              v29);
            if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            {
              LODWORD(v30) = (unsigned __int8)(*a4)[4];
              WPP_RECORDER_SF_D(
                (__int64)WPP_GLOBAL_Control->DeviceExtension,
                4u,
                5u,
                0x3Eu,
                (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                v30);
              if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
              {
                LODWORD(v31) = (unsigned __int8)(*a4)[5];
                WPP_RECORDER_SF_D(
                  (__int64)WPP_GLOBAL_Control->DeviceExtension,
                  4u,
                  5u,
                  0x3Fu,
                  (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                  v31);
                if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
                {
                  LODWORD(v32) = (unsigned __int8)(*a4)[6];
                  WPP_RECORDER_SF_D(
                    (__int64)WPP_GLOBAL_Control->DeviceExtension,
                    4u,
                    5u,
                    0x40u,
                    (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                    v32);
                  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
                  {
                    LODWORD(v33) = *(unsigned __int16 *)(*a4 + 7);
                    WPP_RECORDER_SF_D(
                      (__int64)WPP_GLOBAL_Control->DeviceExtension,
                      4u,
                      5u,
                      0x41u,
                      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
                      v33);
                  }
                }
              }
            }
          }
        }
      }
    }
    goto LABEL_92;
  }
  if ( (unsigned int)v12 >= 2 )
  {
    if ( v14[1] != 33 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(a2) = 2;
        WPP_RECORDER_SF_(
          WPP_GLOBAL_Control->DeviceExtension,
          (_DWORD)a2,
          5,
          55,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
      }
      if ( *v14 != 9 )
      {
LABEL_66:
        if ( v12 < (unsigned __int8)*v14 )
        {
          if ( (unsigned int)v12 < 9 )
            *a4 = 0i64;
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
          {
            LOBYTE(a2) = 2;
            WPP_RECORDER_SF_d(
              WPP_GLOBAL_Control->DeviceExtension,
              (_DWORD)a2,
              5,
              57,
              (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
              v12);
          }
          if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
          {
            v34 = -1073741823;
            v37 = &v34;
            v38 = 4i64;
            tlgCreate1Sz_char((__int64)v39, "USB_DescriptorLength");
            tlgWriteTransfer_EtwWriteTransfer((__int64)&v36, (unsigned __int8 *)dword_1C00077B9, v20, v21, 4u, &v36);
          }
          goto LABEL_92;
        }
        goto LABEL_74;
      }
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(a2) = 2;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          (_DWORD)a2,
          5,
          56,
          (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids,
          9);
        *a4 = v14;
        goto LABEL_66;
      }
    }
    *a4 = v14;
    goto LABEL_66;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    v11 = 54;
    v26 = v12;
    goto LABEL_87;
  }
LABEL_88:
  if ( (unsigned int)dword_1C0009010 > 5 && tlgKeywordOn() )
  {
    v9 = "USB_DescriptorLength";
    goto LABEL_91;
  }
LABEL_92:
  if ( !*a4 )
  {
LABEL_93:
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v24 = 66;
LABEL_98:
      LOBYTE(a2) = 2;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        (_DWORD)a2,
        5,
        v24,
        (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
      goto LABEL_99;
    }
    goto LABEL_99;
  }
  if ( v8 != (unsigned __int8)v35[4] )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v24 = 67;
      goto LABEL_98;
    }
LABEL_99:
    v4 = -1073741823;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      5,
      5,
      68,
      (__int64)&WPP_22f9612a74bb302c47e3c2e818dbd68b_Traceguids);
  return v4;
}
// 1C0004085: variable 'v18' is possibly undefined
// 1C0004085: variable 'v19' is possibly undefined
// 1C0004179: variable 'a2' is possibly undefined
// 1C0004233: variable 'v20' is possibly undefined
// 1C0004233: variable 'v21' is possibly undefined
// 1C00042B8: variable 'v27' is possibly undefined
// 1C00042F2: variable 'v28' is possibly undefined
// 1C000432C: variable 'v29' is possibly undefined
// 1C0004366: variable 'v30' is possibly undefined
// 1C00043A0: variable 'v31' is possibly undefined
// 1C00043DA: variable 'v32' is possibly undefined
// 1C0004414: variable 'v33' is possibly undefined
// 1C000449F: variable 'v22' is possibly undefined
// 1C000449F: variable 'v23' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C0009010: using guessed type int dword_1C0009010;

//----- (00000001C0004590) ----------------------------------------------------
#error "1C000460D: call analysis failed (funcsize=52)"

//----- (00000001C0004640) ----------------------------------------------------
__int64 __fastcall HumAddDevice(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi
  __int64 v3; // rbx
  int v4; // edx

  v2 = a2;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(a2) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      a2,
      1,
      19,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
  }
  v3 = *(_QWORD *)(*(_QWORD *)(v2 + 64) + 16i64);
  *(_DWORD *)(v3 + 64) = 0;
  *(_DWORD *)(v3 + 32) = 0;
  KeInitializeEvent((PRKEVENT)(v3 + 40), NotificationEvent, 0);
  *(_QWORD *)(v3 + 72) = 0i64;
  *(_DWORD *)v3 = 0;
  *(_QWORD *)(v3 + 96) = v2;
  KeInitializeSpinLock((PKSPIN_LOCK)(v3 + 136));
  *(_QWORD *)(v3 + 144) = 0i64;
  IoInitializeRemoveLockEx((PIO_REMOVE_LOCK)(v3 + 104), 0x55646948u, 2u, 0, 0x20u);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(v4) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      v4,
      1,
      20,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
  }
  return 0i64;
}
// 1C0004732: variable 'v4' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0004760) ----------------------------------------------------
#error "1C00047F0: call analysis failed (funcsize=58)"

//----- (00000001C0004870) ----------------------------------------------------
void __fastcall HumCompleteDeviceResetNotificationIrp(__int64 a1, int a2)
{
  __int64 v4; // rbx
  __int64 v5; // rbp
  KIRQL v6; // al
  __int64 v7; // rdx
  __int64 v8; // r8
  __int64 v9; // r9
  int v10; // [rsp+20h] [rbp-38h]

  v4 = 0i64;
  v5 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  v6 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(v5 + 136));
  if ( *(_QWORD *)(v5 + 144) )
  {
    v4 = *(_QWORD *)(v5 + 144);
    *(_QWORD *)(v5 + 144) = 0i64;
  }
  KeReleaseSpinLock((PKSPIN_LOCK)(v5 + 136), v6);
  if ( v4 )
  {
    _InterlockedExchange64((volatile __int64 *)(v4 + 104), 0i64);
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_qdq((__int64)WPP_GLOBAL_Control->DeviceExtension, v7, v8, v9, v10);
    *(_DWORD *)(v4 + 48) = a2;
    IofCompleteRequest((PIRP)v4, 0);
    IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), (PVOID)v4, 0x20u);
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    WPP_RECORDER_SF_dq(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      1u,
      0x15u,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
      a2,
      a1);
  }
}
// 1C000494D: variable 'v7' is possibly undefined
// 1C000494D: variable 'v8' is possibly undefined
// 1C000494D: variable 'v9' is possibly undefined
// 1C000494D: variable 'v10' is possibly undefined
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C00049A0) ----------------------------------------------------
void **__fastcall HumDeviceResetNotificationIrpCancelled(__int64 a1, IRP *a2)
{
  char v4; // si
  __int64 v5; // rdi
  KIRQL v6; // al
  void **result; // rax
  unsigned __int16 v8; // r9

  IoReleaseCancelSpinLock(a2->CancelIrql);
  v4 = 0;
  v5 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  v6 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(v5 + 136));
  if ( *(IRP **)(v5 + 144) == a2 )
  {
    *(_QWORD *)(v5 + 144) = 0i64;
    v4 = 1;
  }
  KeReleaseSpinLock((PKSPIN_LOCK)(v5 + 136), v6);
  if ( v4 )
  {
    a2->IoStatus.Information = 0i64;
    a2->IoStatus.Status = -1073741536;
    IofCompleteRequest(a2, 0);
    IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), a2, 0x20u);
    result = &WPP_RECORDER_INITIALIZED;
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return result;
    v8 = 23;
  }
  else
  {
    result = &WPP_RECORDER_INITIALIZED;
    if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
      return result;
    v8 = 24;
  }
  return (void **)WPP_RECORDER_SF_qq(
                    (__int64)WPP_GLOBAL_Control->DeviceExtension,
                    4u,
                    1u,
                    v8,
                    (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
                    a2,
                    a1);
}
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0004AD0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qdq(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-48h]
  __int64 v8; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  __int64 v10; // [rsp+A0h] [rbp+38h] BYREF
  va_list va1; // [rsp+A0h] [rbp+38h]
  va_list va2; // [rsp+A8h] [rbp+40h] BYREF

  va_start(va2, a5);
  va_start(va1, a5);
  va_start(va, a5);
  v8 = va_arg(va1, _QWORD);
  va_copy(va2, va1);
  v10 = va_arg(va2, _QWORD);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 1) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    ((void (__fastcall *)(_DEVICE_OBJECT *, __int64, void *, __int64, __int64 *, __int64, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
      22i64,
      (__int64 *)va,
      8i64,
      (__int64 *)va1,
      4i64,
      va2,
      8i64,
      0i64);
  LOWORD(v7) = 22;
  return WppAutoLogTrace(
           a1,
           4i64,
           1i64,
           &WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
           v7,
           (__int64 *)va,
           8i64,
           (__int64 *)va1,
           4i64,
           va2,
           8i64,
           0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0004BA2: variable 'v7' is possibly undefined
// 1C000B030: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C0004BC8) ----------------------------------------------------
_BOOL8 __fastcall WppIsEqualGuid(_DWORD *a1, _DWORD *a2)
{
  return *a1 == *a2 && a1[1] == a2[1] && a1[2] == a2[2] && a1[3] == a2[3];
}

//----- (00000001C0004BF8) ----------------------------------------------------
void tlgDefineProvider_annotation__Tlgg_TraceLoggingProviderProv()
{
  ;
}

//----- (00000001C0004C04) ----------------------------------------------------
__int64 __fastcall HumIncrementPendingRequestCount(__int64 a1)
{
  _InterlockedIncrement((volatile signed __int32 *)(a1 + 32));
  if ( (unsigned int)(*(_DWORD *)a1 - 1) <= 1 )
    return 0i64;
  HumDecrementPendingRequestCount(a1);
  return 3221225486i64;
}

//----- (00000001C0004C30) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qcc(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, ...)
{
  int v7; // [rsp+20h] [rbp-48h]
  __int64 v8; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  __int64 v10; // [rsp+A0h] [rbp+38h] BYREF
  va_list va1; // [rsp+A0h] [rbp+38h]
  va_list va2; // [rsp+A8h] [rbp+40h] BYREF

  va_start(va2, a5);
  va_start(va1, a5);
  va_start(va, a5);
  v8 = va_arg(va1, _QWORD);
  va_copy(va2, va1);
  v10 = va_arg(va2, _QWORD);
  if ( (HIDWORD(WPP_GLOBAL_Control->Timer) & 2) != 0 && BYTE1(WPP_GLOBAL_Control->Timer) >= 4u )
    ((void (__fastcall *)(_DEVICE_OBJECT *, __int64, void *, __int64, __int64 *, __int64, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
      WPP_GLOBAL_Control->AttachedDevice,
      43i64,
      &WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
      22i64,
      (__int64 *)va,
      8i64,
      (__int64 *)va1,
      1i64,
      va2,
      1i64,
      0i64);
  LOWORD(v7) = 22;
  return WppAutoLogTrace(
           a1,
           4i64,
           2i64,
           &WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
           v7,
           (__int64 *)va,
           8i64,
           (__int64 *)va1,
           1i64,
           va2,
           1i64,
           0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0004D02: variable 'v7' is possibly undefined
// 1C000B030: using guessed type __int64 __fastcall WppAutoLogTrace(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C0004D28) ----------------------------------------------------
#error "1C0004DD4: call analysis failed (funcsize=46)"

//----- (00000001C0004E4C) ----------------------------------------------------
__int64 __fastcall _GSHandlerCheckCommon(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  int v3; // edx

  result = *(_QWORD *)(a2 + 8);
  v3 = *(unsigned __int8 *)(*(unsigned int *)(*(_QWORD *)(a2 + 16) + 8i64) + result + 3);
  if ( (v3 & 0xF) != 0 )
    result = v3 & 0xFFFFFFF0;
  return result;
}

//----- (00000001C0004EC0) ----------------------------------------------------
__int64 _cpu_features_init()
{
  int v5; // er8
  char v7; // r9
  int v12; // er10

  _RAX = 0i64;
  __asm { cpuid }
  v5 = _RAX;
  _RAX = 1i64;
  v7 = 0;
  __asm { cpuid }
  v12 = _RCX;
  _RAX = 7i64;
  if ( v5 >= 7 )
  {
    v7 = 0;
    __asm { cpuid }
    LOBYTE(_RAX) = 2;
    if ( _bittest((const int *)&_RBX, 9u) )
      v7 = 2;
  }
  if ( _bittest(&v12, 0x14u) )
  {
    if ( _bittest(&v12, 0x1Bu) )
    {
      if ( _bittest(&v12, 0x1Cu) )
      {
        __asm { xgetbv }
        if ( (_RAX & 6) == 6 )
          v7 |= 4u;
      }
    }
  }
  _isa_info = v7 | 1;
  return 0i64;
}
// 1C00090C0: using guessed type char _isa_info;

//----- (00000001C0005000) ----------------------------------------------------
void *__cdecl memmove(void *a1, const void *Src, size_t Size)
{
  void *result; // rax
  __int64 v4; // r11
  __int64 v5; // rdx
  __int128 v6; // xmm1
  bool v7; // cf
  signed __int64 v8; // rdx
  char v9; // r11
  _BYTE *v10; // rcx
  char v11; // r11
  char *v12; // r11
  __m128 v14; // xmm0
  unsigned __int64 v16; // rcx
  __m128 v17; // xmm1
  unsigned __int64 v18; // r8
  unsigned __int64 v19; // r9
  __int128 v20; // xmm1
  __int128 v21; // xmm2
  __int128 v22; // xmm3
  __m128 v23; // xmm4
  unsigned __int64 j; // r9
  unsigned __int64 v25; // r8
  unsigned __int64 v26; // r9
  __m128 v27; // xmm1
  __m128 v28; // xmm2
  __m128 v29; // xmm3
  __m128 v30; // xmm4
  char *v31; // rcx
  __int128 v32; // xmm0
  unsigned __int64 v33; // rcx
  size_t v34; // r8
  _OWORD *v35; // r11
  __int128 v36; // xmm1
  size_t v37; // r9
  __int128 v38; // xmm1
  __int128 v39; // xmm2
  __int128 v40; // xmm3
  __int128 v41; // xmm4
  size_t i; // r9
  size_t v43; // r8

  result = a1;
  if ( Size < 8 )
  {
    if ( Size )
    {
      v7 = Src < a1;
      v8 = (_BYTE *)Src - (_BYTE *)a1;
      if ( v7 )
      {
        v10 = (char *)a1 + Size;
        do
        {
          v11 = v10[v8 - 1];
          --v10;
          --Size;
          *v10 = v11;
        }
        while ( Size );
      }
      else
      {
        do
        {
          v9 = *((_BYTE *)a1 + v8);
          a1 = (char *)a1 + 1;
          --Size;
          *((char *)a1 - 1) = v9;
        }
        while ( Size );
      }
    }
  }
  else if ( Size > 0x10 )
  {
    if ( Size > 0x20 )
    {
      v12 = (char *)Src + Size;
      v7 = Src < a1;
      _RDX = (_BYTE *)Src - (_BYTE *)a1;
      if ( v7 && v12 > a1 )
      {
        v31 = (char *)a1 + Size;
        v32 = *(_OWORD *)&v31[_RDX - 16];
        v33 = (unsigned __int64)(v31 - 16);
        v34 = Size - 16;
        if ( (v33 & 0xF) != 0 )
        {
          v35 = (_OWORD *)v33;
          v33 &= 0xFFFFFFFFFFFFFFF0ui64;
          v36 = *(_OWORD *)(v33 + _RDX);
          *v35 = v32;
          v32 = v36;
          v34 = v33 - (_QWORD)result;
        }
        v37 = v34 >> 6;
        if ( v34 >> 6 )
        {
          v34 &= 0x3Fu;
          do
          {
            v38 = *(_OWORD *)(v33 + _RDX - 16);
            v39 = *(_OWORD *)(v33 + _RDX - 32);
            v40 = *(_OWORD *)(v33 + _RDX - 48);
            v41 = *(_OWORD *)(v33 + _RDX - 64);
            *(_OWORD *)v33 = v32;
            v33 -= 64i64;
            --v37;
            *(_OWORD *)(v33 + 48) = v38;
            *(_OWORD *)(v33 + 32) = v39;
            *(_OWORD *)(v33 + 16) = v40;
            v32 = v41;
          }
          while ( v37 );
        }
        for ( i = v34 >> 4; i; --i )
        {
          *(_OWORD *)v33 = v32;
          v32 = *(_OWORD *)(v33 + _RDX - 16);
          v33 -= 16i64;
        }
        v43 = v34 & 0xF;
        if ( v43 )
          *(_OWORD *)(v33 - v43) = *(_OWORD *)(v33 - v43 + _RDX);
        *(_OWORD *)v33 = v32;
      }
      else
      {
        v14 = *(__m128 *)((char *)a1 + _RDX);
        _RCX = (unsigned __int64)a1 + 16;
        if ( (_RCX & 0xF) != 0 )
        {
          v16 = _RCX & 0xFFFFFFFFFFFFFFF0ui64;
          v17 = *(__m128 *)(v16 + _RDX);
          *(__m128 *)result = v14;
          v14 = v17;
          _RCX = v16 + 16;
        }
        v18 = (unsigned __int64)result + Size - _RCX;
        v19 = v18 >> 6;
        if ( v18 >> 6 )
        {
          if ( v19 > 0x1000 )
          {
            v26 = v18 >> 6;
            v18 &= 0x3Fu;
            __asm { prefetchnta byte ptr [rcx+rdx+40h] }
            do
            {
              v27 = *(__m128 *)(_RCX + _RDX);
              v28 = *(__m128 *)(_RCX + _RDX + 16);
              v29 = *(__m128 *)(_RCX + _RDX + 32);
              v30 = *(__m128 *)(_RCX + _RDX + 48);
              _mm_stream_ps((float *)(_RCX - 16), v14);
              _RCX += 64i64;
              __asm { prefetchnta byte ptr [rcx+rdx+40h] }
              --v26;
              _mm_stream_ps((float *)(_RCX - 64), v27);
              _mm_stream_ps((float *)(_RCX - 48), v28);
              _mm_stream_ps((float *)(_RCX - 32), v29);
              v14 = v30;
            }
            while ( v26 );
            _mm_sfence();
          }
          else
          {
            v18 &= 0x3Fu;
            do
            {
              v20 = *(_OWORD *)(_RCX + _RDX);
              v21 = *(_OWORD *)(_RCX + _RDX + 16);
              v22 = *(_OWORD *)(_RCX + _RDX + 32);
              v23 = *(__m128 *)(_RCX + _RDX + 48);
              *(__m128 *)(_RCX - 16) = v14;
              _RCX += 64i64;
              --v19;
              *(_OWORD *)(_RCX - 64) = v20;
              *(_OWORD *)(_RCX - 48) = v21;
              *(_OWORD *)(_RCX - 32) = v22;
              v14 = v23;
            }
            while ( v19 );
          }
        }
        for ( j = v18 >> 4; j; --j )
        {
          *(__m128 *)(_RCX - 16) = v14;
          v14 = *(__m128 *)(_RCX + _RDX);
          _RCX += 16i64;
        }
        v25 = v18 & 0xF;
        if ( v25 )
          *(_OWORD *)(_RCX + v25 - 16) = *(_OWORD *)(_RCX + v25 - 16 + _RDX);
        *(__m128 *)(_RCX - 16) = v14;
      }
    }
    else
    {
      v6 = *(_OWORD *)((char *)Src + Size - 16);
      *(_OWORD *)a1 = *(_OWORD *)Src;
      *(_OWORD *)((char *)a1 + Size - 16) = v6;
    }
  }
  else
  {
    v4 = *(_QWORD *)Src;
    v5 = *(_QWORD *)((char *)Src + Size - 8);
    *(_QWORD *)a1 = v4;
    *(_QWORD *)((char *)a1 + Size - 8) = v5;
  }
  return result;
}

//----- (00000001C0005300) ----------------------------------------------------
void *__cdecl memset(void *a1, int Val, size_t Size)
{
  void *result; // rax
  __int64 v4; // rdx
  __m128 v5; // xmm0
  char *v6; // r8
  __m128 *v7; // rdx
  _OWORD *v8; // r9
  size_t v9; // r8
  __m128 *v10; // r9
  size_t v11; // r8
  _DWORD *v12; // r9
  size_t v13; // r8

  result = a1;
  v4 = 0x101010101010101i64 * (unsigned __int8)Val;
  v5 = _mm_movelh_ps((__m128)(unsigned __int64)v4, (__m128)(unsigned __int64)v4);
  if ( Size >= 0x40 )
  {
    if ( (_isa_info & 2) != 0 && Size >= 0x320 )
      return (void *)_memset_repmovs(a1, v4, Size);
    *(__m128 *)a1 = v5;
    v6 = (char *)a1 + Size;
    a1 = (void *)(((unsigned __int64)a1 + 16) & 0xFFFFFFFFFFFFFFF0ui64);
    Size = v6 - (_BYTE *)a1;
    if ( Size >= 0x40 )
    {
      v7 = (__m128 *)((char *)a1 + Size - 16);
      v8 = (_OWORD *)(((unsigned __int64)a1 + Size - 48) & 0xFFFFFFFFFFFFFFF0ui64);
      v9 = Size >> 6;
      do
      {
        *(__m128 *)a1 = v5;
        *((__m128 *)a1 + 1) = v5;
        a1 = (char *)a1 + 64;
        --v9;
        *((__m128 *)a1 - 2) = v5;
        *((__m128 *)a1 - 1) = v5;
      }
      while ( v9 );
      *v8 = v5;
      v8[1] = v5;
      v8[2] = v5;
      *v7 = v5;
      return result;
    }
LABEL_9:
    v10 = (__m128 *)((char *)a1 + Size - 16);
    *(__m128 *)a1 = v5;
    v11 = (Size & 0x20) >> 1;
    *v10 = v5;
    *(__m128 *)((char *)a1 + v11) = v5;
    *(__m128 *)((char *)v10 - v11) = v5;
    return result;
  }
  if ( Size >= 0x10 )
    goto LABEL_9;
  if ( Size < 4 )
  {
    if ( Size )
    {
      *(_BYTE *)a1 = v4;
      if ( Size != 1 )
        *(_WORD *)((char *)a1 + Size - 2) = v4;
    }
  }
  else
  {
    v12 = (char *)a1 + Size - 4;
    *(_DWORD *)a1 = v4;
    v13 = (Size & 8) >> 1;
    *v12 = v4;
    *(_DWORD *)((char *)a1 + v13) = v4;
    *(_DWORD *)((char *)v12 - v13) = v4;
  }
  return result;
}
// 1C00090C0: using guessed type char _isa_info;

//----- (00000001C0005440) ----------------------------------------------------
__int64 __fastcall _memset_repmovs(_OWORD *a1, __int64 a2, __int64 a3)
{
  __int128 v3; // xmm0
  __int64 result; // rax

  if ( (_isa_info & 1) == 0 )
    _memset_query();
  *a1 = v3;
  a1[1] = v3;
  a1[2] = v3;
  a1[3] = v3;
  memset(
    (void *)((unsigned __int64)(a1 + 4) & 0xFFFFFFFFFFFFFFC0ui64),
    v3,
    (unsigned __int64)a1 + a3 - ((unsigned __int64)(a1 + 4) & 0xFFFFFFFFFFFFFFC0ui64));
  return result;
}
// 1C0005450: variable 'v3' is possibly undefined
// 1C0005450: variable 'a1' is possibly undefined
// 1C000544D: variable 'a3' is possibly undefined
// 1C00090C0: using guessed type char _isa_info;

//----- (00000001C00054C0) ----------------------------------------------------
void _memset_query()
{
  _cpu_features_init();
}

//----- (00000001C0005540) ----------------------------------------------------
void __fastcall _memset_spec_ermsb(char *a1, unsigned __int8 a2, unsigned __int64 a3)
{
  __int64 v3; // rdx
  __m128 v4; // xmm0
  char *v5; // r8
  __m128 *v6; // rdx
  _OWORD *v7; // r9
  unsigned __int64 v8; // r8
  __m128 *v9; // r9
  unsigned __int64 v10; // r8
  char *v11; // r9
  unsigned __int64 v12; // r8

  v3 = 0x101010101010101i64 * a2;
  v4 = _mm_movelh_ps((__m128)(unsigned __int64)v3, (__m128)(unsigned __int64)v3);
  if ( a3 >= 0x40 )
  {
    if ( a3 >= 0x320 )
    {
      _memset_spec_ermsb_repmovsb(a1, v3, a3);
      return;
    }
    *(__m128 *)a1 = v4;
    v5 = &a1[a3];
    a1 = (char *)((unsigned __int64)(a1 + 16) & 0xFFFFFFFFFFFFFFF0ui64);
    a3 = v5 - a1;
    if ( a3 >= 0x40 )
    {
      v6 = (__m128 *)&a1[a3 - 16];
      v7 = (_OWORD *)((unsigned __int64)&a1[a3 - 48] & 0xFFFFFFFFFFFFFFF0ui64);
      v8 = a3 >> 6;
      do
      {
        *(__m128 *)a1 = v4;
        *((__m128 *)a1 + 1) = v4;
        a1 += 64;
        --v8;
        *((__m128 *)a1 - 2) = v4;
        *((__m128 *)a1 - 1) = v4;
      }
      while ( v8 );
      *v7 = v4;
      v7[1] = v4;
      v7[2] = v4;
      *v6 = v4;
      return;
    }
LABEL_8:
    v9 = (__m128 *)&a1[a3 - 16];
    *(__m128 *)a1 = v4;
    v10 = (a3 & 0x20) >> 1;
    *v9 = v4;
    *(__m128 *)&a1[v10] = v4;
    *(__m128 *)((char *)v9 - v10) = v4;
    return;
  }
  if ( a3 >= 0x10 )
    goto LABEL_8;
  if ( a3 < 4 )
  {
    if ( a3 )
    {
      *a1 = v3;
      if ( a3 != 1 )
        *(_WORD *)&a1[a3 - 2] = v3;
    }
  }
  else
  {
    v11 = &a1[a3 - 4];
    *(_DWORD *)a1 = v3;
    v12 = (a3 & 8) >> 1;
    *(_DWORD *)v11 = v3;
    *(_DWORD *)&a1[v12] = v3;
    *(_DWORD *)&v11[-v12] = v3;
  }
}

//----- (00000001C0005680) ----------------------------------------------------
void __fastcall _memset_spec_ermsb_repmovsb(_OWORD *a1, __int64 a2, __int64 a3)
{
  __int128 v3; // xmm0

  *a1 = v3;
  a1[1] = v3;
  a1[2] = v3;
  a1[3] = v3;
  memset(
    (void *)((unsigned __int64)(a1 + 4) & 0xFFFFFFFFFFFFFFC0ui64),
    v3,
    (unsigned __int64)a1 + a3 - ((unsigned __int64)(a1 + 4) & 0xFFFFFFFFFFFFFFC0ui64));
}
// 1C0005687: variable 'v3' is possibly undefined

//----- (00000001C0005700) ----------------------------------------------------
_OWORD *__fastcall _memset_spec_plain(_OWORD *a1, unsigned __int8 a2, unsigned __int64 a3)
{
  _OWORD *result; // rax
  __int64 v4; // rdx
  __m128 v5; // xmm0
  char *v6; // r8
  __m128 *v7; // rdx
  _OWORD *v8; // r9
  unsigned __int64 v9; // r8
  __m128 *v10; // r9
  unsigned __int64 v11; // r8
  _DWORD *v12; // r9
  unsigned __int64 v13; // r8

  result = a1;
  v4 = 0x101010101010101i64 * a2;
  v5 = _mm_movelh_ps((__m128)(unsigned __int64)v4, (__m128)(unsigned __int64)v4);
  if ( a3 >= 0x40 )
  {
    *a1 = v5;
    v6 = (char *)a1 + a3;
    a1 = (_OWORD *)((unsigned __int64)(a1 + 1) & 0xFFFFFFFFFFFFFFF0ui64);
    a3 = v6 - (char *)a1;
    if ( a3 >= 0x40 )
    {
      v7 = (__m128 *)((char *)a1 + a3 - 16);
      v8 = (_OWORD *)(((unsigned __int64)a1 + a3 - 48) & 0xFFFFFFFFFFFFFFF0ui64);
      v9 = a3 >> 6;
      do
      {
        *a1 = v5;
        a1[1] = v5;
        a1 += 4;
        --v9;
        *(a1 - 2) = v5;
        *(a1 - 1) = v5;
      }
      while ( v9 );
      *v8 = v5;
      v8[1] = v5;
      v8[2] = v5;
      *v7 = v5;
      return result;
    }
LABEL_7:
    v10 = (__m128 *)((char *)a1 + a3 - 16);
    *a1 = v5;
    v11 = (a3 & 0x20) >> 1;
    *v10 = v5;
    *(__m128 *)((char *)a1 + v11) = v5;
    *(__m128 *)((char *)v10 - v11) = v5;
    return result;
  }
  if ( a3 >= 0x10 )
    goto LABEL_7;
  if ( a3 < 4 )
  {
    if ( a3 )
    {
      *(_BYTE *)a1 = v4;
      if ( a3 != 1 )
        *(_WORD *)((char *)a1 + a3 - 2) = v4;
    }
  }
  else
  {
    v12 = (_DWORD *)((char *)a1 + a3 - 4);
    *(_DWORD *)a1 = v4;
    v13 = (a3 & 8) >> 1;
    *v12 = v4;
    *(_DWORD *)((char *)a1 + v13) = v4;
    *(_DWORD *)((char *)v12 - v13) = v4;
  }
  return result;
}

//----- (00000001C0005A30) ----------------------------------------------------
__int64 __fastcall HumCreateClose(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi
  unsigned int v4; // ebx
  char v5; // cl
  unsigned __int16 v6; // r9
  int v7; // edx

  v2 = a2;
  v4 = 0;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(a2) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      a2,
      1,
      14,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
  }
  v5 = **(_BYTE **)(v2 + 184);
  if ( !v5 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v6 = 15;
      goto LABEL_13;
    }
LABEL_14:
    *(_QWORD *)(v2 + 56) = 0i64;
    goto LABEL_15;
  }
  if ( v5 == 2 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v6 = 16;
LABEL_13:
      WPP_RECORDER_SF_qq(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        1u,
        v6,
        (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
        v2,
        a1);
      goto LABEL_14;
    }
    goto LABEL_14;
  }
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_qq(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      4u,
      1u,
      0x11u,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
      v2,
      a1);
  v4 = -1073741811;
LABEL_15:
  *(_DWORD *)(v2 + 48) = v4;
  IofCompleteRequest((PIRP)v2, 0);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(v7) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      v7,
      1,
      18,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids);
  }
  return v4;
}
// 1C0005B67: variable 'v7' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005B90) ----------------------------------------------------
void __fastcall HumUnload(__int64 a1)
{
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_q(
      WPP_GLOBAL_Control->DeviceExtension,
      4,
      1,
      25,
      (__int64)&WPP_942e49b71fcd3dd08668400dfd38e524_Traceguids,
      a1);
  TraceLoggingUnregister_EtwUnregister();
  WppCleanupKm(a1);
}
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0005BF0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_dq(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v7; // rdi
  unsigned int v8; // esi
  int v10; // eax
  char *v11; // rcx
  int v13; // [rsp+20h] [rbp-48h]
  __int64 v14; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  va_list va1; // [rsp+A0h] [rbp+38h] BYREF

  va_start(va1, a5);
  va_start(va, a5);
  v14 = va_arg(va1, _QWORD);
  v7 = (unsigned __int64)a3 >> 16;
  v8 = a2;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v7 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, (a3 - 1) & 0x1F) )
  {
    v11 = (char *)WPP_GLOBAL_Control + 80 * v7;
    if ( (unsigned __int8)v11[41] >= a2 )
      ((void (__fastcall *)(_QWORD, __int64, __int64, _QWORD, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
        *((_QWORD *)v11 + 3),
        43i64,
        a5,
        a4,
        (__int64 *)va,
        4i64,
        va1,
        8i64,
        0i64);
  }
  LOWORD(v13) = a4;
  return WppAutoLogTrace(a1, v8, a3, a5, v13, (__int64 *)va, 4i64, va1, 8i64, 0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0005CFB: variable 'v13' is possibly undefined

//----- (00000001C0005D2C) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qq(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v7; // rdi
  unsigned int v8; // esi
  int v10; // eax
  char *v11; // rcx
  int v13; // [rsp+20h] [rbp-48h]
  __int64 v14; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  va_list va1; // [rsp+A0h] [rbp+38h] BYREF

  va_start(va1, a5);
  va_start(va, a5);
  v14 = va_arg(va1, _QWORD);
  v7 = (unsigned __int64)a3 >> 16;
  v8 = a2;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v7 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, (a3 - 1) & 0x1F) )
  {
    v11 = (char *)WPP_GLOBAL_Control + 80 * v7;
    if ( (unsigned __int8)v11[41] >= a2 )
      ((void (__fastcall *)(_QWORD, __int64, __int64, _QWORD, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
        *((_QWORD *)v11 + 3),
        43i64,
        a5,
        a4,
        (__int64 *)va,
        8i64,
        va1,
        8i64,
        0i64);
  }
  LOWORD(v13) = a4;
  return WppAutoLogTrace(a1, v8, a3, a5, v13, (__int64 *)va, 8i64, va1, 8i64, 0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C0005E37: variable 'v13' is possibly undefined

//----- (00000001C0005E70) ----------------------------------------------------
__int64 __fastcall WppClassicProviderCallback(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4)
{
  __int64 v4; // rdx
  __int64 result; // rax

  if ( a2 <= 1u )
  {
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      v4 = *a3;
      *(_QWORD *)(a4 + 24) = *a3;
      result = imp_WppRecorderReplay(WPP_GLOBAL_Control, v4, *((unsigned int *)a3 + 1), *((unsigned __int8 *)a3 + 2));
    }
    else
    {
      result = 0i64;
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
      *(_QWORD *)(a4 + 24) = 0i64;
    }
  }
  return result;
}
// 1C000B038: using guessed type __int64 __fastcall imp_WppRecorderReplay(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001C0005EE0) ----------------------------------------------------
void __fastcall HumSetIdleWorker(PDEVICE_OBJECT DeviceObject, PVOID Context)
{
  HumSetIdle(DeviceObject);
  IoFreeWorkItem((PIO_WORKITEM)Context);
}

//----- (00000001C0005F0C) ----------------------------------------------------
#error "1C0005FA0: call analysis failed (funcsize=36)"

//----- (00000001C0005FC0) ----------------------------------------------------
__int64 WPP_RECORDER_SF_qd(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v7; // rdi
  unsigned int v8; // esi
  int v10; // eax
  char *v11; // rcx
  int v13; // [rsp+20h] [rbp-48h]
  __int64 v14; // [rsp+98h] [rbp+30h] BYREF
  va_list va; // [rsp+98h] [rbp+30h]
  va_list va1; // [rsp+A0h] [rbp+38h] BYREF

  va_start(va1, a5);
  va_start(va, a5);
  v14 = va_arg(va1, _QWORD);
  v7 = (unsigned __int64)a3 >> 16;
  v8 = a2;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v7 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, (a3 - 1) & 0x1F) )
  {
    v11 = (char *)WPP_GLOBAL_Control + 80 * v7;
    if ( (unsigned __int8)v11[41] >= a2 )
      ((void (__fastcall *)(_QWORD, __int64, __int64, _QWORD, __int64 *, __int64, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
        *((_QWORD *)v11 + 3),
        43i64,
        a5,
        a4,
        (__int64 *)va,
        8i64,
        va1,
        4i64,
        0i64);
  }
  LOWORD(v13) = a4;
  return WppAutoLogTrace(a1, v8, a3, a5, v13, (__int64 *)va, 8i64, va1, 4i64, 0i64);
}
// 1C0009200: invalid function type has been ignored
// 1C00060CB: variable 'v13' is possibly undefined

//----- (00000001C00060FC) ----------------------------------------------------
__int64 __fastcall GetInterruptInputPipeForDevice(__int64 a1)
{
  __int64 v1; // r9
  __int64 v2; // rdx
  unsigned int v3; // er8
  __int64 v4; // rax

  v1 = *(_QWORD *)(a1 + 16);
  v2 = 0i64;
  v3 = *(_DWORD *)(v1 + 16);
  if ( !v3 )
    return 0i64;
  while ( 1 )
  {
    v4 = v1 + 24 * v2;
    if ( *(char *)(v4 + 26) < 0 && *(_DWORD *)(v4 + 28) == 3 )
      break;
    v2 = (unsigned int)(v2 + 1);
    if ( (unsigned int)v2 >= v3 )
      return 0i64;
  }
  return v4 + 24;
}

//----- (00000001C0006138) ----------------------------------------------------
LONG __fastcall HumDecrementPendingRequestCount(__int64 a1)
{
  LONG result; // eax

  result = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 32), 0xFFFFFFFF);
  if ( result - 1 < 0 )
    result = KeSetEvent((PRKEVENT)(a1 + 40), 0, 0);
  return result;
}

//----- (00000001C000616C) ----------------------------------------------------
NTSTATUS __fastcall HumGetPortStatus(__int64 a1, _DWORD *a2)
{
  PIRP v4; // rax
  NTSTATUS result; // eax
  _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-38h] BYREF
  struct _KEVENT Event; // [rsp+60h] [rbp-28h] BYREF

  Event.Header.WaitListHead.Blink = 0i64;
  *a2 = 0;
  *(_OWORD *)&Event.Header.Lock = 0i64;
  IoStatusBlock = 0i64;
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v4 = IoBuildDeviceIoControlRequest(
         0x220013u,
         *(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64),
         0i64,
         0,
         0i64,
         0,
         1u,
         &Event,
         &IoStatusBlock);
  if ( !v4 )
    return -1073741670;
  v4->Tail.Overlay.CurrentStackLocation[-1].Parameters.WMI.ProviderId = (ULONG_PTR)a2;
  result = IofCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), v4);
  if ( result == 259 )
  {
    KeWaitForSingleObject(&Event, Suspended, 0, 0, 0i64);
    result = IoStatusBlock.Status;
  }
  return result;
}

//----- (00000001C0006268) ----------------------------------------------------
NTSTATUS __fastcall HumGetSetReport(__int64 a1, IRP *a2, _BYTE *a3)
{
  _IO_STACK_LOCATION *v3; // r12
  __int16 v5; // r13
  NTSTATUS result; // eax
  int v7; // edi
  __int16 v8; // si
  char v9; // bp
  _DWORD *v10; // r14
  _WORD *v11; // rax
  _WORD *v12; // rbx
  __int16 v13; // si
  bool v14; // zf
  __int16 *v15; // rax
  _IO_STACK_LOCATION *v16; // rax
  __int64 v18; // [rsp+78h] [rbp+10h]

  v3 = a2->Tail.Overlay.CurrentStackLocation;
  v5 = 1;
  switch ( v3->Parameters.Read.ByteOffset.LowPart )
  {
    case 0xB0191u://IOCTL_HID_SET_FEATURE
      v8 = 768;
      goto LABEL_10;
    case 0xB0192u://IOCTL_HID_GET_FEATURE
      v7 = 1;
      v8 = 768;
      v9 = 1;
      goto LABEL_11;
    case 0xB0195u://IOCTL_HID_SET_OUTPUT_REPORT
      v8 = 512;
LABEL_10:
      v9 = 9;
      v7 = 0;
      goto LABEL_11;
  }
  if ( v3->Parameters.Read.ByteOffset.LowPart != 721314 )
    return -1073741637;
  v7 = 1;
  v8 = 256;
  v9 = 1;
LABEL_11:
  v10 = a2->UserBuffer;
  v18 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( !v10 || !*(_QWORD *)v10 || !v10[2] )
    return -1073741762;
  v11 = (_WORD *)ExAllocatePool2(64i64, 152i64, 1432643912i64);
  v12 = v11;
  if ( !v11 )
    return -1073741670;
  v13 = *((unsigned __int8 *)v10 + 12) + v8;
  v14 = (*(_DWORD *)(v18 + 64) & 1) == 0;
  *v11 = 136;
  v15 = v11 + 66;
  if ( v14 )
  {
    v12[1] = 27;
    v5 = *(unsigned __int8 *)(*(_QWORD *)(v18 + 16) + 2i64);
    v15 = v12 + 66;
  }
  else
  {
    v12[1] = 28;
  }
  *v15 = v5;
  *((_BYTE *)v12 + 128) = 34;
  *((_BYTE *)v12 + 129) = v9;
  v12[65] = v13;
  *((_DWORD *)v12 + 8) = v7;
  *((_QWORD *)v12 + 5) = *(_QWORD *)v10;
  *((_DWORD *)v12 + 9) = v10[2];
  v16 = a2->Tail.Overlay.CurrentStackLocation;
  v16[-1].CompletionRoutine = (PIO_COMPLETION_ROUTINE)HumGetSetReportCompletion;
  v16[-1].Context = v12;
  v16[-1].Control = -32;
  v3[-1].Parameters.WMI.ProviderId = (ULONG_PTR)v12;
  v3[-1].MajorFunction = v3->MajorFunction;
  v3[-1].Parameters.Read.ByteOffset.LowPart = 2228227;
  v3[-1].DeviceObject = *(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64);
  if ( (int)HumIncrementPendingRequestCount(v18) < 0 )
  {
    ExFreePool(v12);
    result = -1073741810;
  }
  else
  {
    result = IofCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), a2);
    *a3 = 0;
  }
  return result;
}
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0006480) ----------------------------------------------------
__int64 __fastcall HumGetSetReportCompletion(__int64 a1, __int64 a2, unsigned int *a3)
{
  __int64 v4; // rdi

  v4 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( *(int *)(a2 + 48) >= 0 )
    *(_QWORD *)(a2 + 56) = a3[9];
  ExFreePool(a3);
  if ( *(_BYTE *)(a2 + 65) )
    *(_BYTE *)(*(_QWORD *)(a2 + 184) + 3i64) |= 1u;
  HumDecrementPendingRequestCount(v4);
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v4 + 104), (PVOID)a2, 0x20u);
  return 0i64;
}

//----- (00000001C00064F8) ----------------------------------------------------
__int64 __fastcall HumQueueResetWorkItem(__int64 a1, __int64 a2)
{
  __int64 v4; // rbx
  PIO_WORKITEM *v5; // rdi
  PIO_WORKITEM v6; // rax
  PIO_WORKITEM *v7; // rsi

  v4 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( (int)HumIncrementPendingRequestCount(v4) < 0 )
    return 0i64;
  v5 = (PIO_WORKITEM *)ExAllocatePool2(64i64, 40i64, 1432643912i64);
  if ( !v5 )
  {
    HumDecrementPendingRequestCount(v4);
    return 0i64;
  }
  v6 = IoAllocateWorkItem(*(PDEVICE_OBJECT *)(v4 + 96));
  v5[1] = v6;
  v7 = v5 + 1;
  if ( !v6 )
  {
LABEL_8:
    ExFreePool(v5);
    HumDecrementPendingRequestCount(v4);
    return 0i64;
  }
  if ( _InterlockedCompareExchange64((volatile signed __int64 *)(v4 + 72), (signed __int64)v7, 0i64) )
  {
    IoFreeWorkItem(*v7);
    goto LABEL_8;
  }
  *(_DWORD *)v5 = 1952805714;
  v5[3] = (PIO_WORKITEM)a2;
  v5[2] = (PIO_WORKITEM)a1;
  *(_BYTE *)(*(_QWORD *)(a2 + 184) + 3i64) |= 1u;
  IoAcquireRemoveLockEx((PIO_REMOVE_LOCK)(v4 + 104), (PVOID)0x57525548, File, 1u, 0x20u);
  IoQueueWorkItem(*v7, (PIO_WORKITEM_ROUTINE)HumResetWorkItem, DelayedWorkQueue, v5);
  return 3221225494i64;
}
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0006638) ----------------------------------------------------
__int64 __fastcall HumResetInterruptPipe(PDEVICE_OBJECT DeviceObject)
{
  __int64 v2; // rsi
  _WORD *v3; // rax
  _QWORD *v4; // rbx
  __int64 v5; // rax
  int v6; // edx
  unsigned int v7; // edi

  v2 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v3 = (_WORD *)ExAllocatePool2(64i64, 40i64, 1432643912i64);
  v4 = v3;
  if ( !v3 )
    return 3221225626i64;
  *v3 = 40;
  v3[1] = 30;
  v5 = GetInterruptInputPipeForDevice(v2);
  if ( v5 )
  {
    v4[3] = *(_QWORD *)(v5 + 8);
    v7 = HumCallUSB(DeviceObject, (ULONG_PTR)v4);
  }
  else
  {
    v7 = -1073741808;
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v6) = 4;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v6,
        2,
        12,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids);
    }
  }
  ExFreePool(v4);
  return v7;
}
// 1C00066E7: variable 'v6' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C0006720) ----------------------------------------------------
NTSTATUS __fastcall HumResetParentPort(__int64 a1)
{
  IRP *v2; // rax
  NTSTATUS result; // eax
  _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-38h] BYREF
  struct _KEVENT Event; // [rsp+60h] [rbp-28h] BYREF

  Event.Header.WaitListHead.Blink = 0i64;
  *(_OWORD *)&Event.Header.Lock = 0i64;
  IoStatusBlock = 0i64;
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v2 = IoBuildDeviceIoControlRequest(
         0x220007u,
         *(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64),
         0i64,
         0,
         0i64,
         0,
         1u,
         &Event,
         &IoStatusBlock);
  if ( !v2 )
    return -1073741670;
  result = IofCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), v2);
  if ( result == 259 )
  {
    KeWaitForSingleObject(&Event, Suspended, 0, 0, 0i64);
    result = IoStatusBlock.Status;
  }
  return result;
}

//----- (00000001C0006810) ----------------------------------------------------
void __fastcall HumResetWorkItem(PDEVICE_OBJECT DeviceObject, PVOID Context)
{
  PDEVICE_OBJECT v2; // rdi
  char v4; // bp
  __int64 v5; // r14
  __int64 v6; // rdx
  __int64 v7; // r8
  __int64 v8; // r9
  NTSTATUS v9; // eax
  int v10; // edx
  int v11; // eax
  int v12; // edx
  NTSTATUS v13; // eax
  int v14; // edx
  int v15; // esi
  int v16; // er9
  char v17; // al
  int v18; // edx
  int v19; // [rsp+20h] [rbp-58h]
  __int64 v20; // [rsp+28h] [rbp-50h]
  PDEVICE_OBJECT v21; // [rsp+80h] [rbp+8h]
  int v22; // [rsp+88h] [rbp+10h] BYREF

  v21 = DeviceObject;
  v2 = DeviceObject;
  v22 = 0;
  v4 = 0;
  v5 = *(_QWORD *)(*(_QWORD *)(*((_QWORD *)Context + 2) + 64i64) + 16i64);
  if ( (int)HumIncrementPendingRequestCount(v5) >= 0 )
  {
    v9 = HumGetPortStatus(*((_QWORD *)Context + 2), &v22);
    if ( v9 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_23;
      LOBYTE(v10) = 3;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v10,
        2,
        21,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        v9);
      goto LABEL_22;
    }
    if ( (v22 & 2) == 0 )
    {
      if ( WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
        goto LABEL_23;
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        2u,
        0x14u,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        v22);
LABEL_22:
      v2 = v21;
LABEL_23:
      HumDecrementPendingRequestCount(v5);
      goto LABEL_24;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        4u,
        2u,
        0xDu,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        v22);
    v11 = HumAbortPendingRequests(*((PDEVICE_OBJECT *)Context + 2));
    if ( v11 < 0 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(v12) = 3;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          v12,
          2,
          18,
          (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
          v11);
      }
      goto LABEL_22;
    }
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v12) = 4;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v12,
        2,
        14,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids);
    }
    v13 = HumResetParentPort(*((_QWORD *)Context + 2));
    v15 = v13;
    if ( v13 == -1073741668 )
    {
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LODWORD(v20) = v13;
        WPP_RECORDER_SF_dq(
          (__int64)WPP_GLOBAL_Control->DeviceExtension,
          3u,
          2u,
          0xFu,
          (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
          v20,
          *((_QWORD *)Context + 2));
      }
      *(_DWORD *)v5 = 6;
      IoInvalidateDeviceState(**(PDEVICE_OBJECT **)(*((_QWORD *)Context + 2) + 64i64));
      goto LABEL_22;
    }
    if ( v13 >= 0 )
    {
      v4 = 1;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v16 = 17;
        LOBYTE(v14) = 4;
        goto LABEL_18;
      }
    }
    else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      v16 = 16;
      v14 = 2;
LABEL_18:
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v14,
        2,
        v16,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        v13);
      goto LABEL_19;
    }
LABEL_19:
    if ( v15 >= 0 )
    {
      v17 = HumResetInterruptPipe(*((PDEVICE_OBJECT *)Context + 2));
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        LOBYTE(v18) = 4;
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          v18,
          2,
          19,
          (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
          v17);
      }
    }
    goto LABEL_22;
  }
LABEL_24:
  _InterlockedExchange64((volatile __int64 *)(v5 + 72), 0i64);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    WPP_RECORDER_SF_qcc((__int64)WPP_GLOBAL_Control->DeviceExtension, v6, v7, v8, v19);
  if ( v4 )
    HumCompleteDeviceResetNotificationIrp((__int64)v2, 0);
  IofCompleteRequest(*((PIRP *)Context + 3), 0);
  IoFreeWorkItem(*((PIO_WORKITEM *)Context + 1));
  ExFreePool(Context);
  HumDecrementPendingRequestCount(v5);
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), (PVOID)0x57525548, 0x20u);
}
// 1C00068FB: variable 'v12' is possibly undefined
// 1C0006947: variable 'v20' is possibly undefined
// 1C00069BB: variable 'v14' is possibly undefined
// 1C00069FD: variable 'v18' is possibly undefined
// 1C0006A53: variable 'v6' is possibly undefined
// 1C0006A53: variable 'v7' is possibly undefined
// 1C0006A53: variable 'v8' is possibly undefined
// 1C0006A53: variable 'v19' is possibly undefined
// 1C0006B7B: variable 'v10' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C0006B8C) ----------------------------------------------------
__int64 WPP_RECORDER_SF_D(__int64 a1, unsigned __int8 a2, unsigned int a3, unsigned __int16 a4, __int64 a5, ...)
{
  unsigned __int64 v7; // rdi
  unsigned int v8; // esi
  int v10; // eax
  char *v11; // rcx
  int v13; // [rsp+20h] [rbp-38h]
  __int64 v14; // [rsp+40h] [rbp-18h]
  __int64 v15; // [rsp+48h] [rbp-10h]
  va_list va; // [rsp+88h] [rbp+30h] BYREF

  va_start(va, a5);
  v7 = (unsigned __int64)a3 >> 16;
  v8 = a2;
  v10 = *((_DWORD *)&WPP_GLOBAL_Control->Timer + 20 * v7 + (((a3 - 1) >> 5) & 0x7FF) + 1);
  if ( _bittest(&v10, (a3 - 1) & 0x1F) )
  {
    v11 = (char *)WPP_GLOBAL_Control + 80 * v7;
    if ( (unsigned __int8)v11[41] >= a2 )
      ((void (__fastcall *)(_QWORD, __int64, __int64, _QWORD, char *, __int64, _QWORD))WPP_MAIN_CB.Dpc.DpcData)(
        *((_QWORD *)v11 + 3),
        43i64,
        a5,
        a4,
        va,
        4i64,
        0i64);
  }
  LOWORD(v13) = a4;
  return WppAutoLogTrace(a1, v8, a3, a5, v13, va, 4i64, 0i64, v14, v15);
}
// 1C0009200: invalid function type has been ignored
// 1C0006C6B: variable 'v13' is possibly undefined
// 1C0006C6B: variable 'v14' is possibly undefined
// 1C0006C6B: variable 'v15' is possibly undefined

//----- (00000001C000C008) ----------------------------------------------------
__int64 TraceLoggingRegisterEx_EtwRegister_EtwSetInformation()
{
  unsigned int v0; // ebx
  GUID ProviderId; // [rsp+20h] [rbp-28h] BYREF

  ProviderId = (GUID)*((_OWORD *)EventInformation - 1);
  if ( RegHandle )
    __fastfail(5u);
  xmmword_1C0009038 = 0i64;
  v0 = EtwRegister(&ProviderId, (PETWENABLECALLBACK)tlgEnableCallback, &dword_1C0009010, &RegHandle);
  if ( !v0 )
    EtwSetInformation(RegHandle, EventProviderSetTraits, EventInformation, *(unsigned __int16 *)EventInformation);
  return v0;
}
// 1C0009010: using guessed type int dword_1C0009010;
// 1C0009038: using guessed type __int128 xmmword_1C0009038;

//----- (00000001C000C0B4) ----------------------------------------------------
__int64 TraceLoggingRegister_EtwRegister_EtwSetInformation()
{
  return TraceLoggingRegisterEx_EtwRegister_EtwSetInformation();
}

//----- (00000001C000C0CC) ----------------------------------------------------
NTSTATUS TraceLoggingUnregister_EtwUnregister()
{
  REGHANDLE v0; // rcx

  v0 = RegHandle;
  RegHandle = 0i64;
  dword_1C0009010 = 0;
  return EtwUnregister(v0);
}
// 1C0009010: using guessed type int dword_1C0009010;

//----- (00000001C000C100) ----------------------------------------------------
void __fastcall tlgEnableCallback(LPCGUID SourceId, __int64 ControlCode, __int64 Level, ULONGLONG MatchAnyKeyword, ULONGLONG MatchAllKeyword, PEVENT_FILTER_DESCRIPTOR FilterData, PVOID CallbackContext)
{
  int v7; // eax
  void (__fastcall *v8)(LPCGUID, __int64, __int64, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, _QWORD); // rax

  if ( CallbackContext )
  {
    if ( (_DWORD)ControlCode )
    {
      if ( (_DWORD)ControlCode == 1 )
      {
        if ( (_BYTE)Level )
          v7 = (unsigned __int8)Level + 1;
        else
          v7 = 256;
        *(_DWORD *)CallbackContext = v7;
        *((_QWORD *)CallbackContext + 2) = MatchAnyKeyword;
        *((_QWORD *)CallbackContext + 3) = MatchAllKeyword;
      }
    }
    else
    {
      *(_DWORD *)CallbackContext = 0;
    }
    v8 = (void (__fastcall *)(LPCGUID, __int64, __int64, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, _QWORD))*((_QWORD *)CallbackContext + 5);
    if ( v8 )
      v8(SourceId, ControlCode, Level, MatchAnyKeyword, MatchAllKeyword, FilterData, *((_QWORD *)CallbackContext + 6));
  }
}

//----- (00000001C000C180) ----------------------------------------------------
__int64 __fastcall HumGetStringDescriptor(PDEVICE_OBJECT DeviceObject, _QWORD *a2)
{
  unsigned int *v2; // rbx
  __int64 v5; // r13
  unsigned int v6; // eax
  char *v7; // rsi
  char v8; // cl
  __int64 v9; // rbp
  unsigned int v10; // eax
  unsigned int v11; // edi
  char v12; // bl
  int v13; // eax
  PVOID v14; // rdi
  unsigned int v15; // er15
  unsigned int v16; // ecx
  unsigned __int64 v17; // rbx
  __int64 v19; // rcx
  int Priority; // [rsp+28h] [rbp-50h]
  __int64 v21; // [rsp+80h] [rbp+8h] BYREF
  PVOID P; // [rsp+88h] [rbp+10h] BYREF

  v2 = (unsigned int *)a2[23];
  v5 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v6 = v2[6];
  if ( v6 == 720915 )
  {
    v7 = (char *)a2[14];
    v8 = 0;
  }
  else
  {
    if ( v6 != 721378 )
      return 3221225704i64;
    v19 = a2[1];
    if ( !v19 )
      return 3221225704i64;
    if ( (*(_BYTE *)(v19 + 10) & 5) != 0 )
      v7 = *(char **)(v19 + 24);
    else
      v7 = (char *)MmMapLockedPagesSpecifyCache((PMDL)v19, 0, MmCached, 0i64, 0, 0x40000010u);
    v8 = 1;
  }
  if ( !v7 )
    return 3221225704i64;
  v9 = v2[2];
  if ( (unsigned int)v9 < 2 )
    return 3221225704i64;
  v10 = v2[8];
  v11 = HIWORD(v10);
  v12 = v10;
  if ( v8 )
    goto LABEL_8;
  switch ( (unsigned __int16)v10 )
  {
    case 0xFu:
      v12 = *(_BYTE *)(*(_QWORD *)(v5 + 8) + 15i64);
      if ( v12 )
        break;
      return 3221225485i64;
    case 0xEu:
      v12 = *(_BYTE *)(*(_QWORD *)(v5 + 8) + 14i64);
      if ( !v12 )
        return 3221225485i64;
      break;
    case 0x10u:
      v12 = *(_BYTE *)(*(_QWORD *)(v5 + 8) + 16i64);
      if ( !v12 )
        return 3221225485i64;
      break;
    default:
      return 3221225485i64;
  }
LABEL_8:
  LODWORD(v21) = v9 + 2;
  P = (PVOID)ExAllocatePool2(64i64, (unsigned int)(v9 + 2), 1432643912i64);
  if ( !P )
    return 3221225626i64;
  v13 = HumGetDescriptorRequest(DeviceObject, 11, 3, &P, (__int64)&v21, Priority, v12, v11);
  v14 = P;
  v15 = v13;
  if ( v13 >= 0 )
  {
    v16 = *(char *)P - 2;
    if ( v16 > (unsigned int)v21 )
      v16 = v21;
    v17 = v16 & 0xFFFFFFFE;
    if ( v17 > v9 - 2 )
    {
      v15 = -1073741306;
    }
    else
    {
      memmove(v7, (char *)P + 2, v16 & 0xFFFFFFFE);
      *(_WORD *)&v7[v17] = 0;
      a2[7] = v17 + 2;
    }
  }
  ExFreePool(v14);
  return v15;
}
// 1C000C25E: variable 'Priority' is possibly undefined
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C000C2F0) ----------------------------------------------------
__int64 __fastcall HumPnP(PDEVICE_OBJECT DeviceObject, PVOID Tag)
{
  IRP *v2; // rdi
  _IO_STACK_LOCATION *v4; // r15
  __int64 v5; // rsi
  NTSTATUS v6; // eax
  int v7; // edx
  int v8; // ebx
  UCHAR v9; // al
  int v10; // eax
  __int64 v12; // rbx
  int v13; // er13
  int v14; // edx
  int v15; // er8
  int v16; // er9
  _IO_STACK_LOCATION *v17; // rax
  NTSTATUS v18; // eax
  int v19; // edx
  UCHAR v20; // al
  void *v21; // rcx
  void *v22; // rcx
  int v23; // edx
  const CHAR *v24; // rdx
  int *v25; // rax
  __int64 v26; // r8
  __int64 v27; // r9
  ULONG RemlockSize; // [rsp+20h] [rbp-79h]
  __int64 InvokeOnCancel; // [rsp+30h] [rbp-69h]
  int v30; // [rsp+40h] [rbp-59h] BYREF
  int v31; // [rsp+44h] [rbp-55h] BYREF
  struct _KEVENT Event; // [rsp+48h] [rbp-51h] BYREF
  struct _EVENT_DATA_DESCRIPTOR v33; // [rsp+60h] [rbp-39h] BYREF
  int *v34; // [rsp+80h] [rbp-19h]
  __int64 v35; // [rsp+88h] [rbp-11h]
  int *v36; // [rsp+90h] [rbp-9h]
  __int64 v37; // [rsp+98h] [rbp-1h]
  char v38[16]; // [rsp+A0h] [rbp+7h] BYREF

  *(_OWORD *)&Event.Header.Lock = 0i64;
  Event.Header.WaitListHead.Blink = 0i64;
  v2 = (IRP *)Tag;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED && LOWORD(WPP_GLOBAL_Control->DeviceType) )
  {
    LOBYTE(Tag) = 5;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      (_DWORD)Tag,
      4,
      10,
      (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids);
  }
  v4 = v2->Tail.Overlay.CurrentStackLocation;
  v5 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v6 = IoAcquireRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), v2, File, 1u, 0x20u);
  v8 = v6;
  if ( v6 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v7) = 2;
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        v7,
        4,
        11,
        (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
        v6);
    }
    v2->IoStatus.Status = v8;
    IofCompleteRequest(v2, 0);
    return (unsigned int)v8;
  }
  v9 = v4->MinorFunction;
  if ( v9 )
  {
    if ( v9 == 2 )
      return HumRemoveDevice(DeviceObject, v2);
    if ( v9 == 4 )
    {
      if ( *(_DWORD *)v5 == 2 )
      {
        v10 = HumStopDevice(DeviceObject);
        v8 = v10;
        if ( v10 < 0 )
        {
          if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
            WPP_RECORDER_SF_qd(
              (__int64)WPP_GLOBAL_Control->DeviceExtension,
              3u,
              4u,
              0xFu,
              (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
              DeviceObject,
              v10);
          goto LABEL_50;
        }
      }
    }
    else if ( v9 == 20 && *(_DWORD *)v5 == 6 )
    {
      v2->IoStatus.Information |= 4ui64;
    }
  }
  else
  {
    v12 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
    v13 = *(_DWORD *)v12;
    *(_DWORD *)v12 = 1;
    KeResetEvent((PRKEVENT)(v12 + 40));
    if ( (unsigned int)(v13 - 3) <= 2 )
    {
      HumIncrementPendingRequestCount(v12);
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        WPP_RECORDER_SF_L(WPP_GLOBAL_Control->DeviceExtension, v14, v15, v16, RemlockSize, v13);
    }
    *(_QWORD *)(v12 + 16) = 0i64;
  }
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v17 = v2->Tail.Overlay.CurrentStackLocation;
  *(_OWORD *)&v17[-1].MajorFunction = *(_OWORD *)&v17->MajorFunction;
  *(_OWORD *)&v17[-1].Parameters.NotifyDirectoryEx.CompletionFilter = *(_OWORD *)&v17->Parameters.NotifyDirectoryEx.CompletionFilter;
  *(_OWORD *)(&v17[-1].Parameters.SetQuota + 6) = *(_OWORD *)(&v17->Parameters.SetQuota + 6);
  v17[-1].FileObject = v17->FileObject;
  v17[-1].Control = 0;
  v18 = IoSetCompletionRoutineEx(DeviceObject, v2, (PIO_COMPLETION_ROUTINE)HumPnpCompletion, &Event, 1u, 1u, 1u);
  v8 = v18;
  if ( v18 >= 0 )
  {
    if ( IofCallDriver(*((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1), v2) == 259 )
      KeWaitForSingleObject(&Event, Executive, 0, 0, 0i64);
    v20 = v4->MinorFunction;
    v8 = v2->IoStatus.Status;
    if ( v20 )
    {
      if ( v20 == 4 )
      {
        v21 = *(void **)(v5 + 16);
        *(_DWORD *)v5 = 4;
        if ( v21 )
        {
          ExFreePool(v21);
          *(_QWORD *)(v5 + 16) = 0i64;
        }
        v22 = *(void **)(v5 + 8);
        if ( v22 )
        {
          ExFreePool(v22);
          *(_QWORD *)(v5 + 8) = 0i64;
        }
      }
      else if ( v20 == 9 && v8 >= 0 )
      {
        *(_DWORD *)(v4->Parameters.WMI.ProviderId + 4) |= 0x200u;
      }
    }
    else
    {
      if ( v8 < 0 )
      {
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LODWORD(InvokeOnCancel) = v2->IoStatus.Status;
          WPP_RECORDER_SF_qd(
            (__int64)WPP_GLOBAL_Control->DeviceExtension,
            3u,
            4u,
            0xEu,
            (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
            DeviceObject,
            InvokeOnCancel);
        }
        *(_DWORD *)v5 = 6;
        if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
          goto LABEL_50;
        v31 = v8;
        v34 = &v31;
        v24 = "PNP_DeviceStart";
        v25 = &v30;
        v30 = 6;
      }
      else
      {
        *(_DWORD *)v5 = 2;
        v8 = HumInitDevice(DeviceObject);
        if ( v8 >= 0 )
          goto LABEL_50;
        if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
        {
          LOBYTE(v23) = 3;
          WPP_RECORDER_SF_q(
            WPP_GLOBAL_Control->DeviceExtension,
            v23,
            4,
            13,
            (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
            (char)DeviceObject);
        }
        *(_DWORD *)v5 = 6;
        if ( (unsigned int)dword_1C0009010 <= 5 || !tlgKeywordOn() )
          goto LABEL_50;
        v30 = v8;
        v34 = &v30;
        v24 = "PNP_HumInitDevice";
        v25 = &v31;
        v31 = 6;
      }
      v35 = 4i64;
      v36 = v25;
      v37 = 4i64;
      tlgCreate1Sz_char((__int64)v38, v24);
      tlgWriteTransfer_EtwWriteTransfer((__int64)&v33, (unsigned __int8 *)dword_1C00077EF, v26, v27, 5u, &v33);
    }
  }
  else if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LOBYTE(v19) = 2;
    WPP_RECORDER_SF_d(
      WPP_GLOBAL_Control->DeviceExtension,
      v19,
      4,
      12,
      (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
      v18);
  }
LABEL_50:
  v2->IoStatus.Status = v8;
  IofCompleteRequest(v2, 0);
  IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v5 + 104), v2, 0x20u);
  return (unsigned int)v8;
}
// 1C000C3D9: variable 'v7' is possibly undefined
// 1C000C4E7: variable 'v14' is possibly undefined
// 1C000C4E7: variable 'v15' is possibly undefined
// 1C000C4E7: variable 'v16' is possibly undefined
// 1C000C4E7: variable 'RemlockSize' is possibly undefined
// 1C000C5A2: variable 'v19' is possibly undefined
// 1C000C6B5: variable 'v23' is possibly undefined
// 1C000C72E: variable 'InvokeOnCancel' is possibly undefined
// 1C000C79D: variable 'v26' is possibly undefined
// 1C000C79D: variable 'v27' is possibly undefined
// 1C0002470: using guessed type __int64 __fastcall WPP_RECORDER_SF_q(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0005F0C: using guessed type __int64 __fastcall WPP_RECORDER_SF_L(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C0009010: using guessed type int dword_1C0009010;

//----- (00000001C000C800) ----------------------------------------------------
__int64 __fastcall HumGetReportDescriptor(PDEVICE_OBJECT DeviceObject, PVOID Tag, _BYTE *a3)
{
  _QWORD *v3; // rax
  __int16 v4; // r10
  __int64 v5; // r15
  __int64 v9; // rbx
  __int64 v10; // rax
  __int16 v11; // dx
  __int16 v12; // cx
  unsigned int v13; // esi
  unsigned int v14; // ecx
  __int64 v15; // rdi
  void *v16; // rcx
  int v18; // [rsp+28h] [rbp-40h]
  __int64 v19; // [rsp+30h] [rbp-38h]
  size_t Size; // [rsp+70h] [rbp+8h] BYREF
  void *Src; // [rsp+78h] [rbp+10h] BYREF

  v3 = DeviceObject->DeviceExtension;
  LOBYTE(v4) = 0;
  v5 = *((_QWORD *)Tag + 23);
  Src = 0i64;
  v9 = v3[2];
  LODWORD(Size) = *(unsigned __int16 *)(v9 + 87) + 64;
  if ( (*(_DWORD *)(v9 + 64) & 1) != 0 )
  {
    v10 = GetInterruptInputPipeForDevice(v9);
    if ( !v10 )
    {
      v13 = -1073741438;
      goto LABEL_13;
    }
    v11 = v4 + 36;
    v12 = *(_BYTE *)(v10 + 2) & 0x7F;
  }
  else
  {
    v11 = 40;
    v12 = *(unsigned __int8 *)(*(_QWORD *)(v9 + 16) + 2i64);
  }
  v13 = HumGetDescriptorRequest(DeviceObject, v11, *(_BYTE *)(v9 + 86), &Src, (__int64)&Size, v18, v4, v12);
  if ( (v13 & 0x80000000) == 0 )
  {
    v14 = *(unsigned __int16 *)(v9 + 87);
    if ( *(_DWORD *)(v5 + 8) <= v14 )
      v14 = *(_DWORD *)(v5 + 8);
    if ( v14 > (unsigned int)Size )
      v14 = Size;
    v15 = v14;
    memmove(*((void **)Tag + 14), Src, v14);
    v16 = Src;
    *((_QWORD *)Tag + 7) = v15;
    ExFreePool(v16);
    return v13;
  }
  if ( v13 == -1073741667 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(v19) = -1073741667;
      WPP_RECORDER_SF_qd(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        3u,
        2u,
        0xBu,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        Tag,
        v19);
    }
    return v13;
  }
LABEL_13:
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LODWORD(v19) = v13;
    WPP_RECORDER_SF_qd(
      (__int64)WPP_GLOBAL_Control->DeviceExtension,
      3u,
      2u,
      0xAu,
      (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
      Tag,
      v19);
  }
  *((_DWORD *)Tag + 12) = v13;
  if ( (unsigned int)HumQueueResetWorkItem((__int64)DeviceObject, (__int64)Tag) == -1073741802 )
  {
    *a3 = 0;
    IoReleaseRemoveLockEx((PIO_REMOVE_LOCK)(v9 + 104), Tag, 0x20u);
    return 259i64;
  }
  return v13;
}
// 1C000C853: variable 'v4' is possibly undefined
// 1C000C895: variable 'v18' is possibly undefined
// 1C000C927: variable 'v19' is possibly undefined
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;

//----- (00000001C000C9D0) ----------------------------------------------------
__int64 __fastcall HumGetHidDescriptor(__int64 a1, __int64 a2)
{
  unsigned __int8 *v3; // rdx
  unsigned int v4; // er8
  unsigned int v5; // ecx
  __int64 v6; // rdi
  __int64 result; // rax

  v3 = (unsigned __int8 *)(*(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64) + 80i64);
  v4 = *v3;
  if ( (_BYTE)v4 )
  {
    v5 = *(_DWORD *)(*(_QWORD *)(a2 + 184) + 8i64);
    if ( v5 > v4 )
      v5 = *v3;
    v6 = v5;
    memmove(*(void **)(a2 + 112), v3, v5);
    *(_QWORD *)(a2 + 56) = v6;
    result = 0i64;
  }
  else
  {
    *(_QWORD *)(a2 + 56) = 0i64;
    result = 3221225473i64;
  }
  return result;
}

//----- (00000001C000CA40) ----------------------------------------------------
__int64 __fastcall HumGetDeviceAttributes(__int64 a1, _QWORD *a2)
{
  __int64 v2; // r8
  __int64 v3; // r9
  __int64 result; // rax

  v2 = a2[14];
  v3 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 16i64);
  if ( *(_DWORD *)(a2[23] + 8i64) < 0x20u )
    return 3221225990i64;
  a2[7] = 32i64;
  *(_DWORD *)v2 = 32;
  *(_WORD *)(v2 + 4) = *(_WORD *)(*(_QWORD *)(v3 + 8) + 8i64);
  *(_WORD *)(v2 + 6) = *(_WORD *)(*(_QWORD *)(v3 + 8) + 10i64);
  result = 0i64;
  *(_WORD *)(v2 + 8) = *(_WORD *)(*(_QWORD *)(v3 + 8) + 12i64);
  return result;
}

//----- (00000001C000CAA0) ----------------------------------------------------
PVOID WppLoadTracingSupport()
{
  PVOID result; // rax
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-18h] BYREF
  unsigned int v2; // [rsp+50h] [rbp+8h] BYREF

  v2 = 0;
  DestinationString = 0i64;
  RtlInitUnicodeString(&DestinationString, L"PsGetVersion");
  WPP_MAIN_CB.Dpc.DeferredContext = MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiTraceMessage");
  WPP_MAIN_CB.Dpc.DpcData = MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiQueryTraceInformation");
  *(_QWORD *)&WPP_MAIN_CB.ActiveThreadCount = MmGetSystemRoutineAddress(&DestinationString);
  result = WPP_MAIN_CB.Dpc.DeferredContext;
  LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) = 2;
  if ( WPP_MAIN_CB.Dpc.DeferredContext )
    result = (PVOID)((__int64 (__fastcall *)(unsigned int *, _QWORD, _QWORD, _QWORD))WPP_MAIN_CB.Dpc.DeferredContext)(
                      &v2,
                      0i64,
                      0i64,
                      0i64);
  if ( v2 >= 6 )
  {
    RtlInitUnicodeString(&DestinationString, L"EtwRegisterClassicProvider");
    result = MmGetSystemRoutineAddress(&DestinationString);
    WPP_MAIN_CB.Dpc.SystemArgument1 = result;
    if ( result )
    {
      RtlInitUnicodeString(&DestinationString, L"EtwUnregister");
      result = MmGetSystemRoutineAddress(&DestinationString);
      WPP_MAIN_CB.Dpc.SystemArgument2 = result;
      LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) = 4;
    }
  }
  return result;
}
// 1C00091E8: invalid function type has been ignored

//----- (00000001C000CBF0) ----------------------------------------------------
void __fastcall WppInitKm(__int64 a1, __int64 a2)
{
  _DEVICE_OBJECT *v4; // rbx
  void (__fastcall *v5)(_DRIVER_OBJECT *, _QWORD, __int64 (__fastcall *)(__int64, unsigned __int8, __int64 *, __int64), _DEVICE_OBJECT *, PVPB *); // rax

  if ( WPP_GLOBAL_Control != &WPP_MAIN_CB )
  {
    WPP_GLOBAL_Control = &WPP_MAIN_CB;
    if ( LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) == 4 )
    {
      v4 = &WPP_MAIN_CB;
      do
      {
        v5 = (void (__fastcall *)(_DRIVER_OBJECT *, _QWORD, __int64 (__fastcall *)(__int64, unsigned __int8, __int64 *, __int64), _DEVICE_OBJECT *, PVPB *))WPP_MAIN_CB.Dpc.SystemArgument1;
        v4->Vpb = 0i64;
        v5(v4->DriverObject, 0i64, WppClassicProviderCallback, v4, &v4->Vpb);
        v4 = v4->NextDevice;
      }
      while ( v4 );
    }
    else if ( LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) == 2 )
    {
      *(_QWORD *)&WPP_MAIN_CB.Type = WppTraceCallback;
      IoWMIRegistrationControl(&WPP_MAIN_CB, 0x80010001);
    }
    WppAutoLogStart(WPP_GLOBAL_Control, a1, a2);
    WPP_RECORDER_INITIALIZED = &WPP_MAIN_CB;
  }
}
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B028: using guessed type __int64 __fastcall WppAutoLogStart(_QWORD, _QWORD, _QWORD);

//----- (00000001C000CD80) ----------------------------------------------------
void __fastcall WppCleanupKm(__int64 a1)
{
  PDEVICE_OBJECT v1; // rbx

  v1 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (PDEVICE_OBJECT)&WPP_GLOBAL_Control )
  {
    if ( LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) == 4 )
    {
      if ( WPP_GLOBAL_Control )
      {
        do
        {
          if ( v1->Vpb )
          {
            ((void (*)(void))WPP_MAIN_CB.Dpc.SystemArgument2)();
            v1->Vpb = 0i64;
          }
          v1 = v1->NextDevice;
        }
        while ( v1 );
      }
    }
    else if ( LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) == 2 )
    {
      IoWMIRegistrationControl(WPP_GLOBAL_Control, 0x80000002);
    }
    WppAutoLogStop(WPP_GLOBAL_Control, a1);
    WPP_GLOBAL_Control = (PDEVICE_OBJECT)&WPP_GLOBAL_Control;
    WPP_RECORDER_INITIALIZED = &WPP_RECORDER_INITIALIZED;
  }
}
// 1C00091F8: invalid function type has been ignored
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B040: using guessed type __int64 __fastcall WppAutoLogStop(_QWORD, _QWORD);

//----- (00000001C000CE40) ----------------------------------------------------
__int64 __fastcall WppTraceCallback(char a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // ebx
  __int64 v9; // rdi
  unsigned int v10; // esi
  __int64 v11; // rax
  const void **v12; // r15
  unsigned int v13; // ebp
  unsigned int v14; // er12
  _WORD *v15; // rcx
  _DWORD *v16; // rcx
  __int64 v17; // rdx
  __int128 v18; // xmm0
  __int64 v19; // rdi
  _DWORD *v20; // rdx
  char v21; // r9
  bool v22; // zf
  __int64 v24; // [rsp+30h] [rbp-38h]
  int v25; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  switch ( a1 )
  {
    case 4:
    case 5:
      v19 = a5;
      v25 = 0;
      LODWORD(a6) = 0;
      if ( a5 )
      {
        if ( a3 < 0x30 )
          goto LABEL_5;
        v20 = a4 + 6;
        while ( !WppIsEqualGuid(*(_DWORD **)(v19 + 8), v20) )
        {
          v19 = *(_QWORD *)(v19 + 16);
          if ( !v19 )
            goto LABEL_23;
        }
        if ( v21 == 5 )
        {
          *(_DWORD *)(v19 + 44) = 0;
          *(_QWORD *)(v19 + 24) = 0i64;
          *(_BYTE *)(v19 + 41) = 0;
        }
        else
        {
          v22 = LODWORD(WPP_MAIN_CB.Dpc.DeferredRoutine) == 2;
          v24 = *((_QWORD *)a4 + 1);
          *(_QWORD *)(v19 + 24) = v24;
          if ( v22 )
          {
            if ( !(*(unsigned int (__fastcall **)(__int64, int *, __int64, unsigned int **, unsigned int *))&WPP_MAIN_CB.ActiveThreadCount)(
                    3i64,
                    &v25,
                    4i64,
                    &a6,
                    a4) )
              *(_BYTE *)(v19 + 41) = v25;
            v7 = (*(__int64 (__fastcall **)(__int64, __int64, __int64, unsigned int **, unsigned int *))&WPP_MAIN_CB.ActiveThreadCount)(
                   2i64,
                   v19 + 44,
                   4i64,
                   &a6,
                   a4);
          }
          else
          {
            *(_DWORD *)(v19 + 44) = HIDWORD(v24);
            *(_BYTE *)(v19 + 41) = BYTE2(v24);
          }
        }
      }
      else
      {
LABEL_23:
        v7 = -1073741163;
      }
      break;
    case 6:
    case 7:
      return v7;
    case 8:
      v9 = a5;
      v10 = 0;
      v11 = a5;
      v12 = *(const void ***)(a5 + 32);
      do
      {
        v11 = *(_QWORD *)(v11 + 16);
        ++v10;
      }
      while ( v11 );
      if ( v10 <= 0x3F )
      {
        v13 = 32 * v10 + 24;
        if ( v12 )
        {
          v14 = 32 * v10 + 24;
          v13 += *(unsigned __int16 *)v12 + 2;
        }
        else
        {
          v14 = 0;
        }
        if ( v13 > a3 )
        {
          v7 = -1073741789;
          if ( a3 >= 4 )
          {
            *a4 = v13;
            *v6 = 4;
          }
        }
        else
        {
          memset(a4, 0, a3);
          *a4 = v13;
          a4[2] = v14;
          a4[4] = v10;
          if ( v12 )
          {
            v15 = (_WORD *)((char *)a4 + v14);
            *v15 = *(_WORD *)v12;
            memmove(v15 + 1, v12[1], *(unsigned __int16 *)v12);
          }
          if ( v10 )
          {
            v16 = a4 + 10;
            v17 = v10;
            do
            {
              v16 += 8;
              v18 = *(_OWORD *)*(_QWORD *)(v9 + 8);
              *(v16 - 8) = 528384;
              *((_OWORD *)v16 - 3) = v18;
              *(_BYTE *)(v9 + 41) = 0;
              *(_DWORD *)(v9 + 44) = 0;
              v9 = *(_QWORD *)(v9 + 16);
              --v17;
            }
            while ( v17 );
          }
          *v6 = v13;
        }
      }
      else
      {
LABEL_5:
        v7 = -1073741811;
      }
      break;
    default:
      v7 = -1073741808;
      break;
  }
  return v7;
}
// 1C0009208: invalid function type has been ignored
// 1C000CFA8: variable 'v20' is possibly undefined
// 1C000CFC8: variable 'v21' is possibly undefined

//----- (00000001C000D08C) ----------------------------------------------------
__int64 __fastcall HumAbortPendingRequests(PDEVICE_OBJECT DeviceObject)
{
  __int64 v2; // rbx
  _QWORD *v3; // rdi
  __int64 v4; // rdx
  __int64 v5; // rax
  int v6; // ebx
  int v7; // er9

  v2 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v3 = (_QWORD *)ExAllocatePool2(64i64, 40i64, 1432643912i64);
  if ( v3 )
  {
    v4 = *(_QWORD *)(v2 + 16);
    if ( v4 && *(_DWORD *)(v4 + 16) )
    {
      v5 = *(_QWORD *)(v4 + 32);
      if ( v5 )
      {
        *(_DWORD *)v3 = 131112;
        v3[3] = v5;
        v6 = HumCallUSB(DeviceObject, (ULONG_PTR)v3);
        if ( v6 >= 0 || WPP_RECORDER_INITIALIZED == &WPP_RECORDER_INITIALIZED )
          goto LABEL_12;
        v7 = 19;
        LOBYTE(v4) = 3;
        goto LABEL_11;
      }
      v6 = -1073741810;
    }
    else
    {
      v6 = -1073741810;
      if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      {
        v7 = 20;
        LOBYTE(v4) = 2;
LABEL_11:
        WPP_RECORDER_SF_d(
          WPP_GLOBAL_Control->DeviceExtension,
          v4,
          4,
          v7,
          (__int64)&WPP_3df5017319393635ea3e191f08ba3365_Traceguids,
          v6);
        goto LABEL_12;
      }
    }
LABEL_12:
    ExFreePool(v3);
    return (unsigned int)v6;
  }
  return 3221225626i64;
}
// 1C000D163: variable 'v4' is possibly undefined
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C000D19C) ----------------------------------------------------
__int64 __fastcall HumRemoveDevice(PDEVICE_OBJECT DeviceObject, PVOID Tag)
{
  __int64 v4; // rbx
  int v5; // esi
  unsigned int v6; // edi
  void *v7; // rcx
  void *v8; // rcx

  v4 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  v5 = *(_DWORD *)v4;
  *(_DWORD *)v4 = 5;
  if ( (unsigned int)(v5 - 3) > 1 )
    HumDecrementPendingRequestCount(v4);
  HumCompleteDeviceResetNotificationIrp((__int64)DeviceObject, -1073741810);
  if ( v5 == 2 )
    HumAbortPendingRequests(DeviceObject);
  KeWaitForSingleObject((PVOID)(v4 + 40), Executive, 0, 0, 0i64);
  ++*((_BYTE *)Tag + 67);
  *((_QWORD *)Tag + 23) += 72i64;
  *((_DWORD *)Tag + 12) = 0;
  v6 = IofCallDriver(*((PDEVICE_OBJECT *)DeviceObject->DeviceExtension + 1), (PIRP)Tag);
  IoReleaseRemoveLockAndWaitEx((PIO_REMOVE_LOCK)(v4 + 104), Tag, 0x20u);
  v7 = *(void **)(v4 + 16);
  if ( v7 )
  {
    ExFreePool(v7);
    *(_QWORD *)(v4 + 16) = 0i64;
  }
  v8 = *(void **)(v4 + 8);
  if ( v8 )
  {
    ExFreePool(v8);
    *(_QWORD *)(v4 + 8) = 0i64;
  }
  return v6;
}

//----- (00000001C000D2A0) ----------------------------------------------------
__int64 __fastcall HumStopDevice(PDEVICE_OBJECT DeviceObject)
{
  _DWORD *v2; // rsi
  ULONG_PTR v3; // rax
  void *v4; // rdi
  int v5; // ebx

  v2 = (_DWORD *)*((_QWORD *)DeviceObject->DeviceExtension + 2);
  *v2 = 3;
  HumAbortPendingRequests(DeviceObject);
  HumDecrementPendingRequestCount((__int64)v2);
  KeWaitForSingleObject(v2 + 10, Executive, 0, 0, 0i64);
  v3 = ExAllocatePool2(64i64, 88i64, 1432643912i64);
  v4 = (void *)v3;
  if ( v3 )
  {
    *(_DWORD *)v3 = 88;
    *(_QWORD *)(v3 + 24) = 0i64;
    v5 = HumCallUSB(DeviceObject, v3);
    ExFreePool(v4);
    if ( v5 >= 0 )
      return (unsigned int)v5;
  }
  else
  {
    v5 = -1073741823;
  }
  *v2 = 4;
  return (unsigned int)v5;
}
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C000D380) ----------------------------------------------------
NTSTATUS __fastcall HumSystemControl(__int64 a1, IRP *a2)
{
  _IO_STACK_LOCATION *v2; // rax

  v2 = a2->Tail.Overlay.CurrentStackLocation;
  *(_OWORD *)&v2[-1].MajorFunction = *(_OWORD *)&v2->MajorFunction;
  *(_OWORD *)&v2[-1].Parameters.NotifyDirectoryEx.CompletionFilter = *(_OWORD *)&v2->Parameters.NotifyDirectoryEx.CompletionFilter;
  *(_OWORD *)(&v2[-1].Parameters.SetQuota + 6) = *(_OWORD *)(&v2->Parameters.SetQuota + 6);
  v2[-1].FileObject = v2->FileObject;
  v2[-1].Control = 0;
  return IofCallDriver(*(PDEVICE_OBJECT *)(*(_QWORD *)(a1 + 64) + 8i64), a2);
}

//----- (00000001C000D3D0) ----------------------------------------------------
__int64 __fastcall HumGetMsGenreDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2)
{
  __int64 v2; // rsi
  __int64 v3; // rbx
  __int64 v5; // r15
  size_t v6; // rbp
  __int64 v7; // rcx
  PVOID v8; // rbx
  _DWORD *v9; // rdi
  int v11; // edx
  char v12; // al
  char v13; // cl
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ebx
  __int64 Priority; // [rsp+28h] [rbp-30h]

  v2 = a2;
  v3 = *(_QWORD *)(a2 + 184);
  v5 = *((_QWORD *)DeviceObject->DeviceExtension + 2);
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LOBYTE(a2) = 4;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      a2,
      2,
      26,
      (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids);
  }
  v6 = *(unsigned int *)(v3 + 8);
  if ( !(_DWORD)v6 )
    return (unsigned int)-1073741592;
  v7 = *(_QWORD *)(v2 + 8);
  v8 = (*(_BYTE *)(v7 + 10) & 5) != 0 ? *(_QWORD *)(v7 + 24) : MmMapLockedPagesSpecifyCache(
                                                                 (PMDL)v7,
                                                                 0,
                                                                 MmCached,
                                                                 0i64,
                                                                 0,
                                                                 0x40000010u);
  if ( !v8 )
    return (unsigned int)-1073741592;
  v9 = (_DWORD *)ExAllocatePool2(64i64, 136i64, 1432643912i64);
  if ( !v9 )
    return 3221225626i64;
  memset(v8, 0, v6);
  v12 = v9[32] & 0xE1;
  v9[9] = v6;
  *v9 = 2752648;
  *((_BYTE *)v9 + 128) = v12 | 1;
  *((_QWORD *)v9 + 6) = 0i64;
  *((_QWORD *)v9 + 5) = v8;
  v13 = *(_BYTE *)(*(_QWORD *)(v5 + 16) + 2i64);
  *((_WORD *)v9 + 66) = 1;
  *((_BYTE *)v9 + 130) = v13;
  *((_QWORD *)v9 + 7) = 0i64;
  if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
  {
    LOBYTE(v11) = 4;
    WPP_RECORDER_SF_(
      WPP_GLOBAL_Control->DeviceExtension,
      v11,
      2,
      27,
      (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids);
  }
  v14 = HumCallUSB(DeviceObject, (ULONG_PTR)v9);
  v16 = v14;
  if ( v14 < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
      WPP_RECORDER_SF_d(
        WPP_GLOBAL_Control->DeviceExtension,
        2,
        2,
        30,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        v14);
    ExFreePool(v9);
  }
  else if ( (int)v9[1] < 0 )
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LODWORD(Priority) = v9[1];
      WPP_RECORDER_SF_D(
        (__int64)WPP_GLOBAL_Control->DeviceExtension,
        2u,
        2u,
        0x1Du,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids,
        Priority);
    }
    v16 = -1073741823;
    ExFreePool(v9);
  }
  else
  {
    if ( WPP_RECORDER_INITIALIZED != &WPP_RECORDER_INITIALIZED )
    {
      LOBYTE(v15) = 4;
      WPP_RECORDER_SF_(
        WPP_GLOBAL_Control->DeviceExtension,
        v15,
        2,
        28,
        (__int64)&WPP_b40a5588456f3c2c427887b931342e5d_Traceguids);
    }
    *(_QWORD *)(v2 + 56) = (unsigned int)v9[9];
    v16 = 0;
    ExFreePool(v9);
  }
  return v16;
}
// 1C000D527: variable 'v11' is possibly undefined
// 1C000D56D: variable 'v15' is possibly undefined
// 1C000D5BC: variable 'Priority' is possibly undefined
// 1C0004590: using guessed type __int64 __fastcall WPP_RECORDER_SF_(_DWORD, _DWORD, _DWORD, _DWORD, __int64);
// 1C0004760: using guessed type __int64 __fastcall WPP_RECORDER_SF_d(_DWORD, _DWORD, _DWORD, _DWORD, __int64, char);
// 1C0009000: using guessed type void *WPP_RECORDER_INITIALIZED;
// 1C000B0D8: using guessed type __int64 __fastcall ExAllocatePool2(_QWORD, _QWORD, _QWORD);

//----- (00000001C000D648) ----------------------------------------------------
__int64 __fastcall HumGetPhysicalDescriptor(PDEVICE_OBJECT DeviceObject, __int64 a2)
{
  __int64 v3; // rcx
  PVOID v4; // rax
  __int64 result; // rax
  int Priority; // [rsp+28h] [rbp-20h]
  __int64 v7; // [rsp+58h] [rbp+10h] BYREF
  void *v8; // [rsp+60h] [rbp+18h] BYREF

  LODWORD(v7) = *(_DWORD *)(*(_QWORD *)(a2 + 184) + 8i64);
  if ( (_DWORD)v7
    && ((v3 = *(_QWORD *)(a2 + 8), (*(_BYTE *)(v3 + 10) & 5) == 0) ? (v4 = MmMapLockedPagesSpecifyCache(
                                                                             (PMDL)v3,
                                                                             0,
                                                                             MmCached,
                                                                             0i64,
                                                                             0,
                                                                             0x40000010u)) : (v4 = *(PVOID *)(v3 + 24)),
        (v8 = v4) != 0i64) )
  {
    result = HumGetDescriptorRequest(DeviceObject, 11, 35, &v8, (__int64)&v7, Priority, 0, 0);
  }
  else
  {
    result = 3221225704i64;
  }
  return result;
}
// 1C000D6D0: variable 'Priority' is possibly undefined

//----- (00000001C000F010) ----------------------------------------------------
NTSTATUS __stdcall GsDriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  _security_init_cookie();
  return DriverEntry(DriverObject, RegistryPath);
}

//----- (00000001C000F044) ----------------------------------------------------
void __cdecl _security_init_cookie()
{
  if ( !_security_cookie || _security_cookie == 0x2B992DDFA232i64 )
    __fastfail(6u);
  _security_cookie_complement = ~_security_cookie;
}
// 1C0009088: using guessed type __int64 _security_cookie_complement;

// nfuncs=89 queued=82 decompiled=82 lumina nreq=0 worse=0 better=0
#error "There were 5 decompilation failure(s) on 82 function(s)"
